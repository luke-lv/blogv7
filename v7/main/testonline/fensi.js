var _UTL={};_UTL.htmlEnc=function(str){if(typeof str!="string")return"";str=str.replace(/&/gm,"&amp;");str=str.replace(/</gm,"&lt;");str=str.replace(/>/gm,"&gt;");str=str.replace(/\"/gm,"&quot;");return str};_UTL.htmldeEnc=function(str){if(typeof str!="string")return"";str=str.replace(/&lt;/gm,"<");str=str.replace(/&gt;/gm,">");str=str.replace(/&quot;/gm,'"');str=str.replace(/&amp;/gim,"&");return str};_UTL.truebody=function(){return document.compatMode!="BackCompat"?document.documentElement:document.body};_UTL.getNodeJSONData=function(str){if(!str||typeof str!="string")return null;var rv=null;eval("rv="+str.replace(/\n+/g,"").replace(/\r+/g,"")+";");return rv};_UTL.getJSONData=function(str){var orv=null;if(typeof str=="string"){try{eval(" orv = "+str.replace(/[\r|\n]/gm,""))}catch(err){}}return orv};_UTL.formatObjectData=function(obj){if(!obj)return null;for(var dat in obj){switch(typeof obj[dat]){case"string":if(obj[dat]=="true")obj[dat]=true;else if(obj[dat]=="false")obj[dat]=false;else if(obj[dat].match(/^\d+$/))obj[dat]=Number(obj[dat]);break;case"object":obj[dat]=_UTL.formatObjectData(obj[dat]);break}}return obj};_UTL.getAbsPosition=function(el){if(!el)return null;var tb=_UTL.truebody();var ofx=el.offsetLeft;var ofy=el.offsetTop;var pel=el.offsetParent;var ix=0;var iy=0;if(pel){ix=pel.offsetLeft;iy=pel.offsetTop;var osc=null;while(pel.tagName.toLowerCase()!="body"){if(pel.clientHeight<pel.scrollHeight){osc=pel}pel=pel.offsetParent;if(!pel)break;ix+=pel.offsetLeft;iy+=pel.offsetTop}}if(osc&&osc.tagName.toLowerCase()!="div")osc=null;ofx+=ix;ofy+=iy;return{x:ofx,y:ofy,w:el.clientWidth,h:el.clientHeight,spos:_UTL.getAbsPosition(osc)}};_UTL.getEventPosition=function(e){if(!e)return{x:0,y:0};var tb=_UTL.truebody();var ix,iy;var offx=0;var offy=0;var sy,sx;if(typeof event!="undefined"){offx+=tb.scrollLeft;offy+=tb.scrollTop;sy=tb.scrollTop;sx=tb.scrollLeft;ix=e.clientX;iy=e.clientY}else{sy=window.pageYOffset;sx=window.pageXOffset;ix=e.pageX;iy=e.pageY}ix=ix+offx;iy=iy+offy;return{x:ix,y:iy}};_UTL.getOffColor=function(clr,off){clr=clr.toUpperCase().replace(/\s/g,"");var r,g,b;var m=clr.match(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/);if(m){r=Number("0x"+m[1]);g=Number("0x"+m[2]);b=Number("0x"+m[3])}else{m=clr.match(/rgb\((\d+),(\d+),(\d+)\)/i);if(m){r=Number(m[1]);g=Number(m[2]);b=Number(m[3])}else{r=128;g=128;b=128}}var sclr="#F0F0F0";if(!off)off=1;var cr=Math.floor(r*off);var cg=Math.floor(g*off);var cb=Math.floor(b*off);cr=cr>255?255:cr;cg=cg>255?255:cg;cb=cb>255?255:cb;sclr="#"+(cr<16?"0":"")+cr.toString(16)+(cg<16?"0":"")+cg.toString(16)+(cb<16?"0":"")+cb.toString(16);return sclr};_UTL.getTextColor=function(bgclr){bgclr=bgclr.toUpperCase();var r,g,b;var m=bgclr.match(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/);if(m){r=Number("0x"+m[1]);g=Number("0x"+m[2]);b=Number("0x"+m[3])}else{bgclr=bgclr.replace(/\s+/g,"");m=bgclr.match(/rgb\((\d+),(\d+),(\d+)\)/i);if(m){r=Number(m[1]);g=Number(m[2]);b=Number(m[3])}else{return"#000000"}}return r+g+b<255?"#FFFFFF":"#000000"};_UTL.getHostColorDefine=function(ocss,odef){if(!odef){odef={base:{bg:"#A1DBFF",txt:"#000000"},tint:{bg:"#B1D8F5",txt:"#000000"},deep:{bg:"#97BEDE",txt:"#000000"},div:{bg:"transparent",txt:"#000000"}}}if(!ocss)ocss={style:odef};if(ocss.backgroundColor&&ocss.backgroundColor!="null")odef.div.bg=ocss.backgroundColor;if(ocss.color&&ocss.color!="null")odef.div.txt=ocss.color;var m,ts;ts=ocss.style["base"];if(typeof ts=="string"){m=ts.match(/(#[0-9A-F]{6});(#[0-9A-F]{6})/i);if(m&&m[1]){odef.base.bg=m[1];odef.base.txt=m[2]?m[2]:_UTL.getTextColor(odef.base.bg);if(!odef.tint)odef.tint={};odef.tint.bg=_UTL.getOffColor(odef.base.bg,1.1);odef.tint.txt=_UTL.getTextColor(odef.tint.bg);if(!odef.deep)odef.deep={};odef.deep.bg=_UTL.getOffColor(odef.base.bg,.9);odef.deep.txt=_UTL.getTextColor(odef.deep.bg)}}for(var dat in ocss.style){if(dat=="base")continue;ts=ocss.style[dat];if(typeof ts=="string"){m=ts.match(/(#[0-9A-F]{6});(#[0-9A-F]{6})/i);if(m&&m[1]){if(!odef[dat])odef[dat]={bg:odef.base.bg,txt:odef.base.bg.txt};odef[dat].bg=m[1];if(m[2])odef[dat].txt=m[2]}}}return odef};_UTL.applyMyStylesheet=function(myst,doc){if(!doc)doc=document;if(_COMM.IE){var sheet=doc.createStyleSheet();for(var dat in myst){sheet.addRule("."+dat,myst[dat])}}else{var style=doc.createElement("style");style.type="text/css";var ts="";for(var dat in myst){ts+="."+dat+"{"+myst[dat]+"}"}style.innerHTML=ts;doc.getElementsByTagName("HEAD").item(0).appendChild(style)}};_UTL.shadow={};_UTL.shadow.add=function(el,off,op){if(!el)return false;var z=el.style.zIndex;var eid=el.id;if(z<1||!el.id||el.id=="")return false;z=Number(z)-1;var sid=el.id+"_shadow";var osd=_ZWF.$(sid);if(!osd){osd=document.createElement("DIV");osd.id=sid;document.body.appendChild(osd)}osd.style.display="";osd.style.position="absolute";osd.style.zIndex=z;var pos=_UTL.getAbsPosition(el);osd.style.left=pos.x+off+"px";osd.style.top=pos.y+off+"px";osd.style.width=el.offsetWidth+"px";osd.style.height=el.offsetHeight+"px";osd.style.background="#000000";if(typeof osd.style.filter!="undefined")osd.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+op+")";else osd.style.opacity=String(op/100);el.setAttribute("shadowID",sid);return true};_UTL.shadow.remove=function(el){if(!el)return false;var sid=el.getAttribute("shadowID");var osd=_ZWF.$(sid);if(osd){document.body.removeChild(osd)}};_UTL.isPass=function(tp,s){if(s.search(/[^\x00-\xff]/)!=-1)return false;switch(tp){case"1":case"sina":if(s.length<1)return false;break;case"2":case"say-on":if(s.length<1)return false;break;default:return false}return true};_UTL.isUserName=function(tp,s){switch(tp){case"1":case"sina":var slen=s.replace(/[^\x00-\xff]/g,"aa").length;if(slen<4)return false;if(s.match(/_$/))return false;break;case"2":case"say-on":if(s.length<6||!s.match(/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/))return false;break;default:return false}return true};_UTL.isNick=function(s){var slen=s.replace(/[^\x00-\xff]/g,"aa").length;if(slen<2||slen>20)return false;if(s.search(/(\'|\"|\:|\\|\)|\(|\[|\]|\?|,|;|&|#|@)/g)!=-1)return false;return true};_UTL.open=function(surl,tg){if(!tg)tg="_blank";if(typeof surl!="string"||surl=="")return;open(surl,tg);_STATS.add("open_url",encodeURIComponent(surl))};_UTL.getAbsPath=function(spath,sfile){spath=spath.replace(/\/$/,"");if(sfile.match(/^http/i))return sfile;while(sfile.search(/^\.\.\//)!=-1){spath=spath.substr(0,spath.lastIndexOf("/"));sfile=sfile.replace(/^\.\.\//,"")}return spath+"/"+sfile};_UTL.scrollIntoView=function(odiv,btop){if(!odiv)return null;var cnt=0;var op=odiv;var y=op.offsetTop;while(cnt<100){if(!op.offsetParent)break;op=op.offsetParent;if(op.clientHeight<op.scrollHeight){break}else{y+=op.offsetTop}cnt++}var sc=btop?y:y-op.clientHeight+odiv.offsetHeight;if(op.scrollTop<sc)op.scrollTop=sc};_UTL.importJS=function(jssrc,jsid,loadFun,chrset){var ojs=document.getElementById(jsid);if(!chrset)chrset="utf-8";if(ojs)document.body.removeChild(ojs);if(!document.body){document.write('<script type="text/javascript" id="'+jsid+'" src="'+jssrc+'"></scr'+"ipt>")}else{ojs=document.createElement("SCRIPT");ojs.charset=chrset;ojs.language="javascript";ojs.type="text/javascript";ojs.id=jsid;ojs.src=jssrc;if(typeof loadFun=="function"){if(typeof ojs.onreadystatechange=="undefined")ojs.onload=loadFun;else ojs.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="interactive"||this.readyState=="complete"){loadFun()}}}ojs=document.body.appendChild(ojs)}return false};_UTL.importCSS=function(css_file){var ocss;var el=document.getElementsByTagName("HEAD")[0];ocss=document.createElement("LINK");ocss.rel="stylesheet";ocss.type="text/css";ocss.href=css_file;el.appendChild(ocss)};_UTL.regModule=function(mname,module){var hid=_UTL.getUrlArg("hid");var pid=_UTL.getUrlArg("pid");if(!hid)return false;if(!pid)pid=hid;var wid=_UTL.getUrlArg("wid");var wgtid=_UTL.getUrlArg("wgtid");var modid=_UTL.getUrlArg("modid");if(!modid)modid=0;module.oifo={key:mname+"_"+_COMM.clientID,hid:hid,pid:pid,wid:wid,mname:mname,wgtid:wgtid,modid:modid,cid:_COMM.clientID,onHiddenNotify:pid,URL:document.URL.substr(0,document.URL.indexOf("?"))};_COMM.sendMessage(hid,{type:"registration",key:module.oifo.key,message:module.oifo});return true};_UTL.gotRegInfo=function(omsg,module){if(omsg.key=="settings"){module.oapp=omsg.message.oset;module.owner=module.oapp.owner;if(module.oapp.settings&&module.oapp.settings.comm&&module.oapp.settings.comm[module.oifo.mname])module.oset=module.oapp.settings.comm[module.oifo.mname];else module.oset=null;module.oifo.winInfo=omsg.message.winInfo;module.oifo.winInfo.SvrAddress.rssProxy+="?url=";module.oifo.args=omsg.message.args?omsg.message.args:null;if(omsg.message.auth){if(omsg.message.auth.cookies)omsg.message.auth.cookies=unescape(omsg.message.auth.cookies);if(document.location.host.match(/say\-on\.com/i)){omsg.message.auth.pkey=_UTL.getCookie("WDP")}module.oifo.auth=omsg.message.auth}else{module.oifo.auth=null}module.skinDefine=null;var m=module.oifo.winInfo.skin.subPath.match(/\/(.*)\/$/);var odef=module.oifo.winInfo.skin.cfg.skinDefine;if(m&&m[1]&&odef){for(var dat in odef){if(odef[dat].attributes.path==m[1]){module.skinDefine=odef[dat];module.skinDefine.skinID=dat;break}}}module.appData=module.oifo.winInfo.skin.cfg.appData;if(lanRes&&typeof lanRes.addLan=="function")lanRes.addLan(_UTL.getNodeJSONData(module.oifo.winInfo.skin.cfg.lanRes))}};_UTL.formatTime=function(timeStr,fmtStr){var ads=fmtStr.split(",");var hourStr=ads[0];var minStr=ads[1];var secStr=ads[2];var dayStr=ads[3];var monthStr=ads[4];var todayStr=ads[5];var yesterdayStr=ads[6];var agoStr=ads[7];var today=new Date;var msgDate=new Date(Number(timeStr));var hour=msgDate.getHours();var minute=msgDate.getMinutes();if(hour<10){hour="0"+hour}if(minute<10){minute="0"+minute}var ONE_DAY=1e3*60*60*24;var newDate1=new Date(today.getYear(),today.getMonth(),today.getDate());var newDate2=new Date(msgDate.getYear(),msgDate.getMonth(),msgDate.getDate());var diffInMs=Math.abs(newDate1.getTime()-newDate2.getTime());var dateDiff=Math.round(diffInMs/ONE_DAY);var time=hour+":"+minute;if(dateDiff==0){return todayStr+time}else if(dateDiff==1){return yesterdayStr+time}else if(dateDiff<=7){return dateDiff+agoStr}else{return msgDate.getMonth()+1+monthStr+msgDate.getDate()+dayStr}};_UTL.getSinaUserPortrait=function(uid,product,size){var svr=uid%8+1;if(!size)size=30;if(!product)product="default";return"http://portrait"+svr+".sinaimg.cn/"+uid+"/"+product+"/"+size};_UTL.getSinaPengyouPortrait=function(uid,size){return"http://webim.pengyou.sina.com.cn/webchat/icon/?uid="+uid+"&size="+size};_UTL.cancelClick=function(e){if(typeof event!="undefined"){window.event.cancelBubble=true}else if(e)e.stopPropagation()};_UTL.getIEVersion=function(){var m=navigator.appVersion.match(/MSIE (\d\.\d);/);return m&&m[1]?Number(m[1]):0};_UTL.setHTML=function(elid,str){var el=document.getElementById(elid);if(el)el.innerHTML=str};_UTL.getHTML=function(elid){var el=document.getElementById(elid);return el?el.innerHTML:null};_UTL.observe=function(el,eventName,funcName,useCapture){if(el.addEventListener){el.addEventListener(eventName,funcName,useCapture)}else el.attachEvent("on"+eventName,funcName,useCapture)};_UTL.addEventListener=function(el,eventName,funcName,useCapture){if(typeof useCapture!="boolean")useCapture=false;if(el.addEventListener){el.addEventListener(eventName,funcName,useCapture)}else if(el.attachEvent)el.attachEvent("on"+eventName,funcName)};_UTL.removeEventListener=function(el,eventName,funcName,useCapture){if(typeof useCapture!="boolean")useCapture=false;if(el.removeEventListener){el.removeEventListener(eventName,funcName,useCapture)}else if(el.attachEvent)el.detachEvent("on"+eventName,funcName)};_UTL.getEvent=function(){if(typeof window.event!="undefined")return window.event;var func=_UTL.getEvent.caller;while(func!=null){var arg0=func.arguments[0];if(arg0){if(arg0.constructor==Event||arg0.constructor==MouseEvent)return arg0}func=func.caller}return null};_UTL.eventFollowShow=function(e,odiv,offx,offy){var tb=_UTL.truebody();var ix,iy;if(typeof offx=="undefined")offx=0;if(typeof offy=="undefined")offy=0;var sy,sx;if(typeof event!="undefined"){offx+=tb.scrollLeft;offy+=tb.scrollTop;sy=tb.scrollTop;sx=tb.scrollLeft;ix=event.clientX;iy=event.clientY}else{sy=window.pageYOffset;sx=window.pageXOffset;ix=e.pageX;iy=e.pageY}ix=ix+offx;iy=iy+offy;var h=odiv.clientHeight;var w=odiv.clientWidth;if(iy+h>sy+tb.clientHeight){iy-=h}if(ix+w>sx+tb.clientWidth){ix-=w}ix=isNaN(ix)||ix<0?0:ix;iy=isNaN(iy)||iy<0?0:iy;odiv.style.left=ix+"px";odiv.style.top=iy+"px"};_UTL.setFixedStyle=function(el,btop,bleft){if(_COMM.IE6||navigator.appName.indexOf("Microsoft")!=-1&&document.compatMode=="BackCompat"){var es="top:expression(eval( window.document.compatMode && window.document.compatMode=='CSS1Compat') ? "+"window.document.documentElement.scrollTop "+(btop?"":"+ (window.document.documentElement.clientHeight - this.clientHeight)")+" : "+" window.document.body.scrollTop "+(btop?"":" + (window.document.body.clientHeight - this.clientHeight) ")+");";el.style.cssText="position:absolute;"+es;try{document.body.scrollTop++;document.body.scrollTop--}catch(err){}}else{el.style.top=btop?"0px":"auto";el.style.bottom=btop?"auto":"0px";el.style.position="fixed"}el.style.left=bleft?"0px":"auto";el.style.right=bleft?"auto":"0px"};_UTL.blind={bid:"_widget_blind_div",obd:null};_UTL.blind.show=function(z,clr,opt){var bid=_UTL.blind.bid;if(!_UTL.blind.obd){_UTL.blind.obd=document.createElement("DIV");_UTL.blind.obd.id=bid;document.body.appendChild(_UTL.blind.obd)}if(!z)z=1e3;if(!opt)opt=15;if(!clr)clr="#ffffff";var obd=_UTL.blind.obd;obd.style.display="";var tb=_UTL.truebody();obd.style.position="absolute";obd.style.zIndex=z;obd.style.width=tb.scrollWidth+"px";obd.style.height=tb.scrollHeight+"px";obd.style.left="0px";obd.style.top="0px";obd.style.background=clr;if(typeof obd.style.filter!="undefined")obd.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+opt+")";else obd.style.opacity=opt/100;return obd};_UTL.blind.hide=function(){if(_UTL.blind.obd){document.body.removeChild(_UTL.blind.obd);_UTL.blind.obd=null}};_UTL.setCookie=function(name,value,expires,path,domain,secure){document.cookie=name+"="+escape(value)+(expires?"; expires="+expires.toGMTString():"")+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+(secure?"; secure":"")};_UTL.getCookie=function(name){var dc=document.cookie;var prefix=name+"=";var begin=dc.indexOf("; "+prefix);if(begin==-1){begin=dc.indexOf(prefix);if(begin!=0)return null}else{begin+=2}var end=document.cookie.indexOf(";",begin);if(end==-1){end=dc.length}return unescape(dc.substring(begin+prefix.length,end))};_UTL.deleteCookie=function(name,path,domain){if(_UTL.getCookie(name)){document.cookie=name+"="+(path?"; path="+path:"")+(domain?"; domain="+domain:"")+"; expires=Thu, 01-Jan-70 00:00:01 GMT"}};_UTL.getUrlArg=function(akey,surl){var re=new RegExp("[\\?|&]"+akey+"=([^&]*)(&|$)","i");if(!surl)surl=document.URL;var m=surl.match(re);if(m&&m[1]){return unescape(m[1])}return null};var _ZXML={cbFun:null,readyState:"uninitialized",req:null};_ZXML.loadXMLStr=function(xmls){if(!xmls||typeof xmls!="string")return null;xmls=_ZXML.formatXMLstr(xmls);var xmlDom;if(window.ActiveXObject){var arrSignatures=["Microsoft.XmlDom","MSXML2.DOMDocument.4.0","MSXML2.DOMDocument.5.0","MSXML2.DOMDocument.3.0","MSXML2.DOMDocument"];for(var i=0;i<arrSignatures.length;i++){try{var xmlDom=new ActiveXObject(arrSignatures[i]);break}catch(oError){}}xmlDom.preserveWhiteSpace=false;xmlDom.loadXML(xmls);if(xmlDom.parseError.errorCode!=0)return null}else{var oParser=new DOMParser;xmlDom=oParser.parseFromString(xmls,"text/xml");if(xmlDom.documentElement.tagName=="parsererror")return null}if(!xmlDom||!xmlDom.firstChild)return null;return xmlDom};_ZXML.loadXMLDoc=function(surl,cbFun){if(_ZXML.readyState!="complete"){_ZXML.queue.push({URL:surl,fun:cbFun});return}_ZXML.cbFun=typeof cbFun=="function"?cbFun:function(){};if(_ZXML.req){_ZXML.req.open("GET",surl,true);_ZXML.req.send("");_ZXML.readyState="loading"}};_ZXML.RSS2Obj=function(oxml){if(!oxml)return null;var otg=oxml.getElementsByTagName("rss");if(!otg||otg.length==0)return null;var orss=_ZXML.XML2Obj(otg[0]);return orss};_ZXML.XML2Obj=function(oxml){if(!oxml)return null;var obj={};var ond,nn,nt,nv,np;if(oxml.attributes&&oxml.attributes.length>0){obj.attributes={};for(var i=0;i<oxml.attributes.length;i++){obj.attributes[oxml.attributes[i].name]=oxml.attributes[i].value}}for(var i=0;i<oxml.childNodes.length;i++){ond=oxml.childNodes[i];nn=ond.nodeName;switch(ond.nodeType){case 1:var orv=_ZXML._objAddNodeValue(obj,nn,_ZXML.XML2Obj(ond));if(orv&&typeof orv!="function")obj[nn]=orv;break;case 3:case 4:if(ond.nodeValue.replace(/\s*/gm,"")==""){break}if(nn=="#text"||nn=="#cdata-section"||oxml.childNodes.length<2&&oxml.attributes.length==0){obj=ond.nodeValue}else{nn=nn.replace(/^#/,"");var orv=_ZXML._objAddNodeValue(obj,nn,ond.nodeValue);if(orv&&typeof orv!="function")obj[nn]=orv}break;case 7:break;default:nn=nn.replace(/^#/,"");var orv=_ZXML._objAddNodeValue(obj,nn,ond.nodeValue);if(orv&&typeof orv!="function")obj[nn]=orv;break}}return obj};_ZXML._objAddNodeValue=function(obj,nn,nv){var ot=obj[nn];var orv=new Array;if(typeof ot=="object"&&typeof ot.length!="undefined"){orv=ot.concat(nv);return orv}if(typeof ot!="undefined"&&typeof ot!="function"){orv.push(ot);orv.push(nv);return orv}return nv};_ZXML.Obj2XML=function(obj,objName){if(typeof obj!="object")return null;var xmlstr=_ZXML._obj2xmlstr(obj,null);return _ZXML.loadXMLStr(xmlstr)};_ZXML._obj2xmlstr=function(obj,objName){if(!obj)return"<"+objName+"/>";var ts="";var atts="";for(var dat in obj){if(dat=="attributes"){for(var ad in obj[dat]){atts+=ad+'="'+_UTL.htmlEnc(obj[dat][ad])+'" '}continue}switch(typeof obj[dat]){case"object":if(!obj[dat]||typeof obj[dat].length=="undefined"){ts+=_ZXML._obj2xmlstr(obj[dat],dat)}else{for(var j=0;j<obj[dat].length;j++){ts+=_ZXML._obj2xmlstr(obj[dat][j],dat)}}break;case"function":break;default:if(dat=="comment"){ts+="<!--"+obj[dat]+"-->"}else{if(!obj[dat]){ts+="<"+dat+"/>"}else{ts+="<"+dat+">";if(obj[dat].length<256&&obj[dat].search(/\n/)==-1)ts+=_UTL.htmlEnc(obj[dat]);else ts+="<![CDATA["+obj[dat]+"]]>";ts+="</"+dat+">"}}break}}if(ts==""&&obj.toString().search(/object/)==-1)ts=obj.toString();if(objName)ts="<"+objName+" "+atts+" >"+ts+"</"+objName+">";return ts};_ZXML.getArray=function(obj){var ar=[];if(obj){if(typeof obj.length=="undefined")ar[0]=obj;else ar=obj}return ar};_ZXML.formatXMLstr=function(xmls){var es='<?xml version="1.0" encoding="UTF-8"?>';var m=xmls.match(/<\?xml.*encoding="(.*)"\?>/);if(!m)xmls=es+xmls.replace(/<\?xml.*\?>/,"");return xmls};_ZXML.init=function(){if(window.XMLHttpRequest){try{_ZXML.req=new XMLHttpRequest}catch(e){_ZXML.req=false}}else if(window.ActiveXObject){try{_ZXML.req=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){try{_ZXML.req=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){_ZXML.req=false}}}if(_ZXML.req){_ZXML.req.onreadystatechange=function(){if(_ZXML.req.readyState==4&&_ZXML.req.status==200&&_ZXML.req.responseXML){if(typeof _ZXML.cbFun=="function")_ZXML.cbFun(req.responseXML);_ZXML.readyState="complete";var oq=_ZXML.queue.shift();if(oq)_ZXML.loadXMLDoc(oq.URL,oq.fun)}}}_ZXML.readyState="complete"};_COMM={IE:navigator.appName.indexOf("Microsoft")!=-1,IE6:navigator.appVersion.match(/MSIE [1-6]\.\d/),auth:{},staticServer:"",readyState:"uninitialized",onComLoad:null,onBroadcast:[],clientID:null,queue:new Array,callback:{},reqCallback:{},logChkWaits:[],docLoadingCounter:1e3,chkTimeout:null,chkInitFailed:false,ofl:null,chkInv:null};_COMM.init=function(commid){if(!document.body){window.setTimeout("_COMM.init()",1e3);return}_STATS.init();var jss=document.getElementsByTagName("SCRIPT");var m;for(var i=0;i<jss.length;i++){m=jss[i].src.match(/(.*\/)comm\.js/);if(m){_COMM.staticServer=m[1];break}}var el=document.getElementById("_commFlashDiv");if(!el){el=document.createElement("DIV");el.id="_commFlashDiv";el.style.width="0px";el.style.height="0px";document.body.appendChild(el);var TT=true;var ts;var fv=(typeof commid=="string"?"commid="+commid+"&":"")+"setReadyState=_COMM.setReadyState&onLoad=_COMM.onLoadCallback&BC_JSCallback=_COMM.gotMessage&MP3_callBack=_MP3.onCallBack";if(_COMM.IE){ts='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="_commFlash_ob" style="width:0px;height:0px;">'+'<param name="allowScriptAccess" value="always" />'+'<param name="allowNetworking" value="all" />'+'<param name="wmode" value="Window"/>'+'<param name="FlashVars" value="'+fv+'" />'+'<param name="movie" value="'+_COMM.staticServer+"comm.swf"+(TT?"?"+Math.random():"")+'" /></object>';el.innerHTML=ts}else{var ver=[0,0,0];if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){ver=x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split(".");if(ver[0]=="9"&&ver[1]=="0"&&Number(ver[2])<115){_COMM.msgQueueNeedCallback=true}}}ts='<embed src="'+_COMM.staticServer+"comm.swf?"+Math.random()+'" wmode="Window" FlashVars="'+fv+'" width="0" height="0"  name="_commFlash_em" allowScriptAccess="always" type="application/x-shockwave-flash" swLiveConnect="true" pluginspage="http://www.macromedia.com/go/getflashplayer" />';try{el.innerHTML=ts}catch(err){}}}_COMM.chkTimeout=window.setTimeout("_COMM.checkFailed()",1e4);_COMM.chkInv=window.setInterval(_COMM.checkFlash,100)};_COMM.checkFailed=function(){_COMM.chkInitFailed=true;var el=document.getElementById("_commFlashDiv");if(el)el.innerHTML="";_COMM.onLoadCallback(null)};_COMM.checkFlash=function(){try{if(_COMM.IE){_COMM.ofl=window["_commFlash_ob"]}else{_COMM.ofl=document["_commFlash_em"]}if(_COMM.ofl){if(typeof _COMM.ofl.setFlashReady=="function"){_COMM.ofl.setFlashReady()}}}catch(err){}};_COMM.onLoadCallback=function(commid){if(_COMM.chkInv)window.clearInterval(_COMM.chkInv);if(_COMM.chkTimeout)window.clearTimeout(_COMM.chkTimeout);_COMM.clientID=commid;if(commid){_COMM.docLoadingCounter=0;if(typeof _ZWF!="undefined")_COMM.checkLoginStatus();if(typeof _COMM.onComLoad=="function")window.setTimeout("_COMM.onComLoad()",200)}};_COMM.checkLoginStatus=function(cbFun,oau){if(typeof cbFun=="function"){_COMM.logChkWaits.push(cbFun)}_COMM.gotAuth(oau)};_COMM.gotAuth=function(oau){var cks=_COMM.auth.cookies;if(oau){_COMM.auth=oau}_COMM.getSinaCookie(cks);if(document.location.host.match(/say\-on\.com/i)){var scks=_UTL.getCookie("WDP");if(scks)_COMM.auth.pkey=scks}_COMM.auth.loginAccList=_COMM.getLoginAccList();if(_COMM.auth.bLogin&&typeof _ZWF!="undefined"&&_ZWF.hubServer){_ZWF.mainServer=_ZWF.hubServer}var afun;for(var i=0;i<_COMM.logChkWaits.length;i++){if(typeof _COMM.logChkWaits[i]=="function")_COMM.logChkWaits[i](_COMM.auth)}_COMM.logChkWaits=[]};_COMM.deleteAuth=function(){_COMM.deleteCookie("auth")};_COMM.saveAuth=function(oau){if(!oau)oau=_COMM.auth;oau.loginAccList={};_COMM.setCookie("auth","loginInfo",oau)};_COMM.getLoginAccList=function(){var alg={};_COMM.auth.bLogin=0;if(!_COMM.auth)return alg;var sui=_COMM.getSinaCookieInfo(_COMM.auth.cookies);if(sui.uid){_COMM.auth.sinaUserInfo=sui;alg["sina"]={cookies:_COMM.auth.cookies};_COMM.auth.bLogin|=1}var d=new Date;if(_COMM.auth.pkey&&_COMM.auth.pkey!="null"&&_COMM.auth.expireDate&&_COMM.auth.expireDate>d.valueOf()){alg["say-on"]={pkey:_COMM.auth.pkey};_COMM.auth.bLogin|=2}return alg};_COMM.getAuthShortcut=function(module,oau){module.auth={isMine:false,isSinaUser:false,isSayOnUser:false,isLogin:false};if(document.location.host.match(/say\-on\.com/i)){_COMM.auth.pkey=_UTL.getCookie("WDP")}if(oau&&oau.bLogin>0){module.auth.isLogin=oau.bLogin;module.auth.isSinaUser=oau.sinaUserInfo&&oau.sinaUserInfo.uid&&oau.sinaUserInfo.uid!="null"&&oau.sinaUserInfo.uid!="";var d=new Date;module.auth.isSayOnUser=oau.pkey&&oau.pkey!="null"&&oau.expireDate&&oau.expireDate>d.valueOf();if(module.oifo.winInfo.hostPage.search(/sina\.com\.cn/i)==-1)module.auth.isMine=module.owner.uid==oau.uid&&oau.bLogin;else module.auth.isMine=module.auth.isSinaUser&&module.owner&&module.owner.sina.uid==oau.sinaUserInfo.uid&&oau.bLogin}};_COMM.getSinaCookieInfo=function(cks){var sui={uid:null,username:null,nick:null};if(typeof cks!="string")cks=document.cookie;var mSUP=cks.match(/(^|\s)SUP=([^;]*)/);if(mSUP&&mSUP[2]){var ssup=unescape(mSUP[2]);var asup=ssup.split("&");var def={uid:"uid",user:"username",nick:"nick"};var aitm,itm;for(var i=0;i<asup.length;i++){aitm=asup[i].split("=");itm=def[aitm[0]];if(itm){sui[itm]=aitm[1]}else{sui[aitm[0]]=aitm[1]}}if(sui.uid&&!sui.nick)sui.nick=sui.username}else if(cks.search(/SE=/)!=-1&&cks.search(/SU=/)!=-1){var mSE=cks.match(/SE=([0-9A-F]+)/m);var reSU=/SU=([^:]+):(\d+):(\d+):(.*):(\d+):(.*):(.*):(.*)/m;var mSU=cks.match(reSU);if(!mSU)mSU=unescape(cks).match(reSU);var renk=/nick=([^=|;]*)\((\d+)\)(;|$)/m;var mnick=cks.match(renk);if(!mnick||!mnick[1])mnick=unescape(cks).match(renk);if(mSE&&mSE[1]&&mSU&&mSU[1]&&mSU[3]){var sui={uid:mSU[3],username:unescape(mSU[1]),nick:mnick&&mnick[1]?mnick[1]:""};if(sui.nick.search("%")!=-1)sui.nick=unescape(sui.nick)}}if(sui.uid){var m=cks.match(/blog_nickname_ria=([^;|$]*)(;|$)/m);if(m&&m[1])sui.nick=unescape(m[1])}return sui};_COMM.formatSinaCookie=function(cks){if(!cks)return"";cks=cks.replace(/(\r|\n)+/gm,"");var ack=cks.split("Set-Cookie:");var m;var s="";for(var i=0;i<ack.length;i++){if(!ack[i].match(/\w+=.*;/))continue;s+=ack[i].substr(0,ack[i].indexOf(";")+1)}return s!=""&&ack.length>1?s:cks};_COMM.saveSinaCookie=function(cks){if(!cks)return;cks=cks.replace(/(\r|\n)+/gm,"");var ack=cks.split("Set-Cookie:");var m;for(var i=0;i<ack.length;i++){if(!ack[i].match(/\w+=.*;/))continue;document.cookie=ack[i]}_COMM.auth.cookies=_COMM.formatSinaCookie(cks)};_COMM.getSinaCookie=function(cks){if(document.location.host.match(/sina\.com\.cn/i)){_COMM.auth.cookies=document.cookie;var sui=_COMM.getSinaCookieInfo(_COMM.auth.cookies);if(!sui.uid)_COMM.auth.pkey=""}else{var sui=_COMM.getSinaCookieInfo(cks);var sui1=_COMM.getSinaCookieInfo(_COMM.auth.cookies);if(!sui1.uid||sui.uid&&sui.uid!=sui1.uid)_COMM.auth.cookies=cks}_COMM.setCookie("auth","loginInfo",_COMM.auth)};_COMM.spam={uic:"http://uic.sinajs.cn/spam?str=",buff:{}};_COMM.spam.check=function(kw,cbFun){if(typeof cbFun!="function"||typeof kw!="string"||kw.replace(/\s/gm)=="")return false;var str=encodeURIComponent(kw.replace(/[\r|\n|\s]/gm,""));if(str.length>1e3)return false;var obuf=_COMM.spam.buff[str];if(obuf&&typeof obuf.fun=="function"){obuf.fun(obuf.rv);return true}_COMM.spam.buff[str]={fun:cbFun,rv:null};_COMM.loadXMLDoc(_COMM.spam.uic+str,_COMM.spam.callback);return true};_COMM.spam.callback=function(xmls,surl){var str=surl.replace(_COMM.spam.uic,"");var obuf=_COMM.spam.buff[str];if(obuf){obuf.rv=xmls=="-1";if(typeof obuf.fun=="function"){obuf.fun(obuf.rv)}}};_COMM.setReadyState=function(statStr){_COMM.readyState=statStr};_COMM.getReadyState=function(){return _COMM.readyState};_COMM.sendNotify=function(to,obj){if(_COMM.msgQueue.length>0)return false;try{if(_COMM.IE){var afun=_COMM.ofl.sendMessage;afun("_R_"+to,obj,false)}else{_COMM.ofl.sendMessage("_R_"+to,obj,false)}}catch(err){return false}return true};_COMM.msgQueue=[];_COMM.sendMessage=function(to,obj){_COMM.msgQueue.push({to:to,obj:obj});if(_COMM.msgQueue.length==1){_COMM.execMsgQueue()}};_COMM.msgInProgress=0;_COMM.msgQueueRetryCounter=0;_COMM.msgQueueRevID="";_COMM.msgQueueNeedCallback=true;_COMM.execMsgQueue=function(){var nextRun=false;var succ=true;if(_COMM.msgInProgress<1||!_COMM.msgQueueNeedCallback){if(_COMM.msgQueue.length>0){try{if(_COMM.IE){var afun=_COMM.ofl.sendMessage;afun("_R_"+_COMM.msgQueue[0].to,_COMM.msgQueue[0].obj,_COMM.msgQueueNeedCallback)}else{_COMM.ofl.sendMessage("_R_"+_COMM.msgQueue[0].to,_COMM.msgQueue[0].obj,_COMM.msgQueueNeedCallback)}}catch(err){nextRun=true;succ=false;_COMM.msgQueueRetryCounter++;if(_COMM.msgQueueRetryCounter>500)_COMM.onFlashGotMessage()}if(succ){_COMM.msgInProgress++;_COMM.msgQueueRetryCounter=0;if(!_COMM.msgQueueNeedCallback)window.setTimeout("_COMM.onFlashGotMessage()",100)}if(_COMM.msgQueue.length>0)nextRun=true}}else{nextRun=true}if(nextRun){window.setTimeout("_COMM.execMsgQueue()",200)}};_COMM.onFlashGotMessage=function(){_COMM.msgQueue.shift();_COMM.msgInProgress--};_COMM.gotMessage=function(sender,omsg){if(typeof _COMM.onMessage=="function"){_COMM.onMessage(sender,omsg)}};_COMM.docQueue=[];_COMM.docQueueRetryCounter=0;_COMM.loadXMLDoc=function(surl,cbFun){_COMM.docQueue.push({surl:surl,cbFun:cbFun});if(_COMM.docQueue.length==1){_COMM.execDocQueue()}};_COMM.execDocQueue=function(){var nextRun=false;var succ=true;if(_COMM.docLoadingCounter<2&&_COMM.readyState=="complete"){if(_COMM.docQueue.length>0){var aq=_COMM.docQueue[0];try{if(_COMM.IE){var afun=_COMM.ofl.loadData;afun(aq.surl,"_COMM.gotXMLStr")}else{_COMM.ofl.loadData(aq.surl,"_COMM.gotXMLStr")}}catch(err){nextRun=true;succ=false;_COMM.docQueueRetryCounter++}if(succ){_COMM.docLoadingCounter++;_COMM.readyState=="loading";_COMM.callback[aq.surl]=typeof aq.cbFun=="function"?aq.cbFun:function(){};var oq=_COMM.docQueue.shift();_COMM.docQueueRetryCounter=0}if(_COMM.docQueueRetryCounter>50)_COMM.docQueue.shift();if(_COMM.docQueue.length>0)nextRun=true}}else{nextRun=true}if(nextRun){window.setTimeout("_COMM.execDocQueue()",100)}};_COMM.gotXMLStr=function(xmls,surl){_COMM.setReadyState("complete");_COMM.docLoadingCounter--;var afun=_COMM.callback[surl];if(typeof afun=="function"){afun(xmls,surl)}};_COMM.xmlQueue=[];_COMM.xmlLoadingCounter=0;_COMM.xmlQueueRetryCounter=0;_COMM.sendXML=function(surl,xmls,cbFun){xmls=_ZXML.formatXMLstr(xmls);_COMM.xmlQueue.push({surl:surl,xmls:xmls,cbFun:cbFun});if(_COMM.xmlQueue.length==1){_COMM.execXmlQueue()}};_COMM.execXmlQueue=function(){var nextRun=false;var succ=true;if(_COMM.xmlLoadingCounter<3){if(_COMM.xmlQueue.length>0){var aq=_COMM.xmlQueue[0];try{if(_COMM.IE){var afun=_COMM.ofl.reqXML;afun(aq.surl,aq.xmls,"_COMM.sendXMLCallback")}else{_COMM.ofl.reqXML(aq.surl,aq.xmls,"_COMM.sendXMLCallback")}}catch(err){nextRun=true;succ=false;_COMM.xmlQueueRetryCounter++}if(succ){_COMM.reqCallback[aq.surl]=typeof aq.cbFun=="function"?aq.cbFun:function(){};_COMM.xmlLoadingCounter++;var oq=_COMM.xmlQueue.shift();_COMM.xmlQueueRetryCounter=0}if(_COMM.xmlQueueRetryCounter>50)_COMM.xmlQueue.shift();if(_COMM.xmlQueue.length>0)nextRun=true}}else{nextRun=true}if(nextRun){window.setTimeout("_COMM.execXmlQueue()",100)}};_COMM.sendXMLCallback=function(xmls,surl){_COMM.setReadyState("complete");var fun=_COMM.reqCallback[surl];if(typeof fun=="function"){fun(xmls,surl)}_COMM.xmlLoadingCounter--};_COMM.setCookie=function(type,key,obj){try{return _COMM.ofl.setCookie(type,key,obj)}catch(err){return false}};_COMM.getCookie=function(type,key,cbFun){var rv="";try{_COMM.cbFun_Cookie=typeof cbFun=="function"?cbFun:function(){};rv=_COMM.ofl.getCookie(type,key,"_COMM.gotCookie")}catch(err){}return rv};_COMM.gotCookie=function(obj){if(typeof _COMM.cbFun_Cookie=="function")_COMM.cbFun_Cookie(obj)};_COMM.deleteCookie=function(type){return _COMM.ofl.deleteCookie(type)};_STATS={svr:"http://widget.say-on.com/go/stats.do",queue:[],el:null};_STATS.init=function(){var el=document.getElementById("_say-on_Stats_ImgElement");if(!el){el=document.createElement("IMG");el.id="_say-on_Stats_ImgElement";el.style.width="0px";el.style.height="0px";document.body.appendChild(el)}_STATS.el=el};_STATS.add=function(sid,desc,uid){if(!sid)return;if(!uid){if(_COMM&&_COMM.auth){if(_COMM.auth.uid)uid=_COMM.auth.uid;else if(_COMM.auth.sinaUserInfo&&_COMM.auth.sinaUserInfo.uid)uid=_COMM.auth.sinaUserInfo.uid}if(!uid)uid=""}if(!desc)desc="";var s="?d="+(new Date).valueOf()+"&sid="+sid+"&uid="+uid+"&desc="+encodeURIComponent(desc);_STATS.queue.push(s);if(_STATS.queue.length==1)_STATS.execQueue()};_STATS.execQueue=function(){if(!_STATS.el||_STATS.queue.length<1)return;var s=_STATS.queue.shift();_STATS.el.src=_STATS.svr+s;if(_STATS.queue.length>0)window.setTimeout("_STATS.execQueue()",1e3);

};_MP3={};_MP3.info={};_MP3.event={onLoadStatusChange:null,onPlayPositionChange:null,onLoad:null,onLoadFailed:null,onID3:null,onSoundComplete:null,onStart:null,onPause:null,onStop:null,onMute:null};_MP3.onCallBack=function(ev,oifo){this.info=oifo;if(typeof this.event[ev]=="function")this.event[ev](oifo)};_MP3.load=function(surl){if(!surl||surl=="")return;_COMM.ofl.Sound_load(surl)};_MP3.start=function(sec){if(!sec)sec=_MP3.info.pausePoint;_COMM.ofl.Sound_start(sec)};_MP3.stop=function(){_COMM.ofl.Sound_stop()};_MP3.pause=function(){_COMM.ofl.Sound_pause()};_MP3.mute=function(){_COMM.ofl.Sound_mute()};_MP3.play=function(surl){var curl=this.info.currURL;if(!curl)curl="";if(!surl||surl=="")surl=curl;if(surl!=""&&surl!=this.info.currURL){this.load(surl);this.info.isPlaying=true}else{if(this.info.isPlaying)this.pause();else this.start()}};var _PNG={};_PNG.setBackground=function(itm,imgpath,mod){if(!itm)return;if(!mod)mod="scale";if(_COMM.IE6&&typeof itm.style.filter!="undefined"&&imgpath.match(/\.png$/i)){itm.style.backgroundImage="none";itm.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod="+mod+', src="'+imgpath+'");'}else{itm.style.backgroundImage=imgpath&&imgpath!=""?'url("'+imgpath+'")':"none"}};_PNG.getBgStr=function(imgs){var s="";if(_COMM.IE6&&imgs.match(/\.png$/i)){s="background-image:none;	filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=scale, src='"+imgs+"');"}else{s="background-image:url('"+imgs+"') ;"}return s};_PNG.correct=function(oimg){if(!oimg||oimg.src.search(/.png$/gi)==-1||typeof document.body.style.filter=="undefined")return;var imgID=oimg.id?"id='"+oimg.id+"' ":"";var imgClass=oimg.className?"class='"+oimg.className+"' ":"";var imgTitle=oimg.title?"title='"+oimg.title+"' ":"title='"+oimg.alt+"' ";var imgStyle="display:inline-block;"+oimg.style.cssText;var iatts=oimg.attributes;var imgEvents="";for(var j=0;j<iatts.length;j++){var iatt=iatts[j];if(!iatt.nodeName||iatt.nodeName.toLowerCase()=="onload"||!iatt.nodeValue)continue;if(iatt.nodeName=="align"){if(iatt.nodeValue=="left")imgStyle="float:left;"+imgStyle;if(iatt.nodeValue=="right")imgStyle="float:right;"+imgStyle}else{imgEvents+=" "+iatt.nodeName+'="'+iatt.nodeValue+'"'}}var s="<span "+imgID+imgClass+imgTitle+imgEvents;s+=' style="'+"width:"+oimg.width+"px; height:"+oimg.height+"px;"+imgStyle+";";s+="filter:progid:DXImageTransform.Microsoft.AlphaImageLoader";s+="(src='"+oimg.src+"', sizingMethod='scale');\"></span>";oimg.outerHTML=s};var _ZDrag={dragObj:null,clickObj:null,overObj:null,event:null,cursor:"default",offx:0,offy:0,sx:0,sy:0,dropfun:null,movefun:null,docmove:null,docup:null,oblind:null,obg:null,start:function(e,el,dropfun,movefun){_ZDrag.event=e?e:window.event?window.event:null;_ZDrag.dragObj=el;_ZDrag.clickObj=_ZDrag.event.target||_ZDrag.event.srcElement;var ob=document.createElement("DIV");ob.style.position="absolute";ob.style.zIndex=_ZDrag.dragObj.style.zIndex+1;ob.style.top=_ZDrag.dragObj.style.top;ob.style.left=_ZDrag.dragObj.style.left;ob.style.width=_ZDrag.dragObj.style.width;ob.style.height=_ZDrag.dragObj.style.height;document.body.appendChild(ob);_ZDrag.oblind=ob;var tb=_UTL.truebody();ob=_UTL.blind.show(_ZDrag.dragObj.style.zIndex-1,"#ffffff",5);if(_ZDrag.oblind.setCapture)_ZDrag.oblind.setCapture();else if(window.captureEvents)window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);_ZDrag.dragObj.style.position="absolute";_ZDrag.cursor=_ZDrag.dragObj.style.cursor;_ZDrag.dragObj.style.cursor="move";if(typeof window.pageYOffset=="undefined"){_ZDrag.sy=tb.scrollTop;_ZDrag.sx=tb.scrollLeft}else{_ZDrag.sy=window.pageYOffset;_ZDrag.sx=window.pageXOffset}_ZDrag.offx=_ZDrag.event.clientX-_ZDrag.oblind.offsetLeft+_ZDrag.sx;_ZDrag.offy=_ZDrag.event.clientY-_ZDrag.oblind.offsetTop+_ZDrag.sy;_ZDrag.dropfun=typeof dropfun=="function"?dropfun:null;_ZDrag.movefun=typeof movefun=="function"?movefun:null;_ZDrag.docmove=document.onmousemove;document.onmousemove=_ZDrag.draging;_ZDrag.docup=document.onmouseup;document.onmouseup=_ZDrag.stop},draging:function(e){if(_ZDrag.dragObj){var tb=_UTL.truebody();var i=(e?e.pageY:_ZDrag.event.clientY+_ZDrag.sy)-_ZDrag.offy;if(i>0&&i+_ZDrag.dragObj.clientHeight<tb.scrollHeight){_ZDrag.dragObj.style.top=i+"px";_ZDrag.oblind.style.top=i+"px"}i=(e?e.pageX:_ZDrag.event.clientX+_ZDrag.sx)-_ZDrag.offx;if(i>0&&i+_ZDrag.dragObj.clientWidth<tb.scrollWidth){_ZDrag.dragObj.style.left=i+"px";_ZDrag.oblind.style.left=i+"px"}_ZDrag.dragObj.style.bottom="auto";_ZDrag.dragObj.style.right="auto";_ZDrag.overObj=_ZDrag.event.target||_ZDrag.event.srcElement}if(_ZDrag.movefun&&_ZDrag.overObj){_ZDrag.movefun(_ZDrag.overObj)}},stop:function(){if(_ZDrag.dragObj){_ZDrag.dragObj.style.cursor=_ZDrag.cursor}if(_ZDrag.dropfun){_ZDrag.dropfun(_ZDrag.overObj)}_ZDrag.dropfun=null;_ZDrag.movefun=null;_ZDrag.event=null;_ZDrag.dragObj=null;_ZDrag.overObj=null;document.onmousemove=_ZDrag.docmove;document.onmouseup=_ZDrag.docup;if(_ZDrag.oblind&&_ZDrag.oblind.releaseCapture){_ZDrag.oblind.releaseCapture()}else if(window.captureEvents)window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP);_ZDrag.clickObj=null;document.body.removeChild(_ZDrag.oblind);_UTL.blind.hide()}};_WCHAT={myChatID:"",myInfo:{p:"",nick:"",uid:"",istatus:0,sstatus:"",realname:""},hid:"",hasChatWin:false,msgSvr:null,msgBuff:[],msgBuffIdx:{},users:{},recentContacts:{},rooms:{},block:{list:{},been:{}},topicRooms:{},topics:{},currTopics:{},enc:"utf-8",queue:{},reqID:null,currQID:null,Timeout:35e3,lastMsgID:100,pris:{send:10,check:0},offlineNum:0,fallCount:0,firstload:true,paused:false,bReady:false,iTimer:null,getstat:{buff:[],loading:false,iTimer:null},re:{revMessage:null},waits:[1e3,2e3,3e3,4e3,5e3,6e3,7e3,8e3,9e3,1e4,11e3,12e3],waitIndex:0,waitLocSvr:2e3,server:{head:"http://chat.say-on.com/webchat/",start:"start.do",getchatid:"getroomid.do",getstatus:"status.do",joinRoom:"join.do",quitRoom:"quit.do",updatestatus:"stsupdate.do",offlinemsg:"offline.do",add2group:"invite.do",userInfo:"userinfo.do",cfgUpdate:"configupdate.do",preview:"preview.do",buddyHistory:"history.do",roomonline:"roomonline.do",getmsg:""}};_WCHAT.server.sendmsg=_WCHAT.server.head+"chat.do";_WCHAT.server.roominfo=_WCHAT.server.head+"roominfo.do";_WCHAT.start=function(cks){if(!cks||cks==""){cks=document.cookie}if(!cks)cks="";_WCHAT.hid=_COMM.clientID;_WCHAT.firstload=true;_WCHAT.lastMsgID=_WCHAT.isChatWinHid(_WCHAT.hid)?0:100;var ost={cookies:cks};var xmls=_ZXML._obj2xmlstr(ost,"request");var idstr="id";if(!_WCHAT.reqID){_WCHAT.reqID=Math.random();if(_WCHAT.myInfo.uid!="")_WCHAT.reqID=_WCHAT.myInfo.uid;idstr="uid"}_COMM.sendXML(_WCHAT.server.head+_WCHAT.server.start+"?"+idstr+"="+_WCHAT.reqID,xmls,_WCHAT.startCallback)};_WCHAT.startCallback=function(str){var orv=_UTL.getJSONData(str);if(!orv||!orv.myChatID||orv.myChatID==""){if(typeof _WCHAT.onErr=="function")_WCHAT.onErr("cannotStart",10);return}_WCHAT.myChatID=orv.myChatID;_WCHAT.myRoomID=orv.myRoomID;_UTL.setCookie("chatid",_WCHAT.myChatID);if(orv.laststatus&&typeof orv.laststatus.istatus!="undefined"){_WCHAT.myInfo.istatus=Number(orv.laststatus.istatus);_WCHAT.myInfo.sstatus=orv.laststatus.sstatus;_WCHAT.myInfo.nick=orv.laststatus.nick;_WCHAT.myInfo.realname=orv.laststatus.realname;_WCHAT.myInfo.p=orv.laststatus.ptype;_WCHAT.myInfo.uid=orv.laststatus.puid;_WCHAT.myInfo.laststatus=orv.laststatus}if(orv.waits)_WCHAT.waits=orv.waits;if(typeof _WCHAT.onStart=="function")_WCHAT.onStart();_WCHAT.waitIndex=_WCHAT.isChatWinHid(_WCHAT.hid)?1:3;_WCHAT.iTimer=window.setTimeout("_WCHAT.timerEvent()",1e3);if(typeof orv.offline!="undefined"&&orv.offline>0&&typeof _WCHAT.gotOfflineNum=="function"){_WCHAT.offlineNum=orv.offline;_WCHAT.gotOfflineNum(orv.offline)}};_WCHAT.getInfoFromRoomid=function(roomid){if(!roomid)roomid="";var ar=roomid.split("_");var tp=ar[1]?ar[1]:0;var lab=tp==3?ar[3]:ar[2];var rv={provider:ar[0]?ar[0]:"",type:tp,group:tp==3?ar[2]:0,label:lab?lab:"",isMine:(tp==4||tp==3)&&lab==_WCHAT.myChatID,roomid:roomid};return rv};_WCHAT.isRoom=function(roomid){return typeof roomid=="string"&&roomid.indexOf("_")>=0};_WCHAT.isMyRoom=function(roomid){var ori=_WCHAT.getInfoFromRoomid(roomid);return ori.isMine};_WCHAT.updateStatus=function(istatus){if(_WCHAT.myChatID==""||typeof _WCHAT.myInfo.istatus=="undefined"){window.setTimeout("_WCHAT.updateStatus("+istatus+")",1e3);return}if(!istatus)istatus=_WCHAT.myInfo.istatus;var fn=_WCHAT.server.head+_WCHAT.server.updatestatus+"?id="+_WCHAT.myChatID;var ost={realname:_WCHAT.myInfo.realname&&_WCHAT.myInfo.realname!="null"?_WCHAT.myInfo.realname:"",nick:_WCHAT.myInfo.nick?_WCHAT.myInfo.nick:"",sstatus:_WCHAT.myInfo.sstatus?_WCHAT.myInfo.sstatus:"",provider:_WCHAT.myInfo.p&&_WCHAT.myInfo.p!=""?_WCHAT.myInfo.p:"",puid:_WCHAT.myInfo.uid,istatus:String(istatus)};var xmls=_ZXML._obj2xmlstr(ost,"request");_COMM.sendXML(fn,xmls,_WCHAT.updateStatusCallback)};_WCHAT.updateStatusCallback=function(str,surl){return};_WCHAT.getOfflineMessage=function(bclear){var fn=_WCHAT.server.head+_WCHAT.server.offlinemsg+"?id="+_WCHAT.myChatID+(typeof bclear!="undefined"&&bclear==false?"&clear=false":"");_COMM.loadXMLDoc(fn,_WCHAT.getOfflineMessageCallbakc)};_WCHAT.getOfflineMessageCallbakc=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv)return;var msgs=[];var omsg;for(var i=0;i<orv.length;i++){omsg=orv[i];_WCHAT.offlineNum--;if(_WCHAT.msgBuffIdx[omsg.id])continue;omsg.isOffline=true;msgs.push(omsg)}if(_WCHAT.offlineNum<0)_WCHAT.offlineNum=0;if(msgs.length>0){_WCHAT.msgPretreatment(msgs)}};_WCHAT.getOnlineBuddy=function(page,pageSize){var fn=_WCHAT.server.roominfo+"?id="+_WCHAT.myRoomID+"&g=-1&t=2";if(page)fn+="&pg="+page;if(pageSize)fn+="&ps="+pageSize;_COMM.loadXMLDoc(fn,_WCHAT.getOnlineBuddyCallback)};_WCHAT.getOnlineBuddyCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv)return;if(typeof _WCHAT.gotOnlineBuddy=="function"){_WCHAT.gotOnlineBuddy(orv)}};_WCHAT.getOnlineGroup=function(page,pageSize){if(_WCHAT.myInfo.p!="sina")return false;var fn=_WCHAT.server.head+_WCHAT.server.roomonline+"?p="+_WCHAT.myInfo.p+"&uid="+_WCHAT.myInfo.uid+"&gn=true";if(page)fn+="&pg="+page;if(pageSize)fn+="&ps="+pageSize;_COMM.loadXMLDoc(fn,_WCHAT.getOnlineGroupCallback)};_WCHAT.getOnlineGroupCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv)return;if(typeof _WCHAT.gotOnlineGroup=="function"){_WCHAT.gotOnlineGroup(orv)}};_WCHAT.getUserInfo=function(){var fn=_WCHAT.server.head+_WCHAT.server.userInfo+"?id="+_WCHAT.myChatID+"&t=3";_COMM.loadXMLDoc(fn,_WCHAT.getUserInfoCallback)};_WCHAT.getUserInfoCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(orv&&orv.status=="succ"){var ou;if(orv.recentcontacts&&orv.recentcontacts.length>0){for(var i=0;i<orv.recentcontacts.length;i++){ou=orv.recentcontacts[i];_WCHAT.recentContacts[ou.uid]=orv.recentcontacts[i]}}var ts=orv.blocklist;var al;if(ts){_WCHAT.block.list={};al=ts.split(",");for(var i=0;i<al.length;i++){if(al[i]!=_WCHAT.myChatID)_WCHAT.block.list[al[i]]=true}}ts=orv.beenblocklist;if(ts){_WCHAT.block.been={};al=ts.split(",");for(var i=0;i<al.length;i++){if(al[i]!=_WCHAT.myChatID)_WCHAT.block.been[al[i]]=true}}}if(typeof _WCHAT.gotUserInfo=="function"){_WCHAT.gotUserInfo()}};_WCHAT.blockRoom=function(roomid,blk){var ori=_WCHAT.getInfoFromRoomid(roomid);var t=1;var lv=ori.type==0?101:1;if(blk==false)lv=-1;if(ori.type==7)t=2;else if(ori.type!=0)t=3;var fn=_WCHAT.server.head+_WCHAT.server.cfgUpdate+"?id="+_WCHAT.myChatID+"&t="+t+"&level="+lv;fn+="&target="+roomid;_COMM.loadXMLDoc(fn,_WCHAT.blockRoomCallback)};_WCHAT.blockRoomCallback=function(str,surl){var orv=_UTL.getJSONData(str);var succ=orv&&orv.status=="succ";var lv=_UTL.getUrlArg("level",surl);var roomid=_UTL.getUrlArg("target",surl);if(typeof _WCHAT.onBlockRoom=="function"){_WCHAT.onBlockRoom(roomid,lv,succ)}};_WCHAT.decodeSysMessage=function(omsg){switch(Number(omsg.type)){case-2:var m=omsg.text.match(/([^,]+),([^,]+),([^,]+)/);if(m&&m[1]&&m[2]&&typeof m[3]!="undefined"){var lv=Number(m[3]);if(m[1]==_WCHAT.myChatID)_WCHAT.block.list[m[2]]=lv>0;else if(m[2]==_WCHAT.myChatID)_WCHAT.block.been[m[1]]=lv>0;if(typeof _WCHAT.onBlockMessage=="function")_WCHAT.onBlockMessage(m[1],m[2],lv);return true}break;case-3:var am=omsg.text.split(",");var ist=Number(am[0]);if(!isNaN(ist))_WCHAT.myInfo.istatus=ist;if(typeof am[1]=="string")_WCHAT.myInfo.sstatus=am[1];if(typeof _WCHAT.onStatusChange=="function")_WCHAT.onStatusChange();return true;break;default:return false;break}return false};_WCHAT.getRoomUserList=function(roomid,tp){if(!tp)tp=3;var fn=_WCHAT.server.roominfo+"?id="+roomid+"&t="+tp;_COMM.loadXMLDoc(fn,_WCHAT.getRoomUserListCallbakc)};_WCHAT.getRoomUserListCallbakc=function(str,surl){var roomid=_UTL.getUrlArg("id",surl);var orv=_UTL.getJSONData(str);if(!orv)return;if(typeof _WCHAT.gotRoomUserList=="function"){_WCHAT.gotRoomUserList(roomid,orv)}};_WCHAT.getStatusName=function(stat,chatid){if(chatid){if(_WCHAT.block.list[chatid])return(stat<0?"off":"on")+"Block";if(_WCHAT.block.been[chatid])stat=-1}var ols=stat<0?"off":"on";if(stat>=10&&stat<20)ols="away";else if(stat>=20&&stat<30)ols="busy";else if(stat==-10)ols="hidden";return ols};_WCHAT.getStatusID=function(stat){var def={on:0,off:-1,away:10,busy:20,hidden:-10};var istat=def[stat];if(istat=="undefined")istat=0;return istat};_WCHAT.getUserStatus=function(uids,uidType,cbFun){if(uids.length<1)return false;var au=[];var t;for(var i=0;i<uids.length;i++){au.push(uids[i]);if(au.length>=50){_WCHAT.getstat.buff.push({uids:au,p:uidType,cbFun:cbFun});au=[]}}if(au.length>0){_WCHAT.getstat.buff.push({uids:au,p:uidType,cbFun:cbFun})}_WCHAT.execGetUserStatus()};_WCHAT.execGetUserStatus=function(){if(_WCHAT.getstat.loading){_WCHAT.getstat.iTimer=window.setTimeout("_WCHAT.execGetUserStatus()",500);return}if(_WCHAT.getstat.iTimer)window.clearTimeout(_WCHAT.getstat.iTimer);if(_WCHAT.getstat.buff.length==0)return;var curr=_WCHAT.getstat.buff[0];_WCHAT.getstat.loading=true;var fn=_WCHAT.server.head+_WCHAT.server.getstatus;fn+="?p="+(curr.p?curr.p:"");fn+=_WCHAT.myChatID&&_WCHAT.myChatID!=""?"&id="+_WCHAT.myChatID:"";fn+="&uids="+curr.uids.join(",");_COMM.loadXMLDoc(fn,_WCHAT.getUserStatusCallback)};_WCHAT.getUserStatusCallback=function(str,surl){var p=_UTL.getUrlArg("p",surl);var us=_UTL.getUrlArg("uids",surl);var uids=us?us.split(","):null;if(!uids)uids=[];var orv=_UTL.getJSONData(str);var ob=_WCHAT.getstat.buff.shift();if(orv&&ob&&typeof ob.cbFun=="function")ob.cbFun(orv,p,uids);if(orv){var ou,oru;var sts={};var oarg=[];for(var i=0;i<orv.length;i++){oru=orv[i];ou=_WCHAT.users[oru.uid];sts[oru.uid]=ou;if(!ou)continue;ou.istatus=oru.istatus;ou.sstatus=oru.sstatus;ou.lastactive=oru.lastactive;if(oru.nick!="")ou.nick=oru.nick;if(oru.realname!="")ou.realname=oru.realname;oarg.push(ou)}var uid;for(var i=0;i<uids.length;i++){uid=uids[i];if(sts[uid])continue;sts[uid]={istats:-1,sstats:"",uid:uid};if(!_WCHAT.users[uid])continue;_WCHAT.users[uid].istatus=-1;_WCHAT.users[uid].sstatus="";oarg.push(_WCHAT.users[uid])}if(typeof _WCHAT.gotUserStatus=="function"){_WCHAT.gotUserStatus(oarg,p)}}_WCHAT.getstat.loading=false;if(_WCHAT.getstat.buff.length>0){_WCHAT.getstat.iTimer=window.setTimeout("_WCHAT.execGetUserStatus()",100)}};_WCHAT.timerEvent=function(){if(_WCHAT.iTimer)window.clearTimeout(_WCHAT.iTimer);var rv=_WCHAT.checkMsg();if(typeof _WCHAT.onTimer=="function"){_WCHAT.onTimer()}var it=_WCHAT.msgSvr?_WCHAT.waitLocSvr:_WCHAT.waits[_WCHAT.waitIndex]*(_WCHAT.isChatWinHid(_WCHAT.hid)?1:2);_WCHAT.iTimer=window.setTimeout("_WCHAT.timerEvent()",it);if(rv!=null){_WCHAT.waitIndex++;if(_WCHAT.waitIndex>=_WCHAT.waits.length)_WCHAT.waitIndex=Math.floor(_WCHAT.waits.length/2)}var lst=_WCHAT.hasChatWin;_WCHAT.hasChatWin=_WCHAT.msgSvr&&_WCHAT.isChatWinHid(_WCHAT.msgSvr);if(lst&&lst!=_WCHAT.hasChatWin){_WCHAT.msgSvr=null;if(typeof _WCHAT.onLostChatWin=="function")_WCHAT.onLostChatWin()}};_WCHAT.timing=function(idx){if(!idx||idx<0)idx=0;if(idx>=_WCHAT.waits.length)idx=_WCHAT.waits.length-1;_WCHAT.waitIndex=idx;_WCHAT.timerEvent()};_WCHAT.pause=function(bpause){_WCHAT.paused=bpause};_WCHAT.bPaused=function(){return _WCHAT.paused||_WCHAT.myChatID==""};_WCHAT.checkMsg=function(){if(_WCHAT.msgSvr&&_WCHAT.msgSvr!=_WCHAT.hid){_WCHAT.checkLocMsg();return-1}if(_WCHAT.bPaused()||_WCHAT.currQID)return null;var fn=_WCHAT.server.head+_WCHAT.server.getmsg+"?id="+_WCHAT.myChatID+"&a="+_WCHAT.lastMsgID+"&var=__wchatMessages"+"&hid="+_WCHAT.hid;return _WCHAT.callSvr(fn,_WCHAT.gotMessage,_WCHAT.pris.check)};_WCHAT.isChatWinHid=function(hid){if(!hid)hid=_WCHAT.hid;return hid.search(/^commzoomsun/)!=-1};_WCHAT.checkLocMsg=function(){if(_WCHAT.isChatWinHid(_WCHAT.hid)){_WCHAT.backToChatSvr();return}if(!_WCHAT.msgSvr||_WCHAT.msgSvr==_WCHAT.hid){return _WCHAT.checkMsg()}if(_WCHAT.lastMsgID==0)_WCHAT.lastMsgID=100;if(_COMM.msgQueue.length>0)return;_COMM.sendMessage(_WCHAT.msgSvr,{type:"command",key:"exec",message:{funName:"_WCHAT.reqLocMessage",args:{hid:_COMM.clientID,topics:_WCHAT.topics,blocked:_WCHAT.block}}});_WCHAT.reqLocTimer=window.setTimeout("_WCHAT.backToChatSvr()",2e3)};_WCHAT.reqLocMessage=function(oarg){var hid=oarg.hid;if(oarg.topics){for(var dat in oarg.topics){_WCHAT.currTopics[dat]={args:oarg.topics[dat],atv:new Date}}}if(oarg.blocked&&_WCHAT.isChatWinHid(hid)){_WCHAT.block=oarg.blocked}_COMM.sendMessage(hid,{type:"command",key:"exec",message:{funName:"_WCHAT.gotLocMessage",args:{msg:_WCHAT.msgBuff,myInfo:_WCHAT.myInfo,hid:_COMM.clientID}}})};_WCHAT.gotLocMessage=function(oarg){if(_WCHAT.reqLocTimer)window.clearTimeout(_WCHAT.reqLocTimer);try{if(_WCHAT.isChatWinHid(oarg.hid))_WCHAT.myInfo=oarg.myInfo;_WCHAT.msgPretreatment(oarg.msg)}catch(err){}return};_WCHAT.backToChatSvr=function(){_WCHAT.lastMsgID=0;_WCHAT.msgSvr=null;_WCHAT.timing(0)};_WCHAT.getChatID=function(p,uid){var fn=_WCHAT.server.head+_WCHAT.server.getchatid+"?p="+p+"&uid="+uid;_COMM.loadXMLDoc(fn,_WCHAT.getChatIDCallback)};_WCHAT.getChatIDCallback=function(str,surl){var p=_UTL.getUrlArg("p",surl);var uid=_UTL.getUrlArg("uid",surl);var orv=_UTL.getJSONData(str);if(!orv||!orv.roomid)return;var chatid=orv.roomid;_WCHAT.users[chatid]={uid:uid,p:p,nick:"",chatid:chatid};if(typeof _WCHAT.gotChatID=="function"){_WCHAT.gotChatID(p,uid,chatid)}};_WCHAT.createRoom=function(sign,oarg){if(!sign||sign=="")return;if(!oarg)oarg={};if(!oarg.title)oarg.title=sign;if(!_WCHAT.topicRooms[sign]){_WCHAT.topicRooms[sign]={sign:sign,args:oarg};_WCHAT.getRoomID(sign,oarg.title)}};_WCHAT.getRoomID=function(sign,title,users){var t=typeof sign=="string"&&sign!=""?5:6;var fn=_WCHAT.server.head+_WCHAT.server.getchatid+"?p="+_WCHAT.myInfo.p+"&uid="+_WCHAT.myInfo.uid+"&t="+t;var ost={};if(t==6){if(typeof users=="object"&&users.length>0){ost.users={rec:users}}}else{ost.url=sign}if(typeof title=="string"&&title.length>0)ost.title=title;var xmls=_ZXML._obj2xmlstr(ost,"request");_COMM.sendXML(fn,xmls,_WCHAT.getRoomIDCallback)};_WCHAT.getRoomIDCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv||!orv.roomid||orv.roomid=="")return;if(typeof _WCHAT.gotRoomID=="function")_WCHAT.gotRoomID(orv.roomid)};_WCHAT.getBuddyHistory=function(tuid){var fn=_WCHAT.server.head+_WCHAT.server.buddyHistory+"?tuid="+tuid;_COMM.loadXMLDoc(fn,_WCHAT.getBuddyHistoryCallback)};_WCHAT.getBuddyHistoryCallback=function(str,surl){var orv=_UTL.getJSONData(str);var tuid=_UTL.getUrlArg("tuid",surl);if(!orv||!orv.msgs)return;if(typeof _WCHAT.onGotBuddyHistory=="function")_WCHAT.onGotBuddyHistory(tuid,orv.msgs)};_WCHAT.getChatHistory=function(roomid,num){if(!num)num=5;if(num>50)num=50;var fn=_WCHAT.server.head+_WCHAT.server.preview+"?mt=2&c="+num+"&id="+roomid;_COMM.loadXMLDoc(fn,_WCHAT.getChatHistoryCallback)};_WCHAT.getChatHistoryCallback=function(str,surl){var orv=_UTL.getJSONData(str);var roomid=_UTL.getUrlArg("id",surl);if(typeof _WCHAT.onGotChatHistory=="function")_WCHAT.onGotChatHistory(roomid,orv.msgs)};_WCHAT.joinRoom=function(roomid){var ori=_WCHAT.getInfoFromRoomid(roomid);if(ori.type!="5"&&ori.type!="7")return false;var fn=_WCHAT.server.head+_WCHAT.server.joinRoom+"?id="+roomid;_COMM.loadXMLDoc(fn,_WCHAT.joinRoomCallback)};_WCHAT.joinRoomCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv||!orv.roominfo||orv.result!=0)return;var ori=_WCHAT.getInfoFromRoomid(orv.roominfo.roomid);if(ori.type==5){var sign=orv.roominfo.url;if(_WCHAT.topicRooms[sign]){_WCHAT.topicRooms[sign].roominfo=orv.roominfo}}if(typeof _WCHAT.onJoinRoom=="function")_WCHAT.onJoinRoom(orv)};_WCHAT.quitRoom=function(roomid){var ori=_WCHAT.getInfoFromRoomid(roomid);if(ori.type!="5")return false;var fn=_WCHAT.server.head+_WCHAT.server.quitRoom+"?id="+roomid;_COMM.loadXMLDoc(fn)};_WCHAT.joinGroupChat=function(groupid,p){if(!p)p=_WCHAT.myInfo.p;var fn=_WCHAT.server.head+_WCHAT.server.getchatid+"?p="+p+"&gid="+groupid+"&t=7";_COMM.loadXMLDoc(fn,_WCHAT.joinGroupChatCallback)};_WCHAT.joinGroupChatCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv||!orv.roomid||orv.roomid=="")return;if(typeof _WCHAT.gotRoomID=="function")_WCHAT.gotRoomID(orv.roomid,orv.authorized)};_WCHAT.addGroupChat=function(roomid,users){if(_WCHAT.getInfoFromRoomid(roomid).type!="6"){_WCHAT.getRoomID(null,null,users);return}var ost={};ost.users={rec:users};var fn=_WCHAT.server.head+_WCHAT.server.add2group+"?id="+roomid;var xmls=_ZXML._obj2xmlstr(ost,"request");_COMM.sendXML(fn,xmls,_WCHAT.addGroupChatCallback)};_WCHAT.addGroupChatCallback=function(str,surl){var orv=_UTL.getJSONData(str);if(!orv||!orv.roomid||orv.roomid=="")return;if(typeof _WCHAT.gotRoomID=="function")_WCHAT.gotRoomID(orv.roomid);if(orv.members&&typeof _WCHAT.gotMembers=="function")_WCHAT.gotMembers(orv.roomid,orv.members)};_WCHAT.callSvr=function(jssrc,cbfun,pri){if(!document.body)return null;var jsid=jssrc.replace(/.*\/\/(.*)\?.*/,"$1");var ojs=document.getElementById(jsid);if(ojs){var rqid=ojs.getAttribute("qid");if(rqid)_WCHAT.cleanUPQID(rqid,false);else document.body.removeChild(ojs)}if(_WCHAT.currQID)_WCHAT.cleanUPQID(rqid,false);var d=new Date;var qid=(d.valueOf()%1e8).toString(16);var ocall=new Object;ocall.time=d;ocall.bCalling=true;ocall.fun=cbfun;ocall.pri=pri;ocall.iTimer=window.setTimeout("_WCHAT.cleanUPQID('"+qid+"',true)",_WCHAT.Timeout);ojs=document.createElement("SCRIPT");ojs.language="javascript";ojs.type="text/javascript";ojs.charset="utf-8";ojs.id=jsid;ojs.setAttribute("qid",qid);ojs.src=jssrc+"&qid="+qid;var cbfun=function(){};if(typeof ojs.onreadystatechange=="undefined")ojs.onload=function(){_WCHAT.onSvrBack(qid)};else ojs.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="interactive"||this.readyState=="complete"){_WCHAT.onSvrBack(qid)}};ojs=document.body.appendChild(ojs);ocall.ojs=ojs;_WCHAT.queue[qid]=ocall;_WCHAT.currQID=qid;return qid};_WCHAT.onSvrBack=function(qid){if(!qid||qid=="")return;var ocall=_WCHAT.queue[qid];if(ocall&&typeof ocall.fun=="function"){ocall.fun(qid)}_WCHAT.cleanUPQID(qid,false);return};_WCHAT.cleanUPQID=function(qid,bfall){if(!qid||qid==""||!_WCHAT.queue[qid])return;var ocall=_WCHAT.queue[qid];if(ocall.iTimer)window.clearTimeout(ocall.iTimer);if(_WCHAT.currQID==qid)_WCHAT.currQID=null;document.body.removeChild(ocall.ojs);delete _WCHAT.queue[qid];if(bfall){_WCHAT.fallCount++}else{_WCHAT.lastGotTime=(new Date).valueOf();_WCHAT.fallCount=0}};_WCHAT.gotMessage=function(qid){var orv=null;try{orv=__wchatMessages}catch(err){}if(!orv||!orv.hid){_WCHAT.fallCount++;return}_WCHAT.fallCount=0;if(orv.hid!=_WCHAT.hid){_WCHAT.msgSvr=orv.hid;if(_WCHAT.isChatWinHid(_WCHAT.msgSvr)&&typeof _WCHAT.onGotChatWin=="function")_WCHAT.onGotChatWin()}else{_WCHAT.msgSvr=null}_WCHAT.lastMsgID=_WCHAT.isChatWinHid(_WCHAT.hid)?0:100;_WCHAT.bReady=true;if(orv.msg.length>0){_WCHAT.msgPretreatment(orv.msg);_WCHAT.timing(2)}};_WCHAT.isBuddyMsg=function(msgType){return msgType>=1e3};_WCHAT.isChatMsg=function(msgType){return msgType>=0};_WCHAT.pushMsgBuff=function(omsg){_WCHAT.msgBuff.push(omsg);_WCHAT.msgBuffIdx[omsg.id]=true};_WCHAT.msgPretreatment=function(ms,noUpdate){var omsg,ou;var buffLen=50;if(_WCHAT.msgBuff.length>buffLen){_WCHAT.msgBuff=_WCHAT.msgBuff.slice(_WCHAT.msgBuff.length-buffLen);for(var i=0;i<_WCHAT.msgBuff.length;i++){_WCHAT.msgBuffIdx[_WCHAT.msgBuff[i].id]=true}}for(var i=0;i<ms.length;i++){omsg=ms[i];if(!omsg)continue;var needPush=true;if(omsg.type>=0){omsg.text=_WCHAT.siftMessage(omsg.text)}else{needPush=_WCHAT.decodeSysMessage(omsg)}if(needPush&&!noUpdate&&!_WCHAT.msgBuffIdx[omsg.id]){_WCHAT.pushMsgBuff(omsg)}if(_WCHAT.lastMsgID<omsg.id)_WCHAT.lastMsgID=omsg.id;if(_WCHAT.isRoom(omsg.roomid)){continue}else if(omsg.type>=0){ou=_WCHAT.users[omsg.from];if(!ou){_WCHAT.users[omsg.from]={uid:omsg.uid,p:omsg.ut,nick:omsg.nk,chatid:omsg.from};if(omsg.from!=_WCHAT.myChatID&&typeof _WCHAT.gotNewUser=="function")_WCHAT.gotNewUser(_WCHAT.users[omsg.from])}ou=_WCHAT.users[omsg.from];if(!ou.nick||ou.nick=="")ou.nick=omsg.nk}}if(_WCHAT.firstload&&ms.length>0)_WCHAT.firstload=false;if(typeof _WCHAT.onMessage=="function"){_WCHAT.onMessage(ms)}};_WCHAT.sortMsg=function(a,b){return a.id<b.id?-1:1};_WCHAT.getKeywordRegExp=function(kw){if(!kw||kw=="")return null;kw=escape(kw);return new RegExp("("+kw.replace(/%20/g,"|").replace(/%/g,"\\")+")","igm")};_WCHAT.siftMessage=function(msg){if(_WCHAT.re.revMessage)return msg.replace(_WCHAT.re.revMessage,"(feid)");else return msg};_WCHAT.updateKeyWord=function(kw){_WCHAT.re.revMessage=_WCHAT.getKeywordRegExp(kw)};_WCHAT.getCmsgid=function(){return((new Date).valueOf()%1e8).toString(16)};_WCHAT.sendMessage=function(to,msgStr,cmsgID,type){if(typeof to!="string"||to==""||typeof msgStr!="string"||msgStr=="")return false;msgStr=msgStr.replace(/\\+$/,"");msgStr=_WCHAT.siftMessage(msgStr);var ost={nick:_WCHAT.myInfo.nick,msg:msgStr};var xmls=_ZXML._obj2xmlstr(ost,"request");_COMM.sendXML(_WCHAT.server.sendmsg+"?id="+to+"&c="+cmsgID+(type?"&t="+type:"")+"&uid="+_WCHAT.myInfo.uid+"&ut="+_WCHAT.myInfo.p,xmls,_WCHAT.sendMessageCallback)};_WCHAT.sendMessageCallback=function(str){_WCHAT.timing(2);var orv=_UTL.getJSONData(str);if(!orv||!orv.msg)return;if(orv.msg.type>=0&&!_WCHAT.isRoom(orv.msg.roomid))_WCHAT.msgBuff.push(orv.msg);if(orv.msg.type<0&&orv.msg.from!=_WCHAT.myChatID&&typeof _WCHAT.onMessage=="function"){_WCHAT.onMessage([orv.msg])}if(orv.offlinewarn&&orv.offlinewarn!="false"&&orv.msg.to&&typeof _WCHAT.onOfflineOverflow=="function")_WCHAT.onOfflineOverflow(orv.msg.to)};function __dosZWFCall(){return true}function __ZWFloadJS(){return true}if(typeof _ZWF=="undefined")var _ZWF={};_ZWF.pubDate="2008-4-10";_ZWF.$=function(id){return document.getElementById(id)};_ZWF.scriptID="zoomsun_widget_frame";_ZWF.staticServer="";_ZWF.mainServer="http://widget.say-on.com/go/";_ZWF.hubServer="http://widget.say-on.com/go/";_ZWF.SvrAddress={rssProxy:_ZWF.mainServer+"getrss.do",iask:_ZWF.mainServer+"iask.do",update:_ZWF.mainServer+"update.do",note:_ZWF.mainServer+"note.do",reg:_ZWF.mainServer+"reg.do",giftStoreInfo:_ZWF.mainServer+"gsl.do",gifthot:_ZWF.mainServer+"gethot.do",giftMyInfo:_ZWF.mainServer+"gl.do",giftUpdate:_ZWF.mainServer+"gupdate.do",authUpdate:_ZWF.mainServer+"authupdate.do",auth:_ZWF.mainServer+"auth.do"};_ZWF.hostPage=document.URL;_ZWF.embs={typelen:{},item:{},pNodes:{},wtmp:{}};_ZWF.widgets={};_ZWF.childWins={};_ZWF.skinCfgs={};_ZWF.skins={};_ZWF.skinCfgWaits={};_ZWF.fwin={};_ZWF.desk={};_ZWF.achs={};_ZWF.readyState="uninitialized";_ZWF.bShowStatus=true;_ZWF.inSlowNet=false;_ZWF.sinaUsers={};_ZWF.blindIEHTML='<iframe border="0" frameborder="0" style="position:relative;width:100%;height:100%;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=0);"></iframe>';function __dosZWFReady(){return _ZWF&&_ZWF.readyState=="Ready"}_ZWF.showStatus=function(s){if(_ZWF.bShowStatus)window.status=s};_ZWF.importJS=function(jssrc,jsid,loadFun){if(!jsid)jsid=escape(jssrc);var ojs=_ZWF.$(jsid);if(ojs)return true;if(!document.body){document.write('<script type="text/javascript" id="'+jsid+'" src="'+jssrc+'"></scr'+"ipt>")}else{ojs=document.createElement("SCRIPT");ojs.charset="utf-8";ojs.language="javascript";ojs.type="text/javascript";ojs.id=jsid;ojs.src=jssrc;if(typeof loadFun=="function"){if(typeof ojs.onreadystatechange=="undefined")ojs.onload=loadFun;else ojs.onreadystatechange=function(){if(this.readyState=="loaded"||this.readyState=="interactive"||this.readyState=="complete"){loadFun()}}}ojs=document.body.appendChild(ojs)}return false};_ZWF.init=function(){_ZWF.commLoaded();_ZWF.commLoadBegin=(new Date).valueOf();_ZWF.readyState="Loading COMM";_ZWF.showStatus(_ZWF.readyState)};_ZWF.commLoaded=function(){_ZWF.readyState="Initialize COMM";_ZWF.showStatus(_ZWF.readyState);_COMM.onMessage=_ZWF.gotMessage;_COMM.onComLoad=_ZWF.commInited;if(!_COMM.clientID)_COMM.init();else _ZWF.commInited()};_ZWF.commInited=function(){_ZWF.readyState="Ready";_ZWF.showStatus("");var d=new Date;var m=navigator.appVersion.match(/MSIE (\d\.\d);/);var fixIE=m&&m[1]&&Number(m[1])<=6;var fixLinux=navigator.platform.toLowerCase().search("linux")!=-1;if(d.valueOf()-_ZWF.commLoadBegin>1e3||fixIE||fixLinux)_ZWF.inSlowNet=true;_ZWF.findEmbeds();_ZWF.desk.tb=_UTL.truebody();window.setTimeout("_ZWF.startChat()",200)};_ZWF.initWgtQueue=[];_ZWF.findEmbeds=function(){var embs=document.embeds;var m,ms;var re=new RegExp("\\/wgt_static\\/loader\\.swf\\?(.*)","i");var needRun=false;if(embs.length!=_ZWF.embs.typelen["embed"]){for(var i=0;i<embs.length;i++){if(embs[i].style.display=="none")continue;m=embs[i].src.match(re);if(m&&m[1]){if(_COMM.chkInitFailed){embs[i].style.display="none";_ZWF.showStatus("Initialize Failed :( ")}else{ms=m[1];if(!_ZWF.embs.item[ms])_ZWF.embs.item[ms]=[];if(!_ZWF.embs.pNodes[ms])_ZWF.embs.pNodes[ms]=[];_ZWF.embs.pNodes[ms].push(embs[i].parentNode);_ZWF.embs.item[ms].push(embs[i]);if(_ZWF.embs.item[ms].length==1)_ZWF.initWgtQueue.push(ms)}}}_ZWF.embs.typelen["embed"]=embs.length;needRun=true}if(needRun&&_ZWF.initWgtQueue.length>0)_ZWF.execInitWgtQueue();window.setTimeout("_ZWF.findEmbeds()",1e3)};_ZWF.execInitWgtQueue=function(){if(_ZWF.initWgtQueue.length==0)return;var embarg=_ZWF.initWgtQueue.shift();_ZWF.initWidget(embarg);if(!_ZWF.inSlowNet)window.setTimeout("_ZWF.execInitWgtQueue()",100)};_ZWF.initWidget=function(embarg,exe){if(!embarg||embarg=="")return false;if(_ZWF.embs.wtmp[embarg]){_ZWF.execInitWgtQueue();return}_ZWF.embs.wtmp[embarg]={embarg:embarg,exe:exe,cfg:null,childWin:{},embs:null};var m=embarg.match(/^static=(.*)/);if(m&&m[1]){_ZWF.loadStaticWidget(_ZWF.embs.wtmp[embarg],_ZWF.staticServer+m[1]);_ZWF.execInitWgtQueue()}else{_ZWF.showStatus("Loading Settings ...");var blog=_COMM.auth&&_COMM.auth.bLogin>0;if(blog)_COMM.loadXMLDoc(_ZWF.hubServer+"?"+embarg+"&l="+_COMM.auth.bLogin,_ZWF.gotWidgetInfo);else _COMM.loadXMLDoc(_ZWF.mainServer+"?"+embarg,_ZWF.gotWidgetInfo)}return true};_ZWF.loadStaticWidget=function(otmp,surl){var embarg=otmp.embarg;var embs=_ZWF.embs.item[embarg];if(!embs)return;var oemb,did;for(var i=0;i<embs.length;i++){oemb=embs[i];if(!oemb)continue;did="_Widget_"+otmp.embarg+"_"+i;var el=_ZWF.$(did);if(!el){el=document.createElement("DIV");el.id=did;el.style.position="absolute"}var opn=oemb.parentNode;if(!opn){var pns=_ZWF.embs.pNodes[embarg];opn=pns[i]}oemb.style.width="0px";oemb.style.height="0px";oemb.style.visibility="hidden";oemb.style.display="none";el=opn.appendChild(el);var wgtid="_static_"+Math.floor(Math.random()*1e10);var w=opn.clenthWidth;var h=opn.clientHeight;var ts="";var mn=embarg.replace(/.*(\/|^)([^\/|\?]*).*/,"$2");var fid="_Widget_Frame_"+wgtid+"_"+i+"_"+mn;var fs=surl+"?hid="+_COMM.clientID+"&wgtid="+wgtid;ts+='<iframe  id="'+fid+'" name="'+fid+'" ';ts+=" onload=\"if(this.src.search('empty.html')!=-1){this.src=unescape('"+escape(fs)+'\')}" src="'+_ZWF.staticServer+'empty.html" style="position:relative;cursor:default;"  scrolling="no" allowTransparency="true"  width="'+w+'px" height="'+h+'px"  border="0" frameborder="0" ></iframe>';el.innerHTML=ts;var oif=_ZWF.$(fid);if(!otmp.embs)otmp.embs=[];otmp.embs.push({oimp:oemb,odiv:el,owin:oif,w:w,h:h});_ZWF.widgets[wgtid]=otmp}};_ZWF.gotWidgetInfo=function(xmls,surl){
var oxml=_ZXML.loadXMLStr(xmls);_ZWF.showStatus("Settings loaded");var ocfg=_ZXML.XML2Obj(oxml);if(!ocfg||!ocfg.widget||!ocfg.widget.attributes||!ocfg.widget.attributes.wid){if(_ZWF.inSlowNet)_ZWF.execInitWgtQueue();return}var ouh=ocfg.widget.application.updatehost;if(ouh){for(var dat in ouh){_ZWF.SvrAddress[dat]=ouh[dat]}delete ocfg.widget.application.updatehost}var wat=ocfg.widget.attributes;var wgtid=ocfg.widget.attributes.wid;if(!ocfg.widget.application.owner){ocfg.widget.application.owner={}}if(!ocfg.widget.application.settings){var mn=wat.wtype.substr(0,wat.wtype.indexOf("@"));mn=mn.toLowerCase();ocfg.widget.application.settings={embComm:{},skin:{pubPath:mn+"/",subPath:"skins/default/"}};ocfg.widget.application.settings.embComm[mn]={}}if(!ocfg.widget.application.owner.sina||typeof ocfg.widget.application.owner.sina.nick!="string"){var osina={uid:"",nick:""};var opv=ocfg.widget.application.provider;if(!opv)opv={uid:_UTL.getUrlArg("uid",surl),nick:null};if(opv.uid){osina.uid=opv.uid;if(typeof opv.nick!="string"||opv.nick==""||opv.nick=="null"){var udat=null;var tp="undefined";eval("tp= typeof(_tempSianUidDate_"+osina.uid+");");if(tp!="undefined")eval("udat=_tempSianUidDate_"+osina.uid);if(udat&&udat[osina.uid])osina.nick=udat[osina.uid];else if(_ZWF.sinaUsers[osina.uid]&&typeof _ZWF.sinaUsers[osina.uid]=="string")osina.nick=udat[osina.uid];else _ZWF.importJS("http://uic.sinajs.cn/uic?type=nick&uids="+osina.uid+"&varname=_tempSianUidDate_"+osina.uid,"reqSinaUidData"+osina.uid,function(){eval("_ZWF.gotSinaUidData('"+wgtid+"','"+osina.uid+"')")})}}ocfg.widget.application.owner.sina=osina}ocfg.widget.application.owner.uid=wat.ownerid;if(!ocfg.widget.data){ocfg.widget.data={}}var embarg=surl.substr(surl.indexOf("?")+1);embarg=embarg.replace(/&l=\d$/,"");var owtmp=_ZWF.embs.wtmp[embarg];if(!owtmp)return;_ZWF.widgets[wgtid]=_ZWF.embs.wtmp[embarg];var oarg=null;var aa=embarg.split("&");var itm;for(var i=0;i<aa.length;i++){itm=aa[i].split("=");if(!itm||itm.length!=2)continue;if(!oarg)oarg={};oarg[itm[0]]=itm[1]}_ZWF.widgets[wgtid].args=oarg;if(!ocfg.widget.application.settings.skin.pubPath.match(/^http/i))ocfg.widget.application.settings.skin.pubPath=_ZWF.staticServer+ocfg.widget.application.settings.skin.pubPath;_ZWF.widgets[wgtid].cfg=ocfg;var oset=ocfg.widget.application.settings;var skid=oset.skin.pubPath;if(!_ZWF.skinCfgs[skid]){_ZWF.showStatus("Loading Skin Settings...");if(!_ZWF.skinCfgWaits[skid])_ZWF.skinCfgWaits[skid]=[];_ZWF.skinCfgWaits[skid].push(wgtid);_COMM.loadXMLDoc(skid+"config.xml",_ZWF.gotSkinSettings)}else{_ZWF.applySkinSettings(skid,wgtid)}};_ZWF.gotSinaUidData=function(wgtid,sinaid){var udat=null;try{eval("udat=_tempSianUidDate_"+sinaid)}catch(err){}if(!udat)return;var nick=udat[sinaid];if(!nick)return;_ZWF.sinaUsers[sinaid]={nick:nick};_ZWF.widgets[wgtid].cfg.widget.application.owner.sina.nick=nick;var snk=_ZWF.widgets[wgtid].cfg.widget.application.owner.nick;if(typeof snk!="string"||snk==""||snk=="null")_ZWF.widgets[wgtid].cfg.widget.application.owner.nick=nick};_ZWF.gotSkinSettings=function(xmls,surl){var oxml=_ZXML.loadXMLStr(xmls);_ZWF.showStatus("Skin Settings Loaded.");var ocfg=_ZXML.XML2Obj(oxml);if(!ocfg){_ZWF.showStatus("");if(_ZWF.inSlowNet)_ZWF.execInitWgtQueue();return}if(!ocfg.widgetApplication.pubPath.match(/^http/i))ocfg.widgetApplication.pubPath=_ZWF.staticServer+ocfg.widgetApplication.pubPath;var skid=ocfg.widgetApplication.pubPath;_ZWF.skinCfgs[skid]={ocfg:ocfg,waits:{}};var wts=_ZWF.skinCfgWaits[skid];if(!wts)return;for(var i=0;i<wts.length;i++){_ZWF.applySkinSettings(skid,wts[i])}_ZWF.skinCfgWaits[skid].length=0};_ZWF.applySkinSettings=function(skid,wgtid){_ZWF.showStatus("");if(_ZWF.inSlowNet)window.setTimeout("_ZWF.execInitWgtQueue()",100);if(!_ZWF.skinCfgs[skid]||!_ZWF.widgets[wgtid]){return false}var owgt=_ZWF.widgets[wgtid];var oset=owgt.cfg.widget.application.settings;var oskdef=_ZWF.skinCfgs[skid].ocfg.widgetApplication;_ZWF.widgets[wgtid].skin={pubPath:skid,subPath:oset.skin.subPath,cfg:oskdef};_ZWF.initEmb(wgtid);return true};_ZWF.initEmb=function(wgtid){var owgt=_ZWF.widgets[wgtid];var embarg=owgt.embarg;var oset=owgt.cfg.widget.application.settings;var oskdef=owgt.skin.cfg;var embs=[];var oemb;var itms=_ZWF.embs.item[embarg];if(!itms){if(owgt.exe&&owgt.exe.funName){var fun=owgt.exe.funName;if(!_ZWF.achs[fun])_ZWF.achs[fun]=[];if(!owgt.exe.argStr)owgt.exe.argStr="";if(typeof owgt.exe.argStr!="string")owgt.exe.argStr=String(owgt.exe.argStr);_ZWF.achs[fun].push({wid:"widget_hostPage",URL:oset.skin.pubPath+oset.skin.subPath,hid:_COMM.clientID,cid:_COMM.clientID,wgtid:wgtid,argStr:owgt.exe.argStr,srcElement:owgt.exe.srcElement});var fn=owgt.skin.pubPath+"js/zwfapp.js";_ZWF.importJS(fn,null,function(){eval("_ZWA."+owgt.exe.funName+'("'+owgt.exe.argStr.replace(/\"/g,'\\"')+'")')});return true}else{return null}}for(var i=0;i<itms.length;i++){oemb=itms[i];if(!oemb)continue;if(oemb.tagName.toUpperCase()=="A"){if(!oemb.name||oemb.name!="_widgetAnchor")continue;var fun=oemb.getAttribute("fun");if(fun){if(!_ZWF.achs[fun])_ZWF.achs[fun]=[];_ZWF.achs[fun].push({wid:"widget_hostPage",URL:oset.skin.pubPath+oset.skin.subPath,hid:_COMM.clientID,cid:_COMM.clientID,wgtid:wgtid,argStr:oemb.getAttribute("args"),srcElement:oemb});oemb.href="javascript:void(_ZWA.exec('"+fun+"','"+oemb.getAttribute("args")+"',"+(_ZWF.achs[fun].length-1)+"))";var fn=owgt.skin.pubPath+"js/zwfapp.js";_ZWF.importJS(fn)}continue}if(oemb.style.display=="none")continue;var h=oemb.style.height==""?oemb.height==""?oemb.clientHeight:oemb.height:oemb.style.height;var w=oemb.style.width==""?oemb.width==""?oemb.clientWidth:oemb.width:oemb.style.width;var el=document.createElement("DIV");el.id="_Widget_"+embarg+"_"+i;el.style.position="relative";var opn=oemb.parentNode;if(!opn){var pns=_ZWF.embs.pNodes[embarg];opn=pns[i]}oemb.style.width="0px";oemb.style.height="0px";oemb.style.visibility="hidden";oemb.style.display="none";el=opn.appendChild(el);var ts="";var fid="_Widget_Frame_"+wgtid+"_"+i+"_";var embComm=oemb.getAttribute("wgtModule");if(!embComm){for(var dat in oset.embComm){embComm=dat;break}}oset.skin.subPath="skins/default/";var sfile=_ZWF.getSkinFilename(oskdef.components,embComm);var satt=oemb.getAttribute("skin");var odef=oskdef.skinDefine;if(odef){for(var dat in odef){if(!satt||dat==satt){oset.skin.subPath="skins/"+odef[dat].attributes.path+"/";sfile=_ZWF.getSkinFilename(odef[dat],embComm);break}}}owgt.skin.subPath=oset.skin.subPath;var fn=fid+embComm;var oif=_ZWF.$(fn);if(oif||!sfile||sfile=="")continue;var fs="";fs=_UTL.getAbsPath(oset.skin.pubPath+oset.skin.subPath,sfile)+"?hid="+_COMM.clientID+"&wgtid="+wgtid+"&modid="+i;ts+='<iframe  id="'+fn+'" name="'+fn+"\" onload=\"if(this.src.search('empty.html')!=-1){this.src=unescape('"+escape(fs)+'\')}" src="'+_ZWF.staticServer+'empty.html" style="position:relative;cursor:default;"  scrolling="no" allowTransparency="true"  width="'+w+'px" height="'+h+'px"  border="0" frameborder="0" ></iframe>';el.innerHTML=ts;embs.push({oimp:oemb,odiv:el,owin:oif,w:w,h:h})}_ZWF.widgets[wgtid].embs=embs;return embs};_ZWF.getSkinFilename=function(ocom,emb){if(ocom&&ocom[emb]){var hms=_ZXML.getArray(ocom[emb].html);if(typeof hms=="string")return hms;var ohm,hst;for(var i=0;i<hms.length;i++){ohm=hms[i];if(ohm.attributes&&ohm.attributes.host){hst=ohm.attributes.host;if(hst.search(/\./)!=-1&&location.host.search(hst)!=-1){return ohm.attributes.file}}}ohm=hms[0];if(ohm.attributes&&ohm.attributes.file)return ohm.attributes.file;else return ohm}return""};_ZWF.gotMessage=function(sender,omsg){switch(omsg.type){case"registration":var wgtid=omsg.message.wgtid;var modid=omsg.message.modid;_ZWF.childWins[omsg.key]=omsg.message;var owgt=_ZWF.widgets[wgtid];var oset=owgt.cfg?owgt.cfg.widget.application:null;var wid=omsg.message.wid;var args=null;var odiv,divID;if(wid){if(_ZWF.fwin.args[wid])args=_ZWF.fwin.args[wid];odiv=_ZWF.fwin.wins[wid].odiv;divID=odiv.id;_ZWF.fwin.wins[wid].childWinKey=omsg.key;_ZWF.fwin.wins[wid].childWinCid=sender}else{odiv=owgt.embs[modid].odiv;divID=odiv.id;_ZWF.widgets[wgtid].childWinKey=omsg.key;_ZWF.widgets[wgtid].main={mname:omsg.message.mname,cid:omsg.message.cid}}var cst=typeof odiv.currentStyle!="undefined"?odiv.currentStyle:document.defaultView.getComputedStyle(odiv,null);if(!cst)cst={backgroundColor:"transparent",color:"#808080"};var ost={};var f8="";if(owgt.embs&&owgt.embs[modid]&&owgt.embs[modid].oimp){var atts=owgt.embs[modid].oimp.attributes;var at,m;for(var i=0;i<atts.length;i++){at=atts[i];m=at.nodeName.match(/^wgtColor_(.*)/i);if(m&&m[1])ost[m[1].toLowerCase()]=at.nodeValue}f8=owgt.embs[modid].oimp.getAttribute("f8")}var css={backgroundColor:cst.backgroundColor,color:cst.color,style:ost};var winInfo={divID:divID,skin:owgt.skin,css:css,f8:f8,wgtInfo:_ZWF.widgets[wgtid].cfg?_ZWF.widgets[wgtid].cfg.widget.attributes:null,staticServer:_ZWF.staticServer,mainServer:_ZWF.mainServer,SvrAddress:_ZWF.SvrAddress,hostPage:document.URL};_ZWF.childWins[omsg.key].winInfo=winInfo;var oau=_COMM.auth;if(_COMM.auth.cookies){if(oau.cookies.search("=")!=-1)oau.cookies=escape(_COMM.auth.cookies);oau.loginAccList={}}if(oset){try{oset.owner.sina.nick=_ZWF.sinaUsers[oset.owner.sina.uid].nick}catch(err){}}_COMM.sendMessage(sender,{type:"regSuccess",key:"settings",message:{args:args,winInfo:winInfo,oset:oset,auth:oau}});_STATS.add(omsg.message.mname+"_loaded",oset?oset.owner.sina&&oset.owner.sina.uid?oset.owner.sina.uid:oset.owner.uid:"static");break;case"reqWidgetData":var wgtid=omsg.message.wgtid;var owgt=_ZWF.widgets[wgtid];var odat=owgt.cfg.widget.data;_COMM.sendMessage(sender,{type:"gotWidgetData",key:omsg.key,message:odat});break;case"reqLanRes":_COMM.sendMessage(sender,{type:"gotLanRes",key:omsg.key,message:_ZWF.skinCfgs[omsg.key].ocfg.widgetApplication.lanRes});break;case"reqAppData":_COMM.sendMessage(sender,{type:"gotAppData",key:omsg.key,message:_ZWF.skinCfgs[omsg.key].ocfg.widgetApplication.appData});break;case"updateConfig":var ocaller=_ZWF.childWins[omsg.key];if(!ocaller)break;var wgtid=ocaller.wgtid;var objs=omsg.message.node.split(".");var ndstr="_ZWF.widgets[wgtid].cfg.widget.";var nd=null;for(var i=0;i<objs.length;i++){eval("nd ="+ndstr+objs[i]);if(!nd)eval(ndstr+objs[i]+"={}");ndstr+=objs[i]+".";nd=null}eval("_ZWF.widgets[wgtid].cfg.widget."+omsg.message.node+"=omsg.message.nodeObj");break;case"reqObject":var rl=omsg.message;for(var dat in rl){var obj;eval("obj="+rl[dat]);_COMM.sendMessage(sender,{type:"gotObject",key:dat,message:obj})}break;case"fwinCommand":var ocaller=_ZWF.childWins[omsg.key];if(!ocaller)break;var oarg=omsg.message;var afun;if(oarg.fun=="openHtml"){var wid=oarg.wid;if(_ZWF.fwin.wins[wid]){_ZWF.fwin.openHtml(ocaller,oarg)}else{_ZWF.createFwinQueue.push({ocaller:ocaller,oarg:oarg});window.setTimeout("_ZWF.execCreateFwin()",200)}}else{try{eval("afun=_ZWF.fwin."+oarg.fun)}catch(err){}if(typeof afun=="function")afun(ocaller,oarg)}break;case"command":switch(omsg.key){case"exec":var afun;try{eval("afun = "+omsg.message.funName)}catch(err){}if(typeof afun=="function")afun(omsg.message.args);break;case"utility":var afun;try{eval("afun = _ZWF.utl."+omsg.message.funName)}catch(err){}if(typeof afun=="function")afun(omsg.message.args);break;case"setHTML":var odiv=$(omsg.message.divID);if(odiv){odiv.innerHTML=omsg.message.html}break;case"testSpeed":var afun;try{eval("afun = _ZWF."+omsg.message.funName)}catch(err){}if(typeof afun=="function")afun(omsg.message.args);break}break;case"reqManagerData":_COMM.sendMessage(sender,{type:"gotManagerData",key:omsg.key,message:_ZWF.skinCfgs[omsg.key].ocfg.widgetApplication.managerData});break;case"sinaCookie":if(omsg.key=="save")_COMM.saveSinaCookie(omsg.message);break;case"onWinkEnd":_ZWF.wink.hide(omsg.key);break;case"reqChatData":window.setTimeout("_ZWF.chat.reqChatData('"+sender+"','"+omsg.key+"')",500);break;default:break}};_ZWF.doTestSpeedDiv=function(mes){if(!mes.testDiv)return;if(!mes.testHtml)mes.testHtml="";var el=_ZWF.$(mes.testDiv);if(!el){el=document.createElement("DIV");el.id=mes.testDiv;el.style.display="none";document.body.appendChild(el)}el.innerHTML=mes.testHtml};_ZWF.createFwinQueue=[];_ZWF.execCreateFwin=function(){if(_ZWF.createFwinQueue.length>0){_ZWF.fwin.openHtml(_ZWF.createFwinQueue[0].ocaller,_ZWF.createFwinQueue[0].oarg);_ZWF.createFwinQueue.shift()}if(_ZWF.createFwinQueue.length>0){window.setTimeout("_ZWF.execCreateFwin()",200)}};_ZWF.fwin={};_ZWF.fwin.wins={};_ZWF.fwin.args={};_ZWF.fwin.evs={};_ZWF.fwin.baseZ=1e3;_ZWF.fwin.maxZ=0;_ZWF.fwin.openHtml=function(ocaller,oarg){var wid=oarg.wid;var ofw=_ZWF.fwin.wins[wid];var winType=typeof oarg.winType=="string"?oarg.winType:"";if(ofw&&!oarg.epos){_ZWF.fwin.show(wid);if(oarg.align){_ZWF.fwin.align(ocaller.wid,wid)}else{_ZWF.fwin.autoPos(wid)}_ZWF.fwin.bringToTop(wid,winType,oarg.bHideOther);return}if(ofw&&ofw.bhidden){_ZWF.fwin.show(wid);_ZWF.fwin.bringToTop(wid,winType,oarg.bHideOther);return}if(!oarg.src)return;var w=h=50;if(!ofw){w=Number(oarg.width);h=Number(oarg.height)}else{w=ofw.width;h=ofw.height}var x=y=0;var ocdiv=ocaller.srcElement?ocaller.srcElement:_ZWF.$(ocaller.winInfo.divID);if(ocdiv&&ocdiv.tagName.toLowerCase()!="body"){var pos=_UTL.getAbsPosition(ocdiv);if(oarg.followEvent){if(oarg.epos){x=pos.x+oarg.epos.x;y=pos.y+oarg.epos.y}else{x=pos.x+w+pos.w>_ZWF.desk.tb.clientWidth?pos.x-w:pos.x+w;y=pos.y}if(pos.spos&&(pos.spos.h!=pos.h||pos.spos.w!=pos.w)){if(x>pos.spos.w-oarg.width)x=pos.spos.w-oarg.width;if(y>pos.spos.h-oarg.height)y=pos.spos.h-oarg.height}}else{x=oarg.left?oarg.left:Math.round((pos.w-w)/2)+pos.x;y=oarg.top?oarg.top:Math.round((pos.h-h)/2)+pos.h}}else{x=Math.floor((_ZWF.desk.tb.clientWidth-w)/2);y=Math.floor((_ZWF.desk.tb.clientHeight-h)/2)}if(x<0)x=0;if(y<0)y=0;var z=_ZWF.fwin.baseZ;if(oarg.zIndex)z+=Number(oarg.zIndex);if(z>_ZWF.fwin.maxZ)_ZWF.fwin.maxZ=z;_ZWF.fwin.args[wid]=oarg.fwinArgs;var spath=ocaller.URL;spath=spath.substr(0,spath.lastIndexOf("/"));var surl=_UTL.getAbsPath(spath,oarg.src)+"?hid="+ocaller.hid+"&pid="+ocaller.cid+"&wgtid="+ocaller.wgtid+"&wid="+wid;var el=_ZWF.$(wid);var fid="_Widget_FloatWin_"+wid;var oif;if(!el){el=document.createElement("DIV");el.id=wid;el.style.position="absolute";el.style.border="1px dotted";el.style.background="transparent url('"+_ZWF.staticServer+"images/wait24trans.gif') no-repeat center center";document.body.appendChild(el);el.innerHTML="<iframe onload=\"_ZWF.fwin.onWinLoad('"+wid+'\')"  src="'+_ZWF.staticServer+'empty.html" onfocus="_ZWF.fwin.bringToTop(\''+wid+'\')" id="'+fid+'" name="'+fid+'"  style="position:relative;cursor:default;" width="100%" height="100%" scrolling="no" allowTransparency="true" border="0" frameborder="0" ></iframe>';oif=_ZWF.$(fid);oif.src=surl}el.style.left=x+"px";el.style.top=y+"px";oif=_ZWF.$(fid);if(!ofw){el.style.width=w+"px";el.style.height=h+"px";el.style.zIndex=z;oif.style.width=w+"px";oif.style.height=h+"px"}var did="_Widget_DragDiv_"+wid;var odg=_ZWF.$(did);if(oarg.enableDrag){if(!odg){odg=document.createElement("DIV");odg.id=did;odg.style.position="absolute";document.body.appendChild(odg);odg.innerHTML="<div onmousedown=\"_ZWF.fwin.bringToTop('"+wid+"');_ZDrag.start(event,_ZWF.$('"+wid+"'),function(){_ZWF.fwin.afterDrag('"+wid+"')},function(){_ZWF.fwin.afterDrag('"+wid+'\')} );return false;" style="background-color:transparent;position:relative;height:10px;width:95%;cursor:move;"><span style="width:100%;height:100%">&nbsp;</span></div>'}odg.style.display="";odg.style.left=x+"px";odg.style.top=y+"px";if(!ofw){odg.style.width=Math.floor(w*.95)+"px";odg.style.height="10px";odg.style.zIndex=z+1}}if(navigator.appName.indexOf("Microsoft")!=-1){var bid="_Widget_BlindIE_"+wid;var obd=_ZWF.$(bid);if(!obd){obd=document.createElement("DIV");obd.id=bid;obd.style.position="absolute";document.body.appendChild(obd);obd.innerHTML=_ZWF.blindIEHTML}if(odg)odg.style.display="";if(!ofw){obd.style.width=w+"px";obd.style.height=h+"px";obd.firstChild.style.width=w+"px";obd.firstChild.style.height=h+"px";obd.style.zIndex=z-1}obd.style.left=x+"px";obd.style.top=y+"px"}var ofm=frames[fid];_ZWF.fwin.wins[wid]={id:wid,pWgtid:ocaller.wgtid,pCid:ocaller.cid,top:y,left:x,width:w,height:h,zIndex:z,ofm:ofm,odiv:el,obd:obd,odg:odg,bhidden:false,bAutoHide:oarg.bAutoHide,enableDrag:oarg.enableDrag,winType:winType};if(oarg.align){_ZWF.fwin.align(ocaller.wid,wid)}else{_ZWF.fwin.autoPos(wid)}_ZWF.fwin.bringToTop(wid,winType,oarg.bHideOther);return true};_ZWF.fwin.bringToTop=function(id,winType,bHideOther){var ofw=_ZWF.fwin.wins[id];if(!ofw||ofw.odiv.style.zIndex>_ZWF.fwin.maxZ)return false;var bh=typeof winType=="string"&&winType!=""&&bHideOther;var ow;for(var dat in _ZWF.fwin.wins){ow=_ZWF.fwin.wins[dat];if(ow.id==id)continue;if(bh&&ow.winType==winType)_ZWF.fwin._hide(ow.id);if(ow.odiv.style.zIndex<=_ZWF.fwin.maxZ)continue;ow.odiv.style.zIndex=ow.zIndex;if(ow.obd)ow.obd.style.zIndex=ow.zIndex-1;if(ow.odg)ow.odg.style.zIndex=ow.zIndex+1}ofw.odiv.style.zIndex=_ZWF.fwin.maxZ+10;if(ofw.obd)ofw.obd.style.zIndex=_ZWF.fwin.maxZ+9;if(ofw.odg)ofw.odg.style.zIndex=_ZWF.fwin.maxZ+11};_ZWF.fwin.onWinLoad=function(id){var ofw=_ZWF.fwin.wins[id];if(!ofw)return false;ofw.odiv.style.border="none";ofw.odiv.style.background="none"};_ZWF.fwin.openLogin=function(ocaller,oarg){_ZWF.fwin._hide("widget_registration");var ofw=_ZWF.fwin.wins[oarg.wid];oarg.wid="widget_login";oarg.src=_ZWF.staticServer+"login.html";oarg.width=320;oarg.height=240;oarg.zIndex=100;oarg.enableDrag=true;oarg.bAutoHide=false;oarg.followEvent=false;_ZWF.fwin.openHtml(ocaller,oarg)};_ZWF.fwin.openReg=function(ocaller,oarg){_ZWF.fwin._hide("widget_login");var ofw=_ZWF.fwin.wins[oarg.wid];oarg.wid="widget_registration";oarg.src=_ZWF.staticServer+"reg.html";oarg.width=320;oarg.height=345;oarg.zIndex=100;oarg.enableDrag=true;oarg.bAutoHide=false;oarg.followEvent=false;_ZWF.fwin.openHtml(ocaller,oarg)};_ZWF.fwin.hide=function(ocaller,oarg){_ZWF.fwin._hide(oarg.wid)};_ZWF.fwin.popMe=function(ocaller,oarg){var wid=oarg.wid;var ofw=_ZWF.fwin.wins[wid];if(!ofw)return;var winType=typeof ofw.winType=="string"?ofw.winType:"";_ZWF.fwin.show(wid);_ZWF.fwin.autoPos(wid);_ZWF.fwin.bringToTop(wid,winType,oarg.bHideOther)};_ZWF.fwin.resizeTo=function(ocaller,oarg){_ZWF.fwin._resizeTo(oarg.wid,oarg.w,oarg.h);_ZWF.fwin.autoPos(oarg.wid)};_ZWF.fwin.close=function(id){var ofw=_ZWF.fwin.wins[id];if(!ofw)return false;if(typeof _ZWF.fwin.evs["body_onmousedown"]=="function"){document.body.onmousedown=_ZWF.fwin.evs["body_onmousedown"];delete _ZWF.fwin.evs["body_onmousedown"]}ofw.odiv.innerHTML="";if(ofw.obd)document.body.removeChild(ofw.obd);if(ofw.odg)document.body.removeChild(ofw.odg);delete _ZWF.fwin.wins[id];return true};_ZWF.fwin._hide=function(id){var ofw=_ZWF.fwin.wins[id];if(!ofw||ofw.bhidden)return false;if(typeof _ZWF.fwin.evs["body_onmousedown"]=="function"){document.body.onmousedown=_ZWF.fwin.evs["body_onmousedown"];delete _ZWF.fwin.evs["body_onmousedown"]}if(ofw.odg)ofw.odg.style.display="none";if(ofw.obd)ofw.obd.style.display="none";ofw.width=ofw.odiv.clientWidth;ofw.height=ofw.odiv.clientHeight;_ZWF.fwin._resizeTo(id,0,0);ofw.bhidden=true;if(ofw.childWinKey&&_ZWF.childWins[ofw.childWinKey]){var oifo=_ZWF.childWins[ofw.childWinKey];if(oifo.onHiddenNotify)_COMM.sendMessage(oifo.onHiddenNotify,{type:"fwinChanged",key:"hidden",message:{cid:oifo.cid,bhidden:true}})}return true};_ZWF.fwin.show=function(id){var ofw=_ZWF.fwin.wins[id];if(!ofw||!ofw.bhidden)return false;if(ofw.bAutoHide){if(typeof document.body.onmousedown=="function"){_ZWF.fwin.evs["body_onmousedown"]=document.body.onmousedown}document.body.onmousedown=function(){eval('_ZWF.fwin._hide("'+id+'")')};_ZWF.fwin.autoHideID=id}if(ofw.odg)ofw.odg.style.display="";if(ofw.obd)ofw.obd.style.display="";ofw.odiv.style.display="";_ZWF.fwin._resizeTo(id,ofw.width,ofw.height);ofw.bhidden=false;if(ofw.childWinKey&&_ZWF.childWins[ofw.childWinKey]){var oifo=_ZWF.childWins[ofw.childWinKey];if(oifo.onHiddenNotify)_COMM.sendMessage(oifo.onHiddenNotify,{type:"fwinChanged",key:"hidden",message:{cid:oifo.cid,bhidden:false}})}return true};_ZWF.fwin.autoHide=function(){if(_ZWF.fwin.autoHideID){_ZWF.fwin._hide(_ZWF.fwin.autoHideID);_ZWF.fwin.autoHideID=null}};_ZWF.fwin.afterDrag=function(id){var ofw=_ZWF.fwin.wins[id];if(!ofw)return false;var x=Number(ofw.odiv.style.left.replace(/\D/g,""));var y=Number(ofw.odiv.style.top.replace(/\D/g,""));_ZWF.fwin.moveTo(id,x,y)};_ZWF.fwin.moveTo=function(id,x,y){_ZWF.fwin.show(id);var ofw=_ZWF.fwin.wins[id];if(!ofw)return false;ofw.odiv.style.left=x+"px";ofw.odiv.style.top=y+"px";if(ofw.odg){ofw.odg.style.left=x+"px";ofw.odg.style.top=y+"px"}if(ofw.obd){ofw.obd.style.left=x+"px";ofw.obd.style.top=y+"px"}return true};_ZWF.fwin.autoPos=function(id){var ofw=_ZWF.fwin.wins[id];if(!ofw)return false;var tb=_ZWF.desk.tb;var sy,sx;var bm=false;var x=ofw.odiv.offsetLeft;var y=ofw.odiv.offsetTop;var h=ofw.odiv.offsetHeight;var w=ofw.odiv.offsetWidth;if(typeof window.pageYOffset=="undefined"){sy=tb.scrollTop;sx=tb.scrollLeft}else{sy=window.pageYOffset;sx=window.pageXOffset}if(y<sy){ofw.odiv.style.top=sy+"px";bm=true}if(x<sx){ofw.odiv.style.left=sx+"px";bm=true}if(y+h>sy+tb.clientHeight){y=sy+tb.clientHeight-h;y=isNaN(y)||y<0?0:y;ofw.odiv.style.top=y+"px";bm=true}if(x+w>sx+tb.clientWidth){x=sx+tb.clientWidth-w;x=isNaN(x)||x<0?0:x;ofw.odiv.style.left=x+"px";bm=true}if(bm)_ZWF.fwin.afterDrag(id)};_ZWF.fwin.align=function(id1,id2){var ofw1=_ZWF.fwin.wins[id1];if(!ofw1)return false;var ofw2=_ZWF.fwin.wins[id2];if(!ofw2)return false;var tb=_ZWF.desk.tb;var pos1=_UTL.getAbsPosition(ofw1.odiv);var pos2=_UTL.getAbsPosition(ofw2.odiv);var lf,rf;if(pos1.x<=pos2.x){lf={p:pos1,w:ofw1};rf={p:pos2,w:ofw2}}else{lf={p:pos2,w:ofw2};rf={p:pos1,w:ofw1}}var x=lf.p.x+lf.p.w;if(x+rf.p.w>tb.clientWidth||rf.p.x<lf.p.x+lf.p.w){var allw=lf.p.w+rf.p.w;if(allw<tb.clientWidth){var rx=Math.floor((tb.clientWidth-allw)/2);_ZWF.fwin.moveTo(lf.w.id,rx,pos1.y);x=rx+lf.p.w}else{x=Math.floor((tb.clientWidth-w)/2)+tb.scrollLeft}_ZWF.fwin.moveTo(rf.w.id,x,pos1.y)}_ZWF.fwin.autoPos(id1);_ZWF.fwin.autoPos(id2)};_ZWF.fwin.resizeEmbTo=function(ocaller,oarg){var ofm=_ZWF.$("_Widget_Frame_"+ocaller.wgtid+"_"+ocaller.modid+"_"+ocaller.mname);if(!ofm)return;ofm.style.width=oarg.w+"px";ofm.style.height=oarg.h+"px"};_ZWF.fwin._resizeTo=function(id,w,h){var ofw=_ZWF.fwin.wins[id];if(!ofw)return false;if(ofw.odiv.offsetWidth!=w||ofw.odiv.offsetHeight!=h){ofw.odiv.firstChild.style.width=w+"px";ofw.odiv.firstChild.style.height=h+"px";ofw.odiv.style.width=w+"px";ofw.odiv.style.height=h+"px";if(ofw.odg){ofw.odg.style.width=Math.floor(w*.95)+"px"}if(ofw.obd){ofw.obd.style.width=w+"px";ofw.obd.style.height=h+"px";var fc=ofw.obd.firstChild;fc.style.width=w+"px";fc.style.height=h+"px"}_ZWF.fwin.afterDrag(id)}return true};_ZWF.widget={};_ZWF.widget.exec=function(wgtID,cmd,args){var owgt=_ZWF.widgets[wgtID];if(!owgt){var oarg,s;for(var dat in _ZWF.widgets){oarg=_ZWF.widgets[dat].args;if(!oarg)continue;var has=true;for(var ad in oarg){s=ad+"="+oarg[ad];if(wgtID.search(s)==-1){has=false;break}}if(has){owgt=_ZWF.widgets[dat];break}}}if(owgt&&owgt.main&&owgt.main.cid){_COMM.sendMessage(owgt.main.cid,{type:"command",key:"exec",message:{funName:cmd,args:args}})}};_ZWF.fwin.playWink=function(ocaller,oarg){window.setTimeout("_ZWF.wink.load('"+oarg.winkID+"')",200)};_ZWF.utl={};_ZWF.utl.showNotify=function(oarg){if(_ZWF.utl.notifyTimer)window.clearTimeout(_ZWF.utl.notifyTimer);var tb=_ZWF.desk.tb;var did="_ZWF_widget_Notify_Div";var el=_ZWF.$(did);if(!el){el=document.createElement("DIV");el.id=did;el.style.position="absolute";document.body.appendChild(el)}var z=_ZWF.fwin.baseZ+150;if(typeof window.pageYOffset=="undefined"){y=tb.scrollTop;x=tb.scrollLeft}else{y=window.pageYOffset;x=window.pageXOffset}var w=308;var h=82;el.style.left=x+"px";el.style.top=y+"px";el.style.width=w+"px";el.style.height=h+"px";el.style.zIndex=z;el.style.display="none";var obd=null;var isIE=navigator.appName.indexOf("Microsoft")!=-1;if(isIE){var bid="_Widget_BlindIE_"+did;obd=_ZWF.$(bid);if(!obd){obd=document.createElement("DIV");obd.id=bid;obd.style.position="absolute";document.body.appendChild(obd);obd.innerHTML=_ZWF.blindIEHTML}obd.style.display="";obd.style.width=w+"px";obd.style.height=h+"px";obd.firstChild.style.width=w+"px";obd.firstChild.style.height=h+"px";obd.style.zIndex=z-1;obd.style.left=x+"px";obd.style.top=y+"px"}var ts='<div style="width:100%;height:100%;'+_PNG.getBgStr(_ZWF.staticServer+"/utility/notify/images/notify_bg_1.png")+'">'+'<div onclick="_ZWF.utl.hideNotify();" style="float:right;cursor:pointer;position:relative;width:28px;height:24px;"></div>'+"<div onclick=\"_UTL.open('"+oarg.link+'\')" style="position:relative;width:272px;height:64px;padding-top:16px;cursor:pointer;filter:progid:DXImageTransform.Microsoft.Alpha(style=0,opacity=100);">';ts+='<table border="0" width="272" style="color:#FFFFFF;vertical-align:middle;font-size: 12px" height="50" cellspacing="0" cellpadding="0"><tr>';ts+='<td width="64" align="right" valign=top><div style="padding-left:4px;width:40px;height:40px;overflow:hidden" align=right><img src="%NotifyImg%" border=0 height=40px ></div></td>';ts+='<td valign=top><div style="width:200px;height:39px;line-height:14px;margin-left:12px;overflow:hidden;">%NotifyText%</div></td>';ts+="</tr></table>";var txt=oarg.text;txt=txt.replace(/\n/gm,"<br>");ts=ts.replace(/%NotifyText%/gm,txt);ts=ts.replace(/%NotifyImg%/gm,oarg.img);ts+="</div></div>";el.innerHTML=ts;_ZWF.utl.fade(did,true,5,0);var tot=4e3+(oarg.time?oarg.time:5e3);_ZWF.utl.notifyTimer=window.setTimeout("_ZWF.utl.hideNotify()",9e3)};_ZWF.utl.reloadAll=function(){location.reload(true)};_ZWF.utl.loctionGo=function(url){location.href=url};_ZWF.utl.historyGo=function(num){if(!num)num=-1;num=Number(num);history.go(num)};_ZWF.utl.resize=function(elid,w,h){var el=_ZWF.$(elid);if(!el)return false;if(w&&w!=el.offsetWidth)el.style.width=w+"px";if(h&&h!=el.offsetHeight)el.style.height=h+"px"};_ZWF.utl.fade=function(divID,bIn,step,beg){var odiv=_ZWF.$(divID);if(!odiv)return;step=Number(step);if(step<1||step>100)return;if(_ZWF.utl.fadeTimer)window.clearTimeout(_ZWF.utl.fadeTimer);if(bIn){if(odiv.style.display=="none"){odiv.style.display=""}beg+=step;if(beg>100)beg=100}else{beg-=step;if(beg<0)beg=0;if(beg==0&&odiv.style.display!="none"){odiv.style.display="none"}}var bf=beg>0&&beg<100;if(typeof odiv.style.filter!="undefined")odiv.style.filter=bf?"progid:DXImageTransform.Microsoft.Alpha(opacity="+beg+")":"none";else odiv.style.opacity=beg/100;if(bf)_ZWF.utl.fadeTimer=window.setTimeout('_ZWF.utl.fade("'+divID+'",'+bIn+","+step+","+beg+")",100);else if(_ZWF.utl.onFadeEnd)try{eval(_ZWF.utl.onFadeEnd);_ZWF.utl.onFadeEnd=null}catch(err){}};_ZWF.utl.hideNotify=function(){if(_ZWF.utl.notifyTimer)window.clearTimeout(_ZWF.utl.notifyTimer);var did="_ZWF_widget_Notify_Div";_ZWF.utl.fade(did,false,5,100);var bid="_Widget_BlindIE_"+did;var obd=_ZWF.$(bid);if(obd)obd.style.display="none"};_ZWF.utl.execFun=function(){var al=arguments.length;var funName=arguments[0];var brv=arguments[1];var s="";for(var i=2;i<al;i++){if(i>2)s+=",";s+="arguments["+i+"]"}var rv=null;try{eval((brv?"rv = ":"")+funName+"("+s+")")}catch(err){}if(brv)return rv};_ZWF.utl.evalStr=function(str){try{eval(str)}catch(err){}};_ZWF.wink={};_ZWF.wink.player=null;_ZWF.wink.load=function(winkID){if(!winkID)return;var wid="widget_winkPlayer";var tb=_ZWF.desk.tb;var w=tb.clientWidth;var h=tb.clientHeight;var x;var y;if(typeof window.pageYOffset=="undefined"){y=tb.scrollTop;x=tb.scrollLeft}else{y=window.pageYOffset;x=window.pageXOffset}var z=_ZWF.fwin.baseZ+200;var did="_ZWF_widget_winkPlayer_Div";var fid="_ZWF_widget_winkPlayer_Frame";var el=_ZWF.$(did);var ofw=frames[fid];if(!el){el=document.createElement("DIV");el.id=did;el.style.overflow="hidden";el.style.position="absolute";el.style.border="1px dotted";el.style.background="transparent url('"+_ZWF.staticServer+"images/wait24trans.gif') no-repeat center center";document.body.appendChild(el);el.innerHTML='<iframe onload="_ZWF.wink.onWinLoad()"  src="'+_ZWF.staticServer+'empty.html" id="'+fid+'" name="'+fid+'"  style="position:relative;cursor:default;" width="100%" height="100%" scrolling="no" allowTransparency="true" border="0" frameborder="0" ></iframe>'}el.style.left=x+"px";el.style.top=y+"px";el.style.width=w+"px";el.style.height=h+"px";el.style.zIndex=z;el.firstChild.style.width=w+"px";el.firstChild.style.height=h+"px";var obd=null;if(navigator.appName.indexOf("Microsoft")!=-1){var bid="_Widget_BlindIE_"+wid;obd=_ZWF.$(bid);if(!obd){obd=document.createElement("DIV");obd.id=bid;obd.style.position="absolute";document.body.appendChild(obd);obd.innerHTML=_ZWF.blindIEHTML}obd.style.display="";obd.style.width=w+"px";obd.style.height=h+"px";obd.firstChild.style.width=w+"px";obd.firstChild.style.height=h+"px";obd.style.zIndex=z-1;obd.style.left=x+"px";obd.style.top=y+"px"}if(!_ZWF.wink.player||!_ZWF.wink.player.wid){var oif=_ZWF.$(fid);oif.src=_ZWF.staticServer+"winkplayer/player.html?hid="+_COMM.clientID+"&winkid="+winkID;_ZWF.wink.player={odiv:el,obd:obd,ofw:ofw,wid:null}}else{_COMM.sendMessage(_ZWF.wink.player.wid,{type:"playWink",key:winkID,message:{}})}};_ZWF.wink.onWinLoad=function(){if(!_ZWF.wink.player)return;var odiv=_ZWF.wink.player.odiv;odiv.style.border="none";odiv.style.background="none"};_ZWF.wink.hide=function(winkID){if(!_ZWF.wink.player)return;_ZWF.wink.player.wid=winkID;var ow=_ZWF.wink.player;if(ow.obd)ow.obd.style.display="none";var odiv=ow.odiv;odiv.firstChild.style.width="0px";odiv.firstChild.style.height="0px";odiv.style.width="0px";odiv.style.height="0px"};if(typeof _ZWA=="undefined")var _ZWA={};_ZWA.temp={};_ZWA.exec=function(funName,argStr){var fun=null;try{eval("fun = _ZWA."+funName)}catch(err){}if(typeof fun=="function")fun(argStr)};_ZWA.load=function(el,wid,funName,argStr){var fun=null;try{eval("fun = _ZWA."+funName)}catch(err){}if(typeof fun=="function"){fun(argStr)}else{_ZWF.initWidget(wid+"&wtype=zwapop",{srcElement:el?el:document.body,funName:funName,argStr:argStr})}};_ZWA.load2=function(args){var idx=args[0];_ZWA.temp[idx]=args;window.setTimeout('_ZWA.loading("'+idx+'")',200)};_ZWA.loading=function(idx){var args=_ZWA.temp[idx];if(args)_ZWA.load(null,args[0],args[1],args[2])};_ZWA.getCaller=function(funName,mid){if(!mid)mid=0;var achs=_ZWF.achs[funName];if(!achs||achs.length<1)return null;else return achs[mid]};_ZWF.chatHosts=[{h:"say-on"},{h:"space.sina",disabled:true},{h:"widget.sina"},{h:"pengyou.sina"},{h:"penyou.sina"},{h:"blog.sina.com.cn",disabled:true}];_ZWF.chat={to:function(){},notify:function(){},hostSettings:{}};_ZWF.startChat=function(){var h=document.location.host.toLowerCase();var lst=_ZWF.chatHosts;var js="http://webim.pengyou.sina.com.cn/wchat/js/buddy.js";var css="http://webim.pengyou.sina.com.cn/wchat/images/v2/buddy.css";var enb=false;var itm;for(var i=0;i<lst.length;i++){itm=lst[i];if(h.search(itm.h)!=-1){if(!itm.disabled)enb=true;if(itm.js)js=itm.js;if(itm.css)js=itm.css;_ZWF.chat.hostSettings=itm;break}}if(typeof __sayon_webim_msg_pop__=="undefined"){__sayon_webim_msg_pop__=enb}if(__sayon_webim_msg_pop__==false)return;if(!_COMM.auth.sinaUserInfo||!_COMM.auth.sinaUserInfo.uid)return;if(typeof _ZWF.chat.start!="function"){_UTL.importJS(js,"zoomsun_widget_chat_js",null,"GBK");_UTL.importCSS(css)}else{_ZWF.chat.start()}};window.setTimeout("_ZWF.init()",200+Math.floor(100*Math.random()));