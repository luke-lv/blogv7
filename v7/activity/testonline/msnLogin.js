if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Sina;for(var i=levels[0]=="Sina"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};function $E(oID){var node=typeof oID=="string"?document.getElementById(oID):oID;if(node!=null){return node}return null}function $C(tagName){return document.createElement(tagName)}function $N(name){return document.getElementsByName(name)}function $T(obj,tagName){return obj.getElementsByTagName(tagName)}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}(function(){var bind=function(fFunction,object){var __method=fFunction;return function(){return __method.apply(object,arguments)}};var debug_namespace="Debug";if(window[debug_namespace]==null||typeof window[debug_namespace].log=="undefined"){window[debug_namespace]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(sInfo){this.addData(sInfo,1)},error:function(sInfo){this.addData(sInfo,2)},warning:function(sInfo){this.addData(sInfo,3)},info:function(sInfo){this.addData(sInfo,4)},log:function(sInfo){this.addData(sInfo,5)},dir:function(oInfo){this.addData(oInfo,5)},addData:function(sInfo,nType,sColor,sBgColor){if(sInfo==null){return}if(typeof sInfo!="object"){sInfo=sInfo.toString()}var oOption={type:nType||"5",color:sColor||this.baseColor[nType].color,bgcolor:sBgColor||this.baseColor[nType].bgcolor};this.cacheData.push([sInfo,oOption]);if(this.initFinished==true){this.showCurrentData([sInfo,oOption])}}};window.trace=bind(window[debug_namespace].log,window[debug_namespace]);window.traceError=bind(window[debug_namespace].error,window[debug_namespace])}})();Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.Array");Core.Array.foreach=function(ar,insp){if(ar==null&&ar.constructor!=Array){return[]}var i=0,len=ar.length,r=[];while(i<len){var x=insp(ar[i],i);if(x!==null){r[r.length]=x}i++}return r};Sina.pkg("Core.Events");(function(_s){var _ua=navigator.userAgent.toLowerCase();var system={$winXP:/windows nt 5.1/.test(_ua),$winVista:/windows nt 6.0/.test(_ua),$win7:/windows nt 6.1/.test(_ua),$macOS:/mac/.test(_ua)};var browser={$OPERA:false,$IE6:false,$IE7:false,$IE8:false,$IE9:false,$SAFARI:false,$FF2:false,$FF3:false,$FF4:false,$FF:false,$CHROME:false,$TT:false,$360:false,$SOGO:false,$Maxthon:false};var engine={$IE:0,$MOZ:false,$WEBKIT:false,$KHTML:false};if(/opera/.test(_ua)||_s.opera){browser.$OPERA=true}else if(/chrome\/(\S+)/.test(_ua)){browser.$CHROME=true}else if(/safari\/(\S+)/.test(_ua)){browser.$SAFARI=true}else if(/msie/.test(_ua)){engine.$IE=true;if(/360se/.test(_ua)){browser.$360=true}else if(/tencenttraveler/.test(_ua)){browser.$TT=true}else if(/se\s\S+\smetasr\s\d+\.\d+/.test(_ua)){browser.$SOGO=true}var uaVersionArray=_ua.match(/msie (\d+)/);var version=parseInt(uaVersionArray[1]);engine.$IE=version;if(version===8){browser.$IE8=true}else if(version===6){browser.$IE6=true}else if(version===9){browser.$IE9=true}else if(version===7){browser.$IE7=true}else if(version===10){browser.$IE10=true}}else if(/firefox/.test(_ua)){var uaVersionArray=_ua.match(/firefox\/(\d+)/);browser.$FF=parseInt(uaVersionArray[1]);if(/firefox\/3/.test(_ua)){browser.$FF3=true}else if(/firefox\/4/.test(_ua)){browser.$FF4=true}else if(/firefox\/2/.test(_ua)){browser.$FF2=true}}else if(/trident\/7.0/.test(_ua)&&/rv:11.0/.test(_ua)){engine.$IE=11;browser.$IE11=true}try{var t=window.external;browser.$Maxthon=t.max_version?true:false}catch(e){}if(/applewebkit\/(\S+)/.test(_ua)){engine.$WEBKIT=true}else if(/khtml\/(\S+)/.test(_ua)){engine.$KHTML=true}else if(/rv:([^\)]+)\) gecko\/\d{8}/.test(_ua)){engine.$MOZ=true}browser.$MOBILE=/mobile/i.test(_ua);if(!browser.$MOBILE){browser.$MOBILE=/HTC/.test(_ua)}function apply(thisObj,cfg){var p;for(p in cfg){thisObj[p]=cfg[p]}}apply(_s,browser);apply(_s,engine);apply(_s,system)})(window);Core.Events.addEvent=function(elm,func,evType,useCapture){var _el=typeof elm=="string"?$E(elm):elm;if(_el==null){trace("addEvent 找不到对象："+elm);return}if(typeof useCapture=="undefined"){useCapture=false}if(typeof evType=="undefined"){evType="click"}if(_el.addEventListener){if(evType=="mousewheel"&&$FF){evType="DOMMouseScroll"}_el.addEventListener(evType,func,useCapture);return true}else if(_el.attachEvent){var r=_el.attachEvent("on"+evType,func);return true}else{_el["on"+evType]=func}};Core.Events.removeEvent=function(oElement,fHandler,sName){var _el=$E(oElement);if(_el==null){trace("removeEvent 找不到对象："+oElement);return}if(typeof fHandler!="function"){return}if(typeof sName=="undefined"){sName="click"}if(_el.addEventListener){_el.removeEventListener(sName,fHandler,false)}else if(_el.attachEvent){_el.detachEvent("on"+sName,fHandler)}fHandler[sName]=null};Sina.pkg("Core.Function");Core.Function.bind3=function(fFunc,object,args){args=args==null?[]:args;var __method=fFunc;return function(){return __method.apply(object,args)}};Core.Array.findit=function(arr,v){var k=-1;Core.Array.foreach(arr,function(value,index){if(v==value){k=index}});return k};window.onerror=function(err,file,line){trace("Error occured:"+err+"<br/>file:"+file+"<br/>line:"+line+"<br/>");return true};function Jobs(oOption){this.option=oOption||{};this._jobTable=[[],[],[],[]]}Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(jobName,rel){this._registedJobTable[jobName]=rel},error:function(sMsg){Debug.error(sMsg);this.errorMsg.push(sMsg)},add:function(jobName,type){type=type||1;if(Core.Array.findit(this._jobTable[type],jobName)==-1){this._jobTable[type].push(jobName)}else{this.error("Error: Job <b>"+jobName+"</b> is existed now.")}},start:function(){if(this.option.onStart!=null){this.option.onStart()}var regJobs=this._registedJobTable;var jobs=this._jobTable[1].concat(this._jobTable[2]);var _this=this;this.fe=Core.Function.bind3(_this.focus,_this,[]);var addFocus=function(){if(_this._jobTable[3].length==0){if(_this.option.onEnd!=null){_this.option.onEnd()}return}Core.Events.addEvent(document.body,_this.fe,"focus");Core.Events.addEvent(window,_this.fe,"scroll");Core.Events.addEvent(document.body,_this.fe,"mousemove");Core.Events.addEvent(document.body,_this.fe,"mouseover")};this.queue(jobs,addFocus)},focus:function(){var _this=this;if(this.focusdown){Core.Events.removeEvent(document.body,_this.fe,"focus");Core.Events.removeEvent(window,_this.fe,"scroll");Core.Events.removeEvent(document.body,_this.fe,"mousemove");Core.Events.removeEvent(document.body,_this.fe,"mouseover");_this.fe=null;return}this.focusdown=true;var jobs=this._jobTable[3];this.queue(jobs,this.option.onEnd)},queue:function(jobs,callback){var _this=this;var getTime=function(){return(new Date).valueOf()};var regJobs=this._registedJobTable;var joblen=jobs.length;var i=0;var interNum=window.setInterval(function(){if(i>=joblen){clearInterval(interNum);interNum=null;if(callback!=null){callback()}return}var jobName=jobs[i];var job=regJobs[jobName];i++;if(typeof job=="undefined"){_this.error("<b>Job["+jobName+"] is undefiend!!!</b>");return}var _try=true;var _start=getTime();try{job.call()}catch(e){_this.error("<b>Job["+jobName+"] failed!!!</b>"+e.message+"");if(callback!=null){callback()}_try=false;throw e}finally{if(_try){var _end=getTime();Debug.info("<b>Job["+jobName+"] done in "+(_end-_start)+"ms.</b>")}}},10)},call:function(jobName,args){if(typeof this._registedJobTable[jobName]!="undefined"){this._registedJobTable[jobName].apply(this,args)}else{trace("<b>Job["+jobName+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}}};$registJob=function(name,rel){Jobs.prototype._registJob(name,rel)};$callJob=function(name){var args=[];if(arguments.length>1){Core.Array.foreach(arguments,function(v,i){args[i]=v});args.shift()}Jobs.prototype.call(name,args)};var $SYSMSG={};$SYSMSG.extend=function(info,override){for(var i in info){$SYSMSG[i]=!!override==false?info[i]:$SYSMSG[i]}};$SYSMSG.extend({A10040:"该种类型邮箱已经禁止注册，请选择其它类型邮箱注册。",A10038:"邮箱地址错误。",A10031:"密码格式不正确。",A00001:"操作失败。",A10041:"该用户未在游戏网站注册",21:"用户名长度错误",20:"登录名应为 4－32 位",22:"会员名不能以下划线结尾",30:"登录名应为 4－32 位",31:"用户名长度错误",32:"会员名不能以下划线结尾",130:"昵称应由中文，数字，英文小写字母组成",131:"昵称应为 4－20 位",132:"昵称不能含有不能含有特殊字符",80:"密码只能由数字，英文字母(区分大小写)",81:"密码应为 6-16 位",82:"密码中的下划线不能在最后",4032:"注册邮箱失败",4033:"注册邮箱失败",4036:"用户名已经存在",A2005:"昵称不能为空",A2004:"您的操作可能已经失效，请点击确定返回第一步",A00006:"MSN 和当前登录用户已经绑定",A0089:"你的 MSN 账号已经正常完成搬家了，确认要继续？",A0090:"MSN 未登录，点击确定返回上一步重新登录",A0092:"你的 MSN 账号已经绑定过一个新浪博客账号，继续此操作将撤销你之前的绑定！",A0093:"你登录的博客账号并未开通，点击确定开通博客！",A0099:"你有一个搬家流程正在进行中，请等待完成后再试"});(function(){function object(o){function F(){}F.prototype=o;return new F}Function.prototype.$define=function(def){var k;for(k in def){this.prototype[k]=def[k]}if(this.__interface__){for(k in this.prototype){if(this.prototype[k]==="NI"){throw new Error("类定义错误，接口方法["+k+"]未实现")}}}this.prototype.constructor=this;this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")};return this};Function.prototype.$extends=function(){var me=this,i=arguments.length,sup,fn;if(i===0){throw new Error("$extends语句错误：未指定父类")}sup=arguments[0];fn=function(){sup.apply(this,arguments);me.apply(this,arguments)};fn.prototype=object(sup.prototype);fn.prototype.constructor=fn;fn.$super=sup.prototype;return fn};Function.prototype.$implements=function(){var arg=Array.prototype.slice.call(arguments,0),fn,i=arg.length,k;while(i--){if(typeof arg[i]!=="object"){throw new Error("$implements语句错误：参数必须为object类型")}for(k in arg[i]){typeof this.prototype[k]==="undefined"&&(this.prototype[k]="NI")}}this.__interface__=true;this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")};return this}})();Core.Events.getEvent=function(){return window.event};if(!$IE||$IE>8){Core.Events.getEvent=function(){if(!$IE&&window.event){return window.event}var o=arguments.callee.caller;var e;var n=0;while(o!=null&&n<40){e=o.arguments[0];if(e&&(e.constructor==Event||e.constructor==MouseEvent)){return e}n++;o=o.caller}return e}}Core.Events.stopEvent=function(el){var ev=el?el:Core.Events.getEvent();if(ev!=null){ev.cancelBubble=true;ev.returnValue=false}};if(!$IE||$IE>8){Core.Events.stopEvent=function(el){var ev=el?el:Core.Events.getEvent();if(ev!=null){ev.preventDefault();ev.stopPropagation()}}}Sina.pkg("Ui");if(typeof Ui=="undefined"){Ui=Sina.Ui}Core.Function.bind2=function(fFunc,object){var __method=fFunc;return function(){return __method.apply(object,arguments)}};Function.prototype.bind2=function(object){var __method=this;return function(){return __method.apply(object,arguments)}};Ui.Template=function(tmpl){this.tmpl=tmpl;this.pattern=/(#\{(.*?)\})/g};Ui.Template.prototype={evaluate:function(data){return this.tmpl.replace(this.pattern,function(){return data[arguments[2]]||""})},evaluateMulti:function(data,reverse){var _buffer=[];Core.Array.foreach(data,Core.Function.bind2(function(v,i){i=reverse?data.length-i:i;_buffer[i]=this.evaluate(v)},this));return _buffer.join("")}};Sina.pkg("Core.Dom");Core.Dom.setStyle=function(el,property,val){switch(property){case"opacity":el.style.filter="alpha(opacity="+val*100+")";if(!el.currentStyle||!el.currentStyle.hasLayout){el.style.zoom=1}break;case"float":property="styleFloat";default:el.style[property]=val}};if(!$IE||!($IE<9)){Core.Dom.setStyle=function(el,property,val){if(property=="float"){property="cssFloat"}el.style[property]=val}}(function(){Core.Function.defineGetter=function(obj,p,fn){if(p instanceof Array&&fn instanceof Array){var i=Math.min(p.length,fn.length);while(i--){if(typeof p[i]==="string"&&__checkFunction(fn[i])){obj[p[i]]={valueOf:function(j){return function(){return __getValue(obj,fn[j])}}(i),toString:this.valueOf}}}}else if(typeof p==="string"&&__checkFunction(fn)){obj[p]={valueOf:function(){return __getValue(obj,fn)},toString:this.valueOf}}};function __checkFunction(fn){return typeof fn!=="string"&&String.prototype.slice.call(fn,0,8)=="function"}function __getValue(obj,fn){var ret=fn.call(obj);return typeof ret==="string"||typeof ret==="number"?ret:null}})();Ui.IE6FixedController=function(){var me=this;this.node=null;this.iframeNode=null;this.__orgX=0;this.__orgY=0;this.__isBindScroll=false;this.__fixedHandle=function(){if(me.node){me.node.style.left=document.documentElement.scrollLeft+me.__orgX+"px";me.node.style.top=document.documentElement.scrollTop+me.__orgY+"px"}if(me.iframeNode){me.iframeNode.style.left=me.node.style.left;me.iframeNode.style.top=me.node.style.top}}}.$define({setFixed:function(node,state){this.updateOrgPosition();if(state&&!this.__isBindScroll){Core.Events.addEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=true}if(!state&&this.__isBindScroll){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false}},setPosition:function(node,fixedState,p){if(typeof p.x!=="undefined"){if(fixedState){node.style.left=p.x+document.documentElement.scrollLeft+"px";this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft}else{node.style.left=p.x+"px"}}if(typeof p.y!=="undefined"){if(fixedState){node.style.top=p.y+document.documentElement.scrollTop+"px";this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop}else{node.style.top=p.y+"px"}}typeof p.z!=="undefined"&&(node.style.zIndex=p.z)},getX:function(node,fixedState){if(fixedState){return parseInt(node.style.left)-document.documentElement.scrollLeft}else{return parseInt(node.style.left)}},getY:function(node,fixedState){if(fixedState){return parseInt(node.style.top)-document.documentElement.scrollTop}else{return parseInt(node.style.top)}},updateIframe:function(isFixed){this.setFixed(this.iframeNode,isFixed);isFixed&&this.__fixedHandle()},updateOrgPosition:function(){if(!this.node){return}this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft;this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false;this.node=null;this.iframeNode=null}});Core.Events.EventDispatcher=function(target){this.__target=target;this.__events={}}.$define({addEventListener:function(type,handle){if(!this.__checkFunction(handle)){return}var evts=this.__events;type=type.toLowerCase();!evts[type]&&(evts[type]=[]);evts[type].push(handle)},removeEventListener:function(type,handle){var evts=this.__events[type];type=type.toLowerCase();if(!this.__checkFunction(handle)||!evts||!evts.length){return}for(var i=evts.length-1;i>=0;i--){evts[i]==handle&&evts.splice(i,1)}},dispatchEvent:function(type){type=type.toLowerCase();var evts=this.__events[type];if(!evts||!evts.length){return}var args=Array.prototype.slice.call(arguments,0);args.shift();for(var i=0,l=evts.length;i<l;i++){evts[i].apply(this.__target,args)}},__checkFunction:function(func){return typeof func!=="string"&&String.prototype.slice.call(func,0,8)=="function"}});Ui.IRenderer={setCanShow:function(state){},setCanHidden:function(state){},show:function(node){},hidden:function(node){},addEventListener:function(type,handle){},removeEventListener:function(type,handle){}};Ui.SimpleRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(state){this.__canShow=!!state},setCanHidden:function(state){this.__canHidden=!!state},show:function(node){this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){node.style.display="";this.__eventDispatcher.dispatchEvent("show")}return this},hidden:function(node){this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){node.style.display="none";this.__eventDispatcher.dispatchEvent("hidden")}return this},addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this}});Ui.DisplayObject=function(parent,node){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]);this.__renderer=null;this.__entity=node;this.__isInited=false;this.__parent=parent||document.body;this.__eventDispatcher=new Core.Events.EventDispatcher(this);var ed=this.__eventDispatcher;this.__onBeforeShow=function(){ed.dispatchEvent("beforeShow")};this.__onShow=function(){ed.dispatchEvent("show")};this.__onBeforeHidden=function(){ed.dispatchEvent("beforeHidden")};this.__onHidden=function(){ed.dispatchEvent("hidden")};this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(p){!this.__isInited&&this.__initEntity();typeof p.x!=="undefined"&&(this.__entity.style.left=p.x+"px");typeof p.y!=="undefined"&&(this.__entity.style.top=p.y+"px");typeof p.z!=="undefined"&&(this.__entity.style.zIndex=p.z);return this},setSize:function(p){!this.__isInited&&this.__initEntity();typeof p.width!=="undefined"&&(this.__entity.style.width=p.width+"px");typeof p.height!=="undefined"&&(this.__entity.style.height=p.height+"px");return this},setRenderer:function(rendererConstructor){!this.__isInited&&this.__initEntity();this.__updateRenderer(rendererConstructor);return this},show:function(rendererConstructor){this.isHidden=!1;this.isShow=!0;!this.__isInited&&this.__initEntity();this.__updateRenderer(rendererConstructor);this.__renderer.show(this.__entity);return this},hidden:function(rendererConstructor){return this.hide(rendererConstructor)},hide:function(rendererConstructor){this.isHidden=!0;this.isShow=!1;!this.__isInited&&this.__initEntity();this.__updateRenderer(rendererConstructor);this.__renderer.hidden(this.__entity);return this},setCanShow:function(state){this.__renderer.setCanShow(state);return this},setCanHidden:function(state){this.__renderer.setCanHidden(state);return this},addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},destroy:function(){if(!this.__entity){return}!this.__isInited&&this.__initEntity();this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity);this.__entity=null},__initEntity:function(){var st;!this.__entity&&(this.__entity=$C("div"));st=this.__entity.style;st.position="absolute";st.left=0;st.top=0;!this.__entity.parentNode&&this.__parent.appendChild(this.__entity);this.__isInited=true},__updateRenderer:function(rendererConstructor){if(!rendererConstructor){return}var addEvent=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};if(!this.__renderer){this.__renderer=new rendererConstructor;addEvent.call(this)}else if(this.__renderer.constructor!==rendererConstructor){this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden);this.__renderer=new rendererConstructor;addEvent.call(this)}},__getX:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.left)},__getY:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.top)},__getZ:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.zIndex)},__getWidth:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetHeight")},__getSize:function(node,p){var et=node,v,ov=et.style.visibility;if(et.style.display=="none"){et.style.visibility="hidden";et.style.display="";v=et[p];et.style.display="none";et.style.visibility=ov}else{v=et[p]}return v}});Ui.Panel=function(parent,node){this.nodes={};this.uniqueID=this.__getUniqueID();this.entity=null;this.__iframe=null;this.__isSetAdamant=false;this.__templateNodesIDs=[];this.__isFixed=false;$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController)}.$extends(Ui.DisplayObject).$define({setTemplate:function(tpl){var nd=$C("div");nd.innerHTML=new Ui.Template(tpl).evaluate(this.__getNodes(tpl,"i"));nd.style.display="none";this.__parent.appendChild(nd);this.__updateTemplate(nd);this.nodes=this.__getNodes(tpl);this.entity=this.__entity;this.nodes.panel=this.entity;return this},setFixed:function(state){!this.__isInited&&this.__initEntity();var x=parseInt(this.__entity.style.left),y=parseInt(this.__entity.style.top);if($IE6){this.__ie6FixedController.setFixed(this.__entity,state);this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,state)}else{if(state&&!this.__isFixed){this.setPosition({x:x-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:y-Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="fixed"}if(!state&&this.__isFixed){this.setPosition({x:x+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:y+Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="absolute"}}this.__isFixed=!!state;this.__updateIframe();return this},setAdamant:function(state){this.__isSetAdamant=!!state;this.__isSetAdamant&&!this.__iframe&&this.__createIframe();this.__updateIframe();return this},destroy:function(){if(!this.__entity){return}Ui.Panel.$super.destroy.call(this);this.__ie6FixedController&&this.__ie6FixedController.destroy();this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe)},setPosition:function(p){!this.__isInited&&this.__initEntity();if($IE6){this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,p)}else{Ui.Panel.$super.setPosition.call(this,p)}this.__updateIframe();return this},setSize:function(p){Ui.Panel.$super.setSize.call(this,p).__updateIframe();return this},show:function(renderer){Ui.Panel.$super.show.call(this,renderer).__updateIframe();return this},hidden:function(renderer){Ui.Panel.$super.hidden.call(this,renderer).__updateIframe();return this},__getX:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getX(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.left)}},__getY:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getY(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.top)}},__createIframe:function(){this.__iframe=$C("iframe");this.__iframe.frameBorder="none";this.__parent.insertBefore(this.__iframe,this.__entity);Core.Dom.setStyle(this.__iframe,"opacity",0);this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe);this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var st=this.__iframe.style;st.backgroundColor="#ffffff";st.left=this.x+"px";st.top=this.y+"px";st.width=this.width+"px";st.height=this.height+"px";st.position=this.__entity.style.position;st.display=this.__entity.style.display;st.zIndex=this.__entity.style.zIndex;$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(nd){var l,t,z,p,d,et=this.__entity;if(et){et.parentNode&&et.parentNode.removeChild(et);l=et.style.left;t=et.style.top;z=et.style.zIndex;p=et.style.position;d=et.style.display}else{d="none"}et=this.__entity=$E("_"+this.uniqueID+"_panel");if(!et){et=this.__entity=$E("_"+this.uniqueID+"_entity")}if(!et){throw new Error("[Panel Error]there missing identifier #{panel} in panel template")}et.style.left=l||0;et.style.top=t||0;et.style.zIndex=z||0;et.style.position=p||"absolute";et.style.display=d;this.__parent.replaceChild(et,nd);this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(template,mode){var m=mode||"o",p=/\{[^\}]+(?=\})/g,i,nodes={},rets,r;this.__templateNodesIDs=template.match(p);rets=this.__templateNodesIDs;if(rets){i=rets.length;while(i--){r=rets[i].replace("{","");switch(m){case"o":nodes[r]=$E("_"+this.uniqueID+"_"+r);break;case"i":nodes[r]="_"+this.uniqueID+"_"+r;break}}}return nodes},__getUniqueID:function(){return parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()},setContent:function(str){this.nodes.content&&(this.nodes.content.innerHTML=str)},getNodes:function(){return this.nodes}});Ui.Drag=function(captureNode,attachNodes,isDragCapureNode){var me=this;this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.__captureNode=captureNode;this.__dragNodes=[];this.__deltaX=[];this.__deltaY=[];this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__isDraging=false;this.__canDragX=true;this.__canDragY=true;this.__dragHandle=function(){me.__drag()};this.__mouseDownHandle=function(){me.__isDraging=true;me.__eventDispatcher.dispatchEvent("beforeDrag");me.__setCapture(true)};this.__mouseUpHandle=function(){me.__isDraging&&me.__eventDispatcher.dispatchEvent("afterDrag");me.__isDraging=false;me.__setCapture(false)};this.__initNodes(captureNode,attachNodes,isDragCapureNode);this.__initCaputerNode()}.$define({addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown");Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup");this.__captureNode=null;this.__dragNodes=null},__initNodes:function(captureNode,attachNodes,isDragCapureNode){if(attachNodes){attachNodes instanceof Array?this.__dragNodes=attachNodes:this.__dragNodes.push(attachNodes);(typeof isDragCapureNode==="undefined"||isDragCapureNode)&&this.__dragNodes.push(this.__captureNode)}else{this.__dragNodes.push(this.__captureNode)}var dns=this.__dragNodes,i=dns.length;while(i--){!dns[i].style.position&&(dns[i].style.position="absolute");!dns[i].style.left&&(dns[i].style.left=0);!dns[i].style.top&&(dns[i].style.top=0)}},__initCaputerNode:function(){var cn=this.__captureNode,me=this;Core.Events.addEvent(cn,this.__mouseDownHandle,"mousedown");Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(isCapture){var cn=this.__captureNode,dns=this.__dragNodes,evt=Core.Events.getEvent(),i=dns.length;while(i--){this.__deltaX[i]=evt.clientX-parseInt(dns[i].style.left);this.__deltaY[i]=evt.clientY-parseInt(dns[i].style.top)}if(isCapture){if($IE){cn.setCapture();Core.Events.addEvent(cn,this.__dragHandle,"mousemove")}else{Core.Events.addEvent(document,this.__dragHandle,"mousemove")}}else{if($IE){cn.releaseCapture();Core.Events.removeEvent(cn,this.__dragHandle,"mousemove")}else{Core.Events.removeEvent(document,this.__dragHandle,"mousemove")}}},__drag:function(){if(!this.canDrag){return}var dns=this.__dragNodes,evt=Core.Events.getEvent(),i=dns.length,la=this.lockArea,dX=0,dY=0;this.__eventDispatcher.dispatchEvent("drag");while(i--){dX=evt.clientX-this.__deltaX[i];dY=evt.clientY-this.__deltaY[i];if(this.isLock){dX=Math.min(Math.max(dX,la.left),la.right);dY=Math.min(Math.max(dY,la.top),la.bottom)}dns[i].style.left=dX+"px";dns[i].style.top=dY+"px"}}});Ui.IDragger={addEventListener:function(type,handle){},removeEventListener:function(type,handle){},setDrag:function(node,attachNodes,isDragCapureNode){},setLock:function(state){},setArea:function(area){},destroy:function(){}};Ui.SimpleDragger=function(){this.__drag=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(type,handle)}else{this.__drag.addEventListener(type,handle)}return this},removeEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(type,handle)}else{this.__drag.removeEventListener(type,handle)}return this},setDrag:function(node,attachNode,isDragCapureNode){var me=this;this.__drag=new Ui.Drag(node,attachNode,isDragCapureNode);this.__drag.addEventListener("afterDrag",function(){me.__eventDispatcher.dispatchEvent("afterDrag")});return this},setLock:function(state){this.__drag.isLock=!!state;return this},setArea:function(area){this.__drag.lockArea=area;return this},destroy:function(){this.__drag.destroy()}});Ui.Dialog=function(parent,node){var me=this;this.__dragger=null;this.__isBindUpadateAreaEvent=false;this.__isBindUpdateIE6AreaEvent=false;this.__beforeDragHandle=function(){me.__updateDraggerArea();me.__eventDispatcher.dispatchEvent("beforedrag")};this.__dragHandle=function(){me.__isSetAdamant&&me.__updateIframe();me.__eventDispatcher.dispatchEvent("drag")};this.__afterDragHandle=function(){me.__isFixed&&$IE6&&me.__updateIE6FCOrgPosition();me.__eventDispatcher.dispatchEvent("afterdrag")};this.__updateDraggerAreaHandle=function(){setTimeout(function(){me.__updateDraggerArea()},1)};this.__setMiddleHandle=function(){me.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(tpl){Ui.Dialog.$super.setTemplate.call(this,tpl);this.__initTitleBar();this.setDragger(Ui.SimpleDragger);return this},setContent:function(content){if(!this.nodes.content){return this}this.nodes.content.innerHTML=new Ui.Template(content).evaluate(this.__getNodes(content,"i"));this.__addContentNodes(this.__getNodes(content));return this},setFixed:function(state){Ui.Dialog.$super.setFixed.call(this,state);if(state){Core.Events.addEvent(window,this.__setMiddleHandle,"resize")}else{Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")}this.__updateDraggerArea();return this},setMiddle:function(){var areaHeight=this.__getDocumentSize().height-this.height,goldenSection=(Math.sqrt(5)-1)/2,totalSection=1,goldenSectionY=areaHeight*goldenSection/(goldenSection+totalSection),middleX=this.__getDocumentSize().width/2-this.width/2;if(!this.__isFixed){goldenSectionY+=Math.max(document.documentElement.scrollTop,document.body.scrollTop);middleX+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)}this.setPosition({x:Math.max(middleX,0),y:Math.max(goldenSectionY,0)});return this},setAreaLocked:function(state){if(!this.__dragger){return this}this.__dragger.setLock(state);return this},setSize:function(p){!this.__isInited&&this.__initEntity();if(this.nodes.content){typeof p.width!=="undefined"&&(this.nodes.content.style.width=p.width+"px");typeof p.height!=="undefined"&&(this.nodes.content.style.height=p.height+"px")}else{typeof p.width!=="undefined"&&(this.__entity.style.width=p.width+"px");typeof p.height!=="undefined"&&(this.__entity.style.height=p.height+"px")}return this},setDragger:function(draggerConstructor){if(!this.nodes.titleBar||!draggerConstructor){return this}if(!this.__dragger){this.__dragger=new draggerConstructor}else if(this.__dragger.constructor===draggerConstructor){return this}this.__updateDragger(draggerConstructor);return this},destroy:function(){if(!this.__entity){return}Ui.Dialog.$super.destroy.call(this);Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize");Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")},__addContentNodes:function(nodes){var nds=this.nodes,k;for(k in nodes){nds[k]=nodes[k]}},__updateDragger:function(draggerConstructor){if(this.__dragger.constructor!==draggerConstructor){this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle);this.__dragger.destroy();this.__dragger=new draggerConstructor}this.__dragger.setDrag(this.nodes.titleBar,this.__entity,false);this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle);

},__updateDraggerArea:function(){var l,t,r,b;if(this.__isFixed){l=$IE6?document.documentElement.scrollLeft:0;t=$IE6?document.documentElement.scrollTop:0;r=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width;b=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height}else{l=0;t=0;r=document.documentElement.scrollWidth-this.width;b=document.documentElement.scrollHeight-this.height}this.__dragger.setArea({left:l,top:t,right:r,bottom:b})},__initTitleBar:function(){if(!this.nodes.titleBar){return}var tb=this.nodes.titleBar;tb.style.cursor="move";if($IE){Core.Events.addEvent(tb,function(){return false},"selectstart")}else{tb.style.MozUserSelect="none"}},__getDocumentSize:function(){var w=document.documentElement.clientWidth||document.body.clientWidth,h=document.documentElement.clientHeight||document.body.clientHeight;return{width:w,height:h}}});Ui.ModuleDialog=function(tplConfig,iconSet,cfg){this.__bgShadow=null;this.__dialog=null;this.__isInitBgShadow=false;this.__tplConfig=tplConfig;this.__iconSet=iconSet;this.__dialogQueue=[];this.__zIndex=cfg&&cfg.zIndex||5e3;this.__cfg=cfg||{};this.__initDialogEvent()}.$define({alert:function(text,cfg){cfg=cfg||{};var dlg=this.__createMessageDialog(cfg.tplConfig||this.__tplConfig.alert,cfg);dlg.nodes.text&&(dlg.nodes.text.innerHTML=text||"");dlg.show(cfg.renderer||this.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});dlg.nodes.linkOk&&dlg.nodes.linkOk.style.display!=="none"&&dlg.nodes.linkOk.focus();return dlg},newAlert:function(text,cfg,name){cfg.tplConfig=this.__tplConfig.newAlert;this.alert(text,cfg,name)},confirm:function(text,cfg){cfg=cfg||{};var dlg=this.__createMessageDialog(cfg.tplConfig||this.__tplConfig.confirm,cfg),me=this;dlg.nodes.text&&(dlg.nodes.text.innerHTML=text||"");if(dlg.nodes.btnCancel){dlg.nodes.btnCancel.innerHTML=cfg.textCancel||"取消";Core.Events.addEvent(dlg.nodes.btnCancel,function(){cfg.funcCancel&&cfg.funcCancel.call(dlg);dlg.hidden(cfg.renderer||me.__cfg.renderer);Core.Events.stopEvent()},"click");dlg.nodes.linkCancel&&Core.Events.addEvent(dlg.nodes.linkCancel,function(){var e=Core.Events.getEvent();if(e.keyCode=="13"){cfg.funcCancel&&cfg.funcCancel.call(dlg);dlg.hidden(cfg.renderer||me.__cfg.renderer)}},"keydown")}dlg.show(cfg.renderer||me.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});if(cfg.defaultButton==0){dlg.nodes.linkCancel&&dlg.nodes.linkCancel.style.display!=="none"&&dlg.nodes.linkCancel.focus()}else{dlg.nodes.linkOk&&dlg.nodes.linkOk.style.display!=="none"&&dlg.nodes.linkOk.focus()}return dlg},newConfirm:function(text,cfg,name){cfg.tplConfig=this.__tplConfig.newConfirm;this.confirm(text,cfg,name)},create:function(cfg){var me=this;cfg=cfg||{};var dlg=new Ui.Dialog;dlg.setTemplate(cfg.tpl||this.__tplConfig.customs);cfg.content&&dlg.setContent(cfg.content);cfg.width&&!isNaN(cfg.width)&&dlg.setSize({width:cfg.width});cfg.height&&!isNaN(cfg.height)&&dlg.setSize({height:cfg.height});return this.__initDialog(dlg,cfg)},__initDialogEvent:function(){var queue=this.__dialogQueue;Core.Events.addEvent(document,function(){var e=Core.Events.getEvent();if(queue.length&&e.keyCode=="27"){queue[queue.length-1].hidden()}},"keydown")},__createMessageDialog:function(tpl,cfg){var dlg=new Ui.Dialog,me=this,i;dlg.setTemplate(tpl);cfg.width&&!isNaN(cfg.width)&&dlg.setSize({width:cfg.width});cfg.height&&!isNaN(cfg.height)&&dlg.setSize({height:cfg.height});dlg.nodes.subText&&(dlg.nodes.subText.innerHTML=cfg.subText||"");if(dlg.nodes.icon){dlg.nodes.icon.className=this.__iconSet[cfg.icon||"01"]["class"];dlg.nodes.icon.alt=this.__iconSet[cfg.icon||"01"]["alt"]}if(dlg.nodes.btnOk){dlg.nodes.btnOk.innerHTML=cfg.textOk||"确定";Core.Events.addEvent(dlg.nodes.btnOk,function(){dlg.hidden(cfg.renderer||me.__cfg.renderer);cfg.funcOk&&cfg.funcOk.call(dlg);Core.Events.stopEvent()},"click")}dlg.nodes.linkOk&&Core.Events.addEvent(dlg.nodes.linkOk,function(){var e=Core.Events.getEvent();if(e.keyCode=="13"){dlg.hidden(cfg.renderer||me.__cfg.renderer);cfg.funcOk&&cfg.funcOk.call(dlg)}},"keydown");dlg.setDragger(cfg.dragger||me.__cfg.dragger).setFixed(true).setAreaLocked(true);return this.__initDialog(dlg,cfg)},__initDialog:function(dlg,cfg){var me=this;cfg.zIndex&&(me.__zIndex=cfg.zIndex);dlg.nodes.titleName&&(dlg.nodes.titleName.innerHTML=cfg.title||"提示");if(dlg.nodes.btnClose){Core.Events.addEvent(dlg.nodes.btnClose,function(){var isCanHidden=true;cfg.funcBeforeClose&&(isCanHidden=cfg.funcBeforeClose.call(dlg)!==false);cfg.funcClose&&cfg.funcClose.call(dlg);isCanHidden&&dlg.hidden()},"click");Core.Events.addEvent(dlg.nodes.btnClose,function(){Core.Events.stopEvent()},"mousedown")}dlg.setPosition({z:cfg.zIndex||me.__zIndex});dlg.setRenderer(cfg.renderer||this.__cfg.renderer);dlg.setDragger(cfg.dragger||this.__cfg.dragger);dlg.setMiddle();dlg.addEventListener("beforeHidden",function(){me.__updateDialogQueue(this,"remove")});dlg.addEventListener("beforeShow",function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var that=this;if(!me.__isInitBgShadow){me.__initBGShadow(this,cfg.isAdamant||me.__cfg.isAdamant)}me.__setBGShadowOpacity(cfg.bgShadowOpacity!==0?cfg.bgShadowOpacity||.4:cfg.bgShadowOpacity);window.setTimeout(function(){me.__bgShadow.show();me.__updateDialogQueue(that,"add")},1)});dlg.setTitle=function(title){this.nodes.titleName&&(this.nodes.titleName.innerHTML=title)};dlg.setHelp=function(url){this.nodes.btnHelp&&(this.nodes.btnHelp.href=url)};dlg.close=function(){this.hidden()};dlg.getNodes=function(){return this.nodes};dlg.getX=function(){return this.x};dlg.getY=function(){return this.y};dlg.getWidth=function(){return this.width};dlg.getHeight=function(){return this.height};return dlg},__initBGShadow:function(dlg,isAdamant){var w=this.__getDocumentSize().width,h=this.__getDocumentSize().height,me=this;this.__bgShadow=new Ui.Panel;this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:w,height:h}).setAdamant(isAdamant).setFixed(true).setPosition({x:0,y:0,z:me.__zIndex});Core.Events.addEvent(window,function(){me.__bgShadow.setPosition({x:0,y:0}).setSize({width:me.__getDocumentSize().width,height:me.__getDocumentSize().height})},"resize");this.__isInitBgShadow=true},__updateDialogQueue:function(dialog,op){var i,dlg;if(op==="add"){this.__dialogQueue.push(dialog)}else if(op==="remove"){i=this.__dialogQueue.length;while(i--){this.__dialogQueue[i]===dialog&&this.__dialogQueue.splice(i,1)}}if(this.__dialogQueue.length===0){this.__bgShadow.hidden()}else{dlg=this.__dialogQueue[this.__dialogQueue.length-1];this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,dlg.nodes.panel);this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel);dlg.nodes.linkOk&&dlg.nodes.linkOk.style.display!=="none"&&dlg.nodes.linkOk.focus()}},__setBGShadowOpacity:function(v){v=isNaN(v)?0:Math.max(Math.min(v,1),0);Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",v)},__getDocumentSize:function(){var w=document.documentElement.clientWidth||document.body.clientWidth,h=document.documentElement.clientHeight||document.body.clientHeight;return{width:w,height:h}}});Ui.Transition={simple:function(t,b,c,d){return c*t/d+b},backEaseIn:function(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backEaseOut:function(t,b,c,d){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backEaseInOut:function(t,b,c,d){var s=1.70158;if((t/=d/2)<1){return c/2*(t*t*(((s*=1.525)+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},bounceEaseOut:function(t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}},bounceEaseIn:function(t,b,c,d){return c-Transition.bounceEaseOut(d-t,0,c,d)+b},bounceEaseInOut:function(t,b,c,d){if(t<d/2){return Transition.bounceEaseIn(t*2,0,c,d)*.5+b}else{return Transition.bounceEaseOut(t*2-d,0,c,d)*.5+c*.5+b}},regularEaseIn:function(t,b,c,d){return c*(t/=d)*t+b},regularEaseOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},regularEaseInOut:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return-c/2*(--t*(t-2)-1)+b},strongEaseIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},strongEaseOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},strongEaseInOut:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},elasticEaseIn:function(t,b,c,d){var a,p;if(t==0){return b}if((t/=d)==1){return b+c}p=d*.3;if(!a||a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},elasticEaseOut:function(t,b,c,d){var a,p;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*.3}if(!a||a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},elasticEaseInOut:function(t,b,c,d){var a,p;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){var p=d*(.3*1.5)}if(!a||a<Math.abs(c)){var a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}};Ui.TweenStrategy=function(startValue,endValue,duration,motion){this.startValue=startValue||0;this.endValue=endValue||0;this.duration=duration||0;this.motion=motion||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var me=this,t,sv=this.startValue,ev=this.endValue,d=this.duration,value,startTime=(new Date).getTime();this._itvID=window.setInterval(function(){t=((new Date).getTime()-startTime)/1e3;t>me.duration&&(t=me.duration);value=me.motion(t,sv,ev-sv,d);me.onTween&&me.onTween(value);me.__eventDispatcher.dispatchEvent("tween",value);t==me.duration&&me.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(value){},onEnd:function(){}});Ui.OpacityRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__node=null;this.__tween=new Ui.TweenStrategy(0,0,.6,Ui.Transition.strongEaseOut);this.__state="";this.__lastState="";this.__value=0;this.__node=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(state){this.__canShow=!!state},setCanHidden:function(state){this.__canHidden=!!state},show:function(node){var tn=this.__tween;tn.stop();Core.Dom.setStyle(node,"opacity",this.__value);node.style.display="";this.__node=node;this.__state="show";this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){tn.startValue=this.__value;tn.endValue=1;tn.start()}return this},hidden:function(node){var tn=this.__tween;tn.stop();this.__node=node;this.__state="hidden";this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){tn.startValue=this.__value;tn.endValue=0;tn.start()}return this},addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},__initTweenEvent:function(){var me=this;this.__tween.addEventListener("tween",function(v){me.__value=v;Core.Dom.setStyle(me.__node,"opacity",v)});this.__tween.addEventListener("end",function(){me.__node&&me.__node.style.filter&&(me.__node.style.filter="");if(me.__state!==""&&me.__state!==me.__lastState){me.__lastState=me.__state;me.__eventDispatcher.dispatchEvent(me.__state)}me.__state==="hidden"&&(me.__node.style.display="none")})}});Ui.BorderDragger=function(){this.__drag=null;this.__isBindEvent=false;this.__border=null;this.__dragNode=null;this.__isCreated=false;this.__tweenX=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut);this.__tweenY=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut);this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(type,handle)}else{this.__drag.addEventListener(type,handle)}return this},removeEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(type,handle)}else{this.__drag.removeEventListener(type,handle)}return this},setDrag:function(node,attachNode,isDragCapureNode){if(!this.__isCreated){this.__createBorder(attachNode);this.__initTweenEvent(attachNode)}this.__drag=new Ui.Drag(node,this.__border,isDragCapureNode);this.__dragNode=attachNode;this.__initDragEvent();return this},setLock:function(state){this.__drag.isLock=!!state;return this},setArea:function(area){this.__drag.lockArea=area;return this},destroy:function(){this.__drag.destroy()},__createBorder:function(node){this.__border=$C("div");var st=this.__border.style;st.border="2px dashed #BCC4D0";st.position="absolute";st.display="none";st.backgroundColor="transparent";st.MozUserSelect="none";document.body.appendChild(this.__border);this.__isCreated=true},__initDragEvent:function(){if(this.__isBindEvent){return}var me=this,bst=this.__border.style,nst=this.__dragNode.style,twX=this.__tweenX,twY=this.__tweenY;this.__drag.addEventListener("beforeDrag",function(){bst.zIndex=nst.zIndex+1;bst.position=nst.position;bst.width=me.__dragNode.offsetWidth-4+"px";bst.height=me.__dragNode.offsetHeight-4+"px";bst.left=parseInt(nst.left)+"px";bst.top=parseInt(nst.top)+"px";bst.display=""});this.__drag.addEventListener("afterDrag",function(){if($IE6){nst.left=parseInt(bst.left)+"px";nst.top=parseInt(bst.top)+"px";bst.display="none";me.__eventDispatcher.dispatchEvent("afterDrag")}else{twX.startValue=parseInt(nst.left);twX.endValue=parseInt(bst.left);twY.startValue=parseInt(nst.top);twY.endValue=parseInt(bst.top);twX.start();twY.start()}});this.__isBindEvent=true},__initTweenEvent:function(node){var nst=node.style,bst=this.__border.style,me=this;this.__tweenX.addEventListener("tween",function(v){nst.left=v+"px"});this.__tweenY.addEventListener("tween",function(v){nst.top=v+"px"});this.__tweenX.addEventListener("end",function(){bst.display="none";me.__eventDispatcher.dispatchEvent("afterDrag")})}});var winDialog={};var DialogTemplate={};(function(){var dialogTemplates={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")};var iconSet={"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}};var dialogs={};var moduleDialog=new Ui.ModuleDialog(dialogTemplates,iconSet,{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(args,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.create(args);return dialogs[name]}else{return moduleDialog.create(args)}};winDialog.alert=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.alert(text,cfg);return dialogs[name]}else{return moduleDialog.alert(text,cfg)}};winDialog.newAlert=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.newAlert(text,cfg);return dialogs[name]}else{return moduleDialog.newAlert(text,cfg)}};winDialog.confirm=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.confirm(text,cfg);return dialogs[name]}else{return moduleDialog.confirm(text,cfg)}};winDialog.newConfirm=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.newConfirm(text,cfg);return dialogs[name]}else{return moduleDialog.newConfirm(text,cfg)}};winDialog.getDialog=function(name){if(name&&typeof name==="string"){return dialogs[name]}};DialogTemplate=dialogTemplates})();Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Core.String");Utils.Url=function(url){url=url||"";this.url=url;this.query={};this.parse()};Utils.Url.prototype={parse:function(url){if(url){this.url=url}this.parseAnchor();this.parseParam()},parseAnchor:function(){var anchor=this.url.match(/\#(.*)/);anchor=anchor?anchor[1]:null;this._anchor=anchor;if(anchor!=null){this.anchor=this.getNameValuePair(anchor);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var query=this.url.match(/\?([^\?]*)/);query=query?query[1]:null;if(query!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(query)}},getNameValuePair:function(str){var o={};str.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(w,n,v){if(n==""){return}o[n]=v||""});return o},getParam:function(sPara){return this.query[sPara]||""},clearParam:function(){this.query={}},setParam:function(name,value){if(name==null||name==""||typeof name!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[name]=value},setParams:function(o){this.query=o},serialize:function(o){var ar=[];for(var i in o){if(o[i]==null||o[i]==""){ar.push(i+"=")}else{ar.push(i+"="+o[i])}}return ar.join("&")},toString:function(){var queryStr=this.serialize(this.query);return this.url+(queryStr.length>0?"?"+queryStr:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(forceSharp){return this.anchor?"#"+this.serialize(this.anchor):forceSharp?"#":""}};Core.String.j2o=function(str){if(!str||str==""){return null}try{var o=window.eval("("+str+")");return o}catch(e){trace("j2o : 数据分析出错");traceError(e);return null}};Sina.pkg("Utils.Io");Sina.pkg("Core.System");(function(){var parseParam=function(oSource,oParams){var key;try{if(typeof oParams!="undefined"){for(key in oSource){if(oParams[key]!=null){oSource[key]=oParams[key]}}}}finally{key=null;return oSource}};Core.System.parseParam=parseParam})();Core.String.encodeDoubleByte=function(str){if(typeof str!="string"){return str}return encodeURIComponent(str)};Utils.Io.JsLoad={};(function(){function createScripts(oOpts,oCFG){processUrl(oOpts,oCFG);var urls=oOpts.urls;var i,len=urls.length;for(i=0;i<len;i++){var js=$C("script");js.src=urls[i].url;js.charset=urls[i].charset;js.onload=js.onerror=js.onreadystatechange=function(){if(js&&js.readyState&&js.readyState!="loaded"&&js.readyState!="complete"){return}oCFG.script_loaded_num++;js.onload=js.onreadystatechange=js.onerror=null;if(!1!==oOpts.isRemove){js.src="";js.parentNode.removeChild(js)}js=null};document.getElementsByTagName("head")[0].appendChild(js)}}function processUrl(oOpts,oCFG){var urls=oOpts.urls;var get_hash=oOpts.GET;var i,len=urls.length;var key,url_cls,varname,rnd;for(i=0;i<len;i++){rnd=window.parseInt(Math.random()*1e8);url_cls=new Utils.Url(urls[i].url);for(key in get_hash){if(oOpts.noencode==true){url_cls.setParam(key,get_hash[key])}else{url_cls.setParam(key,Core.String.encodeDoubleByte(get_hash[key]))}}varname=url_cls.getParam("varname")||"requestId_"+rnd;if(oOpts.noreturn!=true){url_cls.setParam("varname",varname)}if(oOpts.returnType=="jsonp"){var name=url_cls.getParam("callback")||"callback_"+rnd;var callback="script_callbackes."+name;url_cls.setParam("callback",callback);if(!window.script_callbackes){window.script_callbackes=[]}window.script_callbackes[name]=function(res){oCFG.is_loadcomplete=true;delete window.script_callbackes[name];if(oCFG.timeout_flag!=null){clearTimeout(oCFG.timeout_flag)}if(oCFG.is_timeout){return}if(oOpts.onComplete!=null){oOpts.onComplete(res)}}}oCFG.script_var_arr.push(varname);urls[i].url=url_cls.toString();urls[i].charset=urls[i].charset||oOpts.charset}}function ancestor(aUrls,oOpts){var _opts={isRemove:!0,urls:[],charset:"utf-8",noreturn:false,noencode:false,returnType:"",timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var _cfg={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[],timeout_flag:null};_opts.urls=typeof aUrls=="string"?[{url:aUrls}]:aUrls;Core.System.parseParam(_opts,oOpts);createScripts(_opts,_cfg);if(_opts.returnType!="jsonp"){(function(){if(_opts.noreturn==true&&_opts.onComplete==null){return}var i,data=[];if(_cfg.script_loaded_num==_opts.urls.length){_cfg.is_loadcomplete=true;if(_opts.onComplete!=null){for(i=0;i<_cfg.script_var_arr.length;i++){data.push(window[_cfg.script_var_arr[i]])}if(_cfg.script_var_arr.length<2){_opts.onComplete(data[0])}else{_opts.onComplete(data)}}return}if(_cfg.is_timeout==true){return}setTimeout(arguments.callee,50)})()}if(_opts.timeout>0){_cfg.timeout_flag=setTimeout(function(){if(_cfg.is_loadcomplete!=true){if(_opts.onException!=null){_opts.onException()}_cfg.is_timeout=true}},_opts.timeout)}}Utils.Io.JsLoad.request=function(aUrls,oOpts){new ancestor(aUrls,oOpts)}})();Core.Dom.getElementsByClass=function(el,tg,clz){el=el||document;var rs=[];clz=" "+clz+" ";var cldr=el.getElementsByTagName(tg),len=cldr.length;for(var i=0;i<len;++i){var o=cldr[i];if(o.nodeType==1){var ecl=" "+o.className+" ";if(ecl.indexOf(clz)!=-1){rs[rs.length]=o}}}return rs};Core.Dom.byClz=Core.Dom.getElementsByClass;Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(this.loadFrames!=null){return false}var rndId1="loadingIframe_thread"+Math.ceil(Math.random()*1e4);var rndId2="loadingIframe_thread"+Math.ceil((Math.random()+1)*1e4);this.loadFrames=[rndId1,rndId2];var html='<iframe id="'+rndId1+'" name="'+rndId1+'" class="invisible"\r\n	              scrolling="no" src=""\r\n	              allowTransparency="true" style="display:none;" frameborder="0"\r\n	              ></iframe>\r\n				  <iframe id="'+rndId2+'" name="'+rndId2+'" class="invisible"\r\n	              scrolling="no" src=""\r\n	              allowTransparency="true" style="display:none;" frameborder="0"\r\n	              ></iframe>';var oIjaxIframeCnt=$C("div");oIjaxIframeCnt.id="ijax_iframes";oIjaxIframeCnt.innerHTML=html;trace("创建 Ijax 需要的 iframe");document.body.appendChild(oIjaxIframeCnt);var loadTimer=setInterval(Core.Function.bind2(function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(loadTimer);loadTimer=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}},this),10)},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var oLoadCnt in this.loadingIframe){if(this.loadingIframe[oLoadCnt].isBusy==false){this.loadingIframe[oLoadCnt].isBusy=true;return this.loadingIframe[oLoadCnt]}}return false},request:function(url,option){var oTask={};oTask.url=url;oTask.option=option||{};this.arrTaskLists.push(oTask);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var loadStatus=this.isIjaxReady();if(loadStatus==false){return false}var newData=this.arrTaskLists[0];this.loadData(newData.url,newData.option,loadStatus);this.arrTaskLists.shift()},loadData:function(url,option,loader){var _url=new Utils.Url(url);if(option.GET){for(var key in option.GET){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}if(!/\bdomain\b/.test(url)){_url.setParam("domain","1")}_url=_url.toString();var ifm=loader.container;ifm.listener=Core.Function.bind2(function(){try{var iframeObject=ifm.contentWindow.document,sResult;var tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];if(typeof tArea!="undefined"){sResult=tArea.value}else{sResult=iframeObject.body.innerHTML}if(option.onComplete){option.onComplete(sResult)}else{option.onException()}}catch(e){traceError(e);if(option.onException){option.onException(e.message,_url.toString())}}loader.isBusy=false;Core.Events.removeEvent(ifm,ifm.listener,"load");this.loadByList()},this);Core.Events.addEvent(ifm,ifm.listener,"load");if(option.POST){var oIjaxForm=$C("form");oIjaxForm.id="IjaxForm";oIjaxForm.action=_url;oIjaxForm.method="post";oIjaxForm.target=ifm.id;for(var oItem in option.POST){var value;if(option.noEncode){value=Core.String.encodeDoubleByte(option.POST[oItem])}else{value=option.POST[oItem]}var oInput=$C("input");oInput.type="hidden";oInput.name=oItem;oInput.value=value;oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);oIjaxForm.submit()}else{try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}}};Utils.Io.Ajax={createRequest:function(){var request=null;try{request=new XMLHttpRequest}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(othermicrosoft){try{request=ActiveXObject("Microsoft.XMLHTTP")}catch(failed){}}}if(request==null){}else{return request}},request:function(url,option){option=option||{};option.onComplete=option.onComplete||function(){};option.onException=option.onException||function(){};option.returnType=option.returnType||"txt";option.method=option.method||"get";option.data=option.data||{};if(typeof option.GET!="undefined"&&typeof option.GET.url_random!="undefined"&&option.GET.url_random==0){this.rand=false;option.GET.url_random=null}return this.loadData(url,option)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE){response=request.responseXML}else{var Dparser=new DOMParser;response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response);

}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}return request}};Sina.pkg("Core.Class");Core.Class.AsPrototype={};Core.Class.create=function(){return function(t){if(t!=Core.Class.AsPrototype){this.initialize.apply(this,arguments)}}};if($IE6&&typeof Utils.Io.Ijax!="undefined"){Utils.Io.Ijax.loadData=function(url,option,loader){var _url=new Utils.Url(url);if(option.GET){for(var key in option.GET){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}if(!/\bdomain\b/.test(url)){_url.setParam("domain","1")}_url=_url.toString();var ifm=loader.container;ifm.listener=Core.Function.bind2(function(){try{var iframeObject=ifm.contentWindow.document,sResult;var tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];if(typeof tArea!="undefined"){sResult=tArea.value}else{sResult=iframeObject.body.innerHTML}if(option.onComplete){option.onComplete(sResult)}else{option.onException()}}catch(e){traceError(e);if(option.onException){option.onException(e.message,_url.toString())}}loader.isBusy=false;Core.Events.removeEvent(ifm,ifm.listener,"load");this.loadByList()},this);Core.Events.addEvent(ifm,ifm.listener,"load");if(option.POST){var oIjaxForm=$C("form");oIjaxForm.id="IjaxForm";oIjaxForm.action=_url;oIjaxForm.method="post";oIjaxForm.target=ifm.id;for(var oItem in option.POST){var value;if(option.noEncode){value=Core.String.encodeDoubleByte(option.POST[oItem])}else{value=option.POST[oItem]}var oInput=$C("input");oInput.type="hidden";oInput.name=oItem;oInput.value=value;oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);var timenum=100;function innerfun(){if(timenum>0){try{oIjaxForm.submit()}catch(e){setTimeout(innerfun,10)}}timenum--}innerfun()}else{try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}}}var Interface=function(url,type){this.url=new Utils.Url(url);this.type=type.toLowerCase()};Interface.prototype={url:null,type:"",request:function(option){var err=option.onError;var suc=option.onSuccess;option.onComplete=option.onSuccess=function(result){try{if(typeof result=="string"){result=result.replace(/;$/,"")}result=typeof result=="string"&&/\s*{/.test(result)?Core.String.j2o(result):result;if(result!=null&&typeof result.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(result!=null){if(result.code=="A00006"){suc(result.data)}else{err(result)}}else{err(result)}}catch(e){traceError(e)}}.bind2(this);option.onException=option.onError=option.onFail||function(){trace("接口失败："+this.url,"#F00");if(arguments.length>0){for(var i=0,len=arguments.length;i<len;i++){if(arguments[i]&&typeof arguments[i]!="undefined"){trace("错误信息："+arguments[i].toString())}}}}.bind2(this);var requestURL=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(requestURL,option);break;case"ajax":Utils.Io.Ajax.request(requestURL,option);break;case"script":case"jsload":Utils.Io.JsLoad.request(requestURL,option);break;default:throw new Error("未指定有效的数据传输类型")}}};if(typeof Lib=="undefined"){Lib={}}Lib.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Lib;for(var i=levels[0]=="Lib"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};Lib.pkg("Login");Lib.Login.LoginPost=Core.Class.create();Lib.Login.LoginPost.prototype={url:"http://i.sso.sina.com.cn/js/ssologin.js",callback:null,initialize:function(callback,clearDomain,from){window.sinaSSOConfig=new function(){if(from){this.from=from}this.pageCharset="utf-8";this.noActiveTime=14400;this.setDomain=true;this.entry="boke";this.customInit=function(){};this.customLoginCallBack=callback;this.customLogoutCallBack=function(result){};this.useIframe=true}},login:function(username,password,time){var _this=this;if(typeof sinaSSOController=="undefined"||!sinaSSOController){trace("no sso");Utils.Io.JsLoad.request(this.url,{onComplete:function(){__login()},onException:function(){},timeout:3e4,isRemove:false})}else{trace("has sso");sinaSSOController.init();if(typeof sinaSSOController.setLoginType=="function"){sinaSSOController.setLoginType(2)}if(typeof sinaSSOController.getServerTime=="function"){}trace("init ok");__login()}function __login(){if(typeof time=="undefined"){sinaSSOController.login(username,password)}else{sinaSSOController.login(username,password,time)}}},parse:function(loginStatus){this.callback.call(loginStatus)}};Core.System.getScrollPos=function(oDocument){oDocument=oDocument||document;var dd=oDocument.documentElement;var db=oDocument.body;return[Math.max(dd.scrollTop,db.scrollTop),Math.max(dd.scrollLeft,db.scrollLeft),Math.max(dd.scrollWidth,db.scrollWidth),Math.max(dd.scrollHeight,db.scrollHeight)]};Core.Dom.getStyle=function(el,property){switch(property){case"opacity":var val=100;try{val=el.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(e){try{val=el.filters("alpha").opacity}catch(e){}}return val/100;case"float":property="styleFloat";default:var value=el.currentStyle?el.currentStyle[property]:null;return el.style[property]||value}};if(!$IE||$IE>8){Core.Dom.getStyle=function(el,property){if(property=="float"){property="cssFloat"}try{var computed=document.defaultView.getComputedStyle(el,"")}catch(e){traceError(e)}return el.style[property]||computed?computed[property]:null}}Core.Dom.getXY=function(el){if((el.parentNode==null||el.offsetParent==null||Core.Dom.getStyle(el,"display")=="none")&&el!=document.body){return false}var parentNode=null;var pos=[];var box;var doc=el.ownerDocument;box=el.getBoundingClientRect();var scrollPos=Core.System.getScrollPos(el.ownerDocument);return[box.left+scrollPos[1],box.top+scrollPos[0]];parentNode=el.parentNode;while(parentNode.tagName&&!/^body|html$/i.test(parentNode.tagName)){if(Core.Dom.getStyle(parentNode,"display").search(/^inline|table-row.*$/i)){pos[0]-=parentNode.scrollLeft;pos[1]-=parentNode.scrollTop}parentNode=parentNode.parentNode}return pos};if(!$IE){Core.Dom.getXY=function(el){if((el.parentNode==null||el.offsetParent==null||Core.Dom.getStyle(el,"display")=="none")&&el!=document.body){return false}var parentNode=null;var pos=[];var box;var doc=el.ownerDocument;pos=[el.offsetLeft,el.offsetTop];parentNode=el.offsetParent;var hasAbs=Core.Dom.getStyle(el,"position")=="absolute";if(parentNode!=el){while(parentNode){pos[0]+=parentNode.offsetLeft;pos[1]+=parentNode.offsetTop;if($SAFARI&&!hasAbs&&Core.Dom.getStyle(parentNode,"position")=="absolute"){hasAbs=true}parentNode=parentNode.offsetParent}}if($SAFARI&&hasAbs){pos[0]-=el.ownerDocument.body.offsetLeft;pos[1]-=el.ownerDocument.body.offsetTop}parentNode=el.parentNode;while(parentNode.tagName&&!/^body|html$/i.test(parentNode.tagName)){if(Core.Dom.getStyle(parentNode,"display").search(/^inline|table-row.*$/i)){pos[0]-=parentNode.scrollLeft;pos[1]-=parentNode.scrollTop}parentNode=parentNode.parentNode}return pos}}(function(){var _inputNode;var _rndID=parseInt(Math.random()*100);var _showMenuItems=[];var _selectMenuIndex=-1;var _selectMenuText="";var _css="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}\r\n				#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;\r\n				border: 1px solid #CCCCCC;background: #ffffff;text-align:left;}\r\n				#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;\r\n				line-height: 20px;cursor: pointer;color: #999999;}\r\n				#sinaNote li.note {text-align: left;color: #999999;}";var _viewWindow=window;var passcardOBJ={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":true,"sina.cn":true,"vip.sina.com":true,"qq.com":true,"163.com":true,"126.com":true,"hotmail.com":true,"yahoo.com.cn":true,"gmail.com":true}};passcardOBJ.createNode=function(){var d=_viewWindow.document;var div=d.createElement("div");div.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var obj=d.createElement("style");obj.setAttribute("type","text/css");try{if($IE){obj.styleSheet.cssText=_css}else{obj.innerHTML=_css}}catch(e){trace(e.message)}var total=d.createElement("div");total.appendChild(div);total.appendChild(obj);d.body.appendChild(total)};passcardOBJ.arrowKey=function(keyCodeNum){if(keyCodeNum==38){if(_selectMenuIndex<=0){_selectMenuIndex=_showMenuItems.length}_selectMenuIndex--;passcardOBJ.selectLi(_selectMenuIndex)}if(keyCodeNum==40){if(_selectMenuIndex>=_showMenuItems.length-1){_selectMenuIndex=-1}_selectMenuIndex++;passcardOBJ.selectLi(_selectMenuIndex)}};passcardOBJ.showList=function(e){_selectMenuText="";var keyCodeNum=Core.Events.getEvent().keyCode;if(keyCodeNum==38||keyCodeNum==40){passcardOBJ.arrowKey(keyCodeNum);return false}if(!$E("sinaNote")){passcardOBJ.createNode()}var username=$E(e).value;var menuList={};var atIndex=username.indexOf("@");var InputCase="";var InputStr="";if(atIndex>-1){InputCase=username.substr(atIndex+1);InputStr=username.substr(0,atIndex)}_showMenuItems=[];_selectMenuIndex=0;_showMenuItems[_showMenuItems.length]="sinaNote_MenuItem_Title_"+_rndID;for(var key in this.menuStatus){this.menuStatus[key]=true;if(InputCase!=""&&InputCase!=key.substr(0,InputCase.length)){this.menuStatus[key]=false}else{_showMenuItems[_showMenuItems.length]="sinaNote_MenuItem_"+key+"_"+_rndID}}var listcontent='<li class="note">请选择登录类型</li>';listcontent+='<li id="sinaNote_MenuItem_Title_'+_rndID+'">'+username+"</li>";var itemLabel;for(var mykey in this.menuStatus){if(this.menuStatus[mykey]==true){if(InputStr==""){itemLabel=username+"@"+mykey}else{itemLabel=InputStr+"@"+mykey}listcontent+='<li id="sinaNote_MenuItem_'+mykey+"_"+_rndID+'" title="'+itemLabel+'">'+itemLabel+"</li>"}}$E("sinaNote").innerHTML=listcontent;for(var i=0;i<username.length;i++){if(username.charCodeAt(i)<160){$E("sinaNote").style.display="";this.selectList(e)}else{this.hideList()}}var el=$E(e);var note=$E("sinaNote");var frameLeft=0;var frameTop=0;var framePos;if(_viewWindow!=window){framePos=Core.Dom.getXY(window.frameElement);frameLeft=framePos[0];frameTop=framePos[1]}var inputWidth=el.offsetWidth;if(inputWidth<200){inputWidth=200}note.style.width=inputWidth-2+"px";var inputXY=Core.Dom.getXY(el);note.style.left=inputXY[0]-($IE?2:-1)+frameLeft+"px";note.style.top=inputXY[1]+el.offsetHeight-($IE?2:-1)+frameTop+"px"};passcardOBJ.selectList=function(e){var unames=$E("sinaNote").getElementsByTagName("li");for(var i=1;i<unames.length;i++){unames[1].style.backgroundColor=passcardOBJ.overbgcolor;unames[1].style.color=passcardOBJ.outfcolor;unames[i].onmousedown=function(){var temp=this.innerHTML;if(temp.indexOf("非新浪邮箱")>-1){var pos=temp.split("@");$E(e).value=pos[0]}else{$E(e).value=this.innerHTML}if(Core.Events.getEvent()!=null){Core.Events.stopEvent()}};unames[i].onmouseover=function(){if(i!=1){unames[1].style.backgroundColor=passcardOBJ.outbgcolor;unames[1].style.color=passcardOBJ.overfcolor}this.style.backgroundColor=passcardOBJ.overbgcolor;this.style.color=passcardOBJ.outfcolor};unames[i].onmouseout=function(){this.style.backgroundColor=passcardOBJ.outbgcolor;this.style.color=passcardOBJ.overfcolor;unames[1].style.backgroundColor=passcardOBJ.overbgcolor;unames[1].style.color=passcardOBJ.outfcolor}}};passcardOBJ.selectLi=function(nIndex){var menuNode;$E("sinaNote_MenuItem_Title_"+_rndID).style.backgroundColor=passcardOBJ.outbgcolor;$E("sinaNote_MenuItem_Title_"+_rndID).style.color=passcardOBJ.overfcolor;for(var i=0;i<_showMenuItems.length;i++){menuNode=$E(_showMenuItems[i]);menuNode.style.backgroundColor=passcardOBJ.outbgcolor;menuNode.style.color=passcardOBJ.overfcolor}$E(_showMenuItems[nIndex]).style.backgroundColor=passcardOBJ.overbgcolor;$E(_showMenuItems[nIndex]).style.color=passcardOBJ.outfcolor;_selectMenuText=$E(_showMenuItems[nIndex]).innerHTML};passcardOBJ.hideList=function(){if(!$E("sinaNote")){passcardOBJ.createNode()}$E("sinaNote").style.display="none"};passcardOBJ.init=function(oNode,oColors,oFocusNode,oWindowTarget){oWindowTarget=oWindowTarget||window;if(oWindowTarget.document.body==null){setTimeout(Core.Function.bind3(function(){this.init(oNode,oColors,oFocusNode,oWindowTarget)},this),100)}for(var key in oColors){this[key]=oColors[key]}Core.Events.addEvent(document,passcardOBJ.hideList,"click");Core.Events.addEvent(oNode,passcardOBJ.hideList,"blur");Core.Events.addEvent(oNode,Core.Function.bind3(passcardOBJ.showList,this,[oNode]),"keyup");Core.Events.addEvent(oNode,function(e){var keyCodeNum=Core.Events.getEvent().keyCode;var isSinaMail;if(keyCodeNum==13||keyCodeNum==9){if(_selectMenuText!=""){var temp=_selectMenuText;if(temp.indexOf("非新浪邮箱")>-1){var pos=temp.split("@");oNode.value=pos[0]+"@";isSinaMail=false}else{oNode.value=_selectMenuText;isSinaMail=true}}if(isSinaMail){if(oFocusNode!=null){setTimeout(function(){oFocusNode.focus()},0)}}else{if(oNode){oNode.focus()}}}},"keydown");if(oWindowTarget){_viewWindow=oWindowTarget}};Lib.passcardOBJ=passcardOBJ})();Sina.pkg("Utils.Cookie");Utils.Cookie.getCookie=function(name){name=name.replace(/([\.\[\]\$])/g,"\\$1");var rep=new RegExp(name+"=([^;]*)?;","i");var co=document.cookie+";";var res=co.match(rep);if(res){return res[1]||""}else{return""}};Core.System.keyValue=function(string,key){var arr=string.match(new RegExp("(\\?|&)"+key+"=([^&]*)(&|$)"));if(arr!=null)return arr[2];return null};Lib.checkAuthor=function(){var AuthorInfo=unescape(Utils.Cookie.getCookie("SUP"));if(AuthorInfo&&AuthorInfo!=""){$UID=Core.System.keyValue(AuthorInfo,"uid");$nick=decodeURIComponent(Core.System.keyValue(AuthorInfo,"nick"));$isLogin=!!$UID;if(typeof scope.$uid=="undefined"){$isAdmin=false}else{$isAdmin=scope.$uid==$UID}}else{AuthorInfo=Utils.Cookie.getCookie("SU");if(AuthorInfo&&AuthorInfo!=""){var match=AuthorInfo.match(/^([^:]*:){2}(\d{5,11})/);$UID=match&&match[2]||null;window.$isLogin=!!$UID;if(typeof scope.$uid=="undefined"){window.$isAdmin=false}else{window.$isAdmin=scope.$uid==$UID}}else{$UID=null;$isLogin=false;$isAdmin=false}}};Core.Dom.insertAfter=function(newElement,targetElement){var parent=targetElement.parentNode;if(parent.lastChild==targetElement){parent.appendChild(newElement)}else{parent.insertBefore(newElement,targetElement.nextSibling)}return newElement};Core.Events.fireEvent=function(oElement,sEvent){var evt;oElement=$E(oElement);if(oElement.fireEvent){oElement.fireEvent("on"+sEvent)}else{if($MOBILE){evt=document.createEvent("HTMLEvents")}else{evt=document.createEvent("MouseEvents")}evt.initEvent(sEvent,true,true);oElement.dispatchEvent(evt)}};Core.String.trimHead=function(str){return str.replace(/^(\u3000|\s|\t)*/gi,"")};Core.String.trimTail=function(str){return str.replace(/(\u3000|\s|\t)*$/gi,"")};Core.String.trim=function(str){return Core.String.trimHead(Core.String.trimTail(str))};Utils.Cookie.setCookie=function(name,value,expire,path,domain,secure){var cstr=[];cstr.push(name+"="+escape(value));if(expire){var dd=new Date;var expires=dd.getTime()+expire*36e5;dd.setTime(expires);cstr.push("expires="+dd.toGMTString())}if(path){cstr.push("path="+path)}if(domain){cstr.push("domain="+domain)}if(secure){cstr.push(secure)}document.cookie=cstr.join(";")};Utils.Io.JsLoad_2={};(function(){function createScripts(oOpts,oCFG){processUrl(oOpts,oCFG);var urls=oOpts.urls;var i;var len=urls.length;var js;for(i=0;i<len;i++){js=$C("script");js.src=urls[i].url;js.charset=urls[i].charset;js.onload=js.onerror=js.onreadystatechange=function(){if(js&&js.readyState&&js.readyState!="loaded"&&js.readyState!="complete"){return}oCFG.script_loaded_num++;js.onload=js.onreadystatechange=js.onerror=null;js.src="";js.parentNode.removeChild(js);js=null};document.getElementsByTagName("head")[0].appendChild(js)}return js}function processUrl(oOpts,oCFG){var urls=oOpts.urls;var get_hash=oOpts.GET;var i,len=urls.length;var key,url_cls,varname,rnd;for(i=0;i<len;i++){rnd=window.parseInt(Math.random()*1e8);url_cls=new Utils.Url(urls[i].url);for(key in get_hash){if(oOpts.noencode==true){url_cls.setParam(key,get_hash[key])}else{url_cls.setParam(key,Core.String.encodeDoubleByte(get_hash[key]))}}varname=url_cls.getParam("varname")||"requestId_"+rnd;if(oOpts.noreturn!=true){url_cls.setParam("varname",varname)}oCFG.script_var_arr.push(varname);urls[i].url=url_cls.toString();urls[i].charset=urls[i].charset||oOpts.charset}}function ancestor(aUrls,oOpts){var _opts={urls:[],charset:"utf-8",noreturn:false,noencode:false,timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var _cfg={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};var timer=0;_opts.urls=typeof aUrls=="string"?[{url:aUrls}]:aUrls;Core.System.parseParam(_opts,oOpts);var scriptNode=createScripts(_opts,_cfg);(function(){if(_opts.noreturn==true&&_opts.onComplete==null){return}var i;var data=[];if(_cfg.script_loaded_num==_opts.urls.length){_cfg.is_loadcomplete=true;if(_opts.onComplete!=null){clearTimeout(timer);try{for(i=0;i<_cfg.script_var_arr.length;i++){data.push(window[_cfg.script_var_arr[i]])}if(_cfg.script_var_arr.length<2){_opts.onComplete(data[0])}else{_opts.onComplete(data)}}catch(e){trace("jsload: "+e);if(_opts.onException){_opts.onException(e)}}}return}if(_cfg.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(_opts.timeout>0){timer=setTimeout(function(){if(_cfg.is_loadcomplete!=true){if(_opts.onException!=null){_opts.onException("timeout");scriptNode.src="http://simg.sinajs.cn/blog7style/images/common/loading.gif?t="+(new Date).getTime()}_cfg.is_timeout=true}},_opts.timeout)}}Utils.Io.JsLoad_2.request=function(aUrls,oOpts){new ancestor(aUrls,oOpts)}})();Utils.Io.Ijax_2={arrTaskLists:[],loadFrames:null,loadingIframe:null,request:function(url,option){var oTask={};oTask.url=url;oTask.option=option||{};this.arrTaskLists.push(oTask);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},createLoadingIframe:function(){if(this.loadFrames!=null){return false}var rndId1="loadingIframe_thread"+Math.ceil(Math.random()*1e4);var rndId2="loadingIframe_thread"+Math.ceil((Math.random()+1)*1e4);this.loadFrames=[rndId1,rndId2];var html='<iframe id="'+rndId1+'" name="'+rndId1+'" class="invisible"\r\n	              scrolling="no" src=""\r\n	              allowTransparency="true" style="display:none;" frameborder="0"\r\n	              ></iframe>\r\n				  <iframe id="'+rndId2+'" name="'+rndId2+'" class="invisible"\r\n	              scrolling="no" src=""\r\n	              allowTransparency="true" style="display:none;" frameborder="0"\r\n	              ></iframe>';var oIjaxIframeCnt=$C("div");oIjaxIframeCnt.id="ijax_iframes";oIjaxIframeCnt.innerHTML=html;document.body.appendChild(oIjaxIframeCnt);var loadTimer=setInterval(Core.Function.bind2(function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(loadTimer);loadTimer=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}},this),10)},loadByList:function(){if(this.arrTaskLists.length==0){return false}var loadStatus=this.isIjaxReady();if(loadStatus==false){return false}var newTask=this.arrTaskLists[0];this.loadData(newTask.url,newTask.option,loadStatus);this.arrTaskLists.shift()},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var oLoadCnt in this.loadingIframe){if(this.loadingIframe[oLoadCnt].isBusy==false){this.loadingIframe[oLoadCnt].isBusy=true;return this.loadingIframe[oLoadCnt]}}return false},loadData:function(url,option,loader){var _url=new Utils.Url(url);var timer=0;option.isTimeout=false;if(option.GET){for(var key in option.GET){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}_url.setParam("domain","1");_url=_url.toString();var ifm=loader.container;ifm.listener=Core.Function.bind2(function(){try{var iframeObject=ifm.contentWindow.document;var sResult;var tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];if(typeof tArea!="undefined"){sResult=tArea.value}else{sResult=iframeObject.body.innerHTML}if(typeof sResult=="string"){sResult=sResult.replace(/;$/,"")}sResult=typeof sResult=="string"&&/\s*{/.test(sResult)?Core.String.j2o(sResult):sResult;if(sResult!=null&&typeof sResult.code=="undefined"){return}if(option.onComplete&&!option.isTimeout){clearTimeout(timer);option.onComplete(sResult)}}catch(e){if(option.onException&&!option.isTimeout){clearTimeout(timer);option.onException(e.message,_url.toString())}}loader.isBusy=false;Core.Events.removeEvent(ifm,ifm.listener,"load");this.loadByList()},this);Core.Events.addEvent(ifm,ifm.listener,"load");if(option.POST){var oIjaxForm=$C("form");oIjaxForm.id="IjaxForm";oIjaxForm.action=_url;oIjaxForm.method="post";oIjaxForm.target=ifm.id;for(var oItem in option.POST){var value;if(option.noEncode){value=Core.String.encodeDoubleByte(option.POST[oItem])}else{value=option.POST[oItem]}var oInput=$C("input");oInput.type="hidden";oInput.name=oItem;oInput.value=value;oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);oIjaxForm.submit()}else{try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}if(option.timeout>0){timer=setTimeout(function(){option.isTimeout=true;if(option.onException){option.onException("timeout");ifm.src="http://simg.sinajs.cn/blog7style/images/common/loading.gif?t="+(new Date).getTime()}},option.timeout)}}};$registJob("msnLogin",function(){window.focus();if(!$IE){window.blur()}var TO_UNLOGIN=0;var TO_IS_LOGIN=1;var TO_MSN_NO_OCCUPY=2;var TO_MSN_OCCUPY=3;var TO_OCCUPY_BUT_AUTO_FAIL=4;var TIMEOUT_VAL=15e3;function createNode(txt){var _box=$C("div");var _node;_box.innerHTML=txt;_node=_box.childNodes[0];return _node}function Loading(relNode){var layer=createNode('<span class="move_cheking" style="display:none"><img src="http://simg.sinajs.cn/blog7style/images/common/loading.gif"> 加载中…</span>');Core.Dom.insertAfter(layer,relNode||document.body);return{afterBy:function(relNode){Core.Dom.insertAfter(layer,relNode||document.body)},hide:function(){layer.style.display="none"},show:function(){layer.style.display=""}}}var unLogin={name:"unLogin",isInited:false,inProgress:false,isBlogMoved:undefined,loginObj:null,loading:null,layer:$E("sina_unlogin"),loginName:$E("loginName"),loginPass:$E("loginPass"),loginBtn:$E("loginBtn"),init:function(){setBackLink();if(this.isInited)return;this.isInited=true;var _this=this;this.loading=new Loading(this.loginBtn);var fixLoginFunc=_this.login.bind2(unLogin);setInterval(function(){if(_this.checkInput()){Core.Events.addEvent(_this.loginBtn,fixLoginFunc,"click");_this.loginBtn.className="move_btn027"}else{Core.Events.removeEvent(_this.loginBtn,fixLoginFunc,"click");_this.loginBtn.className="move_btn022"}},200);Core.Events.addEvent(this.loginName,function(evt){var keyCode;evt=window.event||evt;keyCode=evt.which||evt.keyCode;if(keyCode==13){_this.loginPass.focus()}},"keypress");Core.Events.addEvent(this.loginPass,function(evt){var keyCode;evt=window.event||evt;keyCode=evt.which||evt.keyCode;if(keyCode==13){Core.Events.fireEvent(_this.loginBtn,"click")}},"keypress");Lib.passcardOBJ.init(this.loginName,{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},this.loginPass);if(isMoved==1){this.loginObj=new Lib.Login.LoginPost(function(res){if(res.result){var matchLoginName=getUserLoginName();Utils.Io.JsLoad_2.request("http://move.blog.sina.com.cn/blog_rebuild/msn/api/checkMoved.php",{timeout:TIMEOUT_VAL,onComplete:function(res){if(res.code=="A00006"){isLogin.moveCommetToo.checked=false;isLogin.moveCommetToo.parentNode.parentNode.style.display="none";isLogin.movingBtn_ihave.className="move_btn021";_this.isBlogMoved=false;setDirection(TO_IS_LOGIN)}else{if(res.code=="A0088"||res.code=="A0089"){isLogin.moveCommetToo.checked=false;isLogin.moveCommetToo.parentNode.parentNode.style.display="";isLogin.moveCommetToo.onclick=function(){if(isLogin.moveCommetToo.checked){isLogin.movingBtn_ihave.className="move_btn021";isLogin.clickCheck.style.display="none"}else{isLogin.movingBtn_ihave.className="move_btn026"}};_this.isBlogMoved=true;setDirection(TO_IS_LOGIN)}else{onRegistOrMsnBindingError(res,unLogin)}}_this.progressOver()},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"checkMoved_unlogin",uid:getUserUID()}})}else{winDialog.alert("失败！")}_this.progressOver()}});isLogin.hotmail_name_l.innerHTML=matchLoginName;_this.loginName.value="";_this.loginPass.value="";Utils.Cookie.setCookie("curPageLoginMark",userHotmail+"|"+matchLoginName,.2,"/",".blog.sina.com.cn");Utils.Cookie.setCookie("redirectRestrict",getUserUID(),.2,"/",".blog.sina.com.cn")}else{winDialog.alert(res.reason,{funcOk:function(){_this.loginPass.value="";setTimeout(function(){_this.loginPass.focus()},0)}});_this.progressOver()}})}else{this.loginObj=new Lib.Login.LoginPost(function(res){if(res.result){var matchLoginName=getUserLoginName();Utils.Cookie.setCookie("curPageLoginMark",userHotmail+"|"+matchLoginName,.2,"/",".blog.sina.com.cn");Utils.Cookie.setCookie("redirectRestrict",getUserUID(),.2,"/",".blog.sina.com.cn");msnBinding(unLogin)}else{winDialog.alert(res.reason,{funcOk:function(){_this.loginPass.value="";setTimeout(function(){_this.loginPass.focus()},0)}});_this.progressOver()}})}},progressStart:function(){this.inProgress=true;this.loading.show()},progressOver:function(){this.inProgress=false;this.loading.hide()},checkInput:function(){return Core.String.trim(this.loginName.value)&&Core.String.trim(this.loginPass.value)},login:function(){if(this.inProgress)return;this.progressStart();var _name=this.loginName.value;var _pass=this.loginPass.value;var _name_trim=Core.String.trim(_name);this.loginObj.login(_name_trim,_pass,15)}};var isLogin={name:"isLogin",isInited:false,inProgress:false,layer:$E("sina_islogin"),hotmail_name_l:$E("hotmail_name_l"),changeIdBtn:$E("changeIdBtn"),movingBtn_ihave:$E("movingBtn_ihave"),moveCommetToo:$E("moveCommetToo"),clickCheck:$E("click_check"),loading:null,init:function(){setBackLink();if(this.isInited)return;this.isInited=true;this.loading=new Loading(this.movingBtn_ihave);Core.Events.addEvent(this.movingBtn_ihave,this.submit.bind2(isLogin));var matchLoginName=getUserLoginName();isLogin.hotmail_name_l.innerHTML=matchLoginName;msnNoOccupy.hotmail_name_r&&(msnNoOccupy.hotmail_name_r.innerHTML=matchLoginName);Utils.Io.JsLoad_2.request("http://move.blog.sina.com.cn/blog_rebuild/msn/api/checkMoved.php",{timeout:TIMEOUT_VAL,onComplete:function(res){if(res.code=="A00006"){isLogin.moveCommetToo.checked=false;isLogin.movingBtn_ihave.className="move_btn021";isLogin.moveCommetToo.parentNode.parentNode.style.display="none"}else{if(res.code=="A0088"||res.code=="A0089"){isLogin.moveCommetToo.checked=false;isLogin.moveCommetToo.parentNode.parentNode.style.display="";isLogin.moveCommetToo.onclick=function(){if(isLogin.moveCommetToo.checked){isLogin.movingBtn_ihave.className="move_btn021";isLogin.clickCheck.style.display="none"}else{isLogin.movingBtn_ihave.className="move_btn026"}}}else{isLogin.moveCommetToo.checked=false;isLogin.moveCommetToo.parentNode.parentNode.style.display="none";isLogin.movingBtn_ihave.className="move_btn021"}}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"checkMoved_login",uid:getUserUID()}})}else{winDialog.alert("失败！")}}})},progressStart:function(){this.inProgress=true;this.loading.show()},progressOver:function(){this.inProgress=false;this.loading.hide()},submit:function(){if(this.inProgress)return;this.progressStart();if(this.moveCommetToo.parentNode.parentNode.style.display!="none"&&!this.moveCommetToo.checked){this.clickCheck.style.display="";this.progressOver();return}var _hotmail_name=this.hotmail_name_l.innerHTML;var _this=this;Lib.checkAuthor();if($isLogin){if(testBind=="linked"){var cur_uid=getRestrictUID();if(cur_uid){Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/checkLink.php",{timeout:TIMEOUT_VAL,onComplete:function(res){if(res.code=="A00006"){msnBinding(isLogin)}else{onRegistOrMsnBindingError(res,isLogin)}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"checkLink",uid:getUserUID()}})}else{winDialog.alert("失败！")}_this.progressOver()}})}else{winDialog.alert("登录失效，请重新登录",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});_this.progressOver()}}else{msnBinding(isLogin)}}else{setDirection(TO_UNLOGIN);_this.progressOver()}}};var msnNoOccupy={name:"msnNoOccupy",isInited:false,inProgress:false,layer:$E("hotmail_moving_confirm"),hotmail_name_r:$E("hotmail_name_r"),count_pass:$E("count_pass"),confirm_count_pass:$E("confirm_count_pass"),movingBtn_isnew:$E("movingBtn_isnew"),passok:false,passok2:false,loading:null,init:function(){$E("nameTip").style.display="none";this.count_pass.value="";this.confirm_count_pass.value="";verifyMsg("tips4");verifyMsg("tips5");setBackLink(0);if(this.isInited)return;this.isInited=true;this.loading=new Loading(this.movingBtn_isnew);var _this=this;var fixedSubmit=this.submit.bind2(msnNoOccupy);setInterval(function(){if(_this.checkInput()){_this.movingBtn_isnew.className="move_btn021";Core.Events.addEvent(_this.movingBtn_isnew,fixedSubmit,"click")}else{_this.movingBtn_isnew.className="move_btn026";Core.Events.removeEvent(_this.movingBtn_isnew,fixedSubmit,"click")}},200);Core.Events.addEvent(this.confirm_count_pass,function(evt){var keyCode;evt=window.event||evt;keyCode=evt.which||evt.keyCode;if(evt.keyCode==13){_this.movingBtn_isnew.blur();Core.Events.fireEvent(_this.movingBtn_isnew,"click")}},"keypress");var keypressTimer1=0;Core.Events.addEvent(this.count_pass,function(){_this.checkPass(0)},"blur");Core.Events.addEvent(this.count_pass,function(){clearTimeout(keypressTimer1);keypressTimer1=setTimeout(function(){_this.checkPass(0)},500)},"keypress");var keypressTimer2=0;Core.Events.addEvent(this.confirm_count_pass,function(){_this.checkPass(1)},"blur");Core.Events.addEvent(this.confirm_count_pass,function(){clearTimeout(keypressTimer2);keypressTimer2=setTimeout(function(){_this.checkPass(1)},500)},"keypress")},progressStart:function(){this.inProgress=true;this.loading.show()},progressOver:function(){this.inProgress=false;this.loading.hide()},checkInput:function(){var checkboxObj=$E("isAgreeCheckbox");return this.passok&&this.passok2&&checkboxObj&&checkboxObj.checked},checkPass:function(mode){var _count_pass=this.count_pass.value;var _confirm_count_pass=this.confirm_count_pass.value;var _this=this;if(mode==0){if(!_count_pass){verifyMsg("tips4",48," 请输入密码");this.progressOver();this.passok=false;return}else if(/[^\x21-\x7e]/.test(_count_pass)){verifyMsg("tips4",48," 密码只能由数字、字母和符号组成");this.progressOver();this.passok=false;return}else if(_count_pass.length<6){verifyMsg("tips4",48," 太短了，至少6位密码");this.progressOver();this.passok=false;return}verifyMsg("tips4",49);_this.checkPass(1);this.passok=true}else if(mode==1){if(_confirm_count_pass!==_count_pass){verifyMsg("tips5",48,_confirm_count_pass.length>0?" 两次输入的密码不同":"请再次输入密码");this.progressOver();this.passok2=false;return}if(_confirm_count_pass&&_count_pass){verifyMsg("tips5",49)}this.passok2=true;return true}},hasToken:function(){if(regToken){return true}else{winDialog.alert("您的操作可能已经失效，请点击确定返回第一步",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});return false}},submit:function(){if(this.inProgress)return;this.progressStart();var _count_pass=this.count_pass.value;var _confirm_count_pass=this.confirm_count_pass.value;

var _hotmail_name=this.hotmail_name_r.innerHTML;var _regnick=_hotmail_name.indexOf("@")>-1?_hotmail_name.slice(0,_hotmail_name.indexOf("@")):_hotmail_name;var _this=this;if(!this.hasToken()){this.progressOver();return}if(this.passok&&this.passok2){Utils.Io.Ijax_2.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/sina_Reg.php?move=true&view="+this.name,{timeout:TIMEOUT_VAL,GET:{t:(new Date).getTime().toString().slice(-5)},POST:{regname:_hotmail_name,regnick:_regnick,token:regToken,regpwd:_count_pass},onComplete:function(res){if(res.code=="A00006"){toMsnLive(msnNoOccupy)}else{onRegistOrMsnBindingError(res,msnNoOccupy)}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"sinaReg_noOcc",uid:getUserUID()}})}else{winDialog.alert("失败！")}_this.progressOver()}})}else{this.progressOver()}}};var msnOccupyButAutoFail={name:"msnOccupyButAutoFail",isInited:false,inProgress:false,loading:null,layer:$E("hotmail_custom"),hotmail_custom_name:$E("hotmail_custom_name"),count_custom_pass:$E("count_custom_pass"),confirm_custom_pass:$E("confirm_custom_pass"),movingBtn_custom:$E("movingBtn_custom"),userok:false,passok:false,passok2:false,init:function(){var _this=this;$E("nameTip").style.display="none";this.count_custom_pass.value="";this.confirm_custom_pass.value="";verifyMsg("tips2");verifyMsg("tips3");setBackLink(0);if(this.isInited)return;this.isInited=true;var fixedSubmit=this.submit.bind2(msnOccupyButAutoFail);setInterval(function(){if(_this.checkInput()){Core.Events.addEvent(_this.movingBtn_custom,fixedSubmit,"click");_this.movingBtn_custom.className="move_btn021"}else{Core.Events.removeEvent(_this.movingBtn_custom,fixedSubmit,"click");_this.movingBtn_custom.className="move_btn026"}},200);this.loading=new Loading(this.movingBtn_custom);this.hotmail_custom_name.value=userHotmail.split("@")[0];Core.Events.addEvent(this.confirm_custom_pass,function(evt){var keyCode;evt=window.event||evt;keyCode=evt.which||evt.keyCode;if(evt.keyCode==13){_this.movingBtn_custom.blur();Core.Events.fireEvent(_this.movingBtn_custom,"click")}},"keypress");Core.Events.addEvent(this.hotmail_custom_name,function(){verifyMsg("tips1")},"focus");Core.Events.addEvent(this.hotmail_custom_name,function(){var value=_this.hotmail_custom_name.value;value=Core.String.trim(value);if(!value){verifyMsg("tips1",48," 请填写邮箱名");this.progressOver();this.userok=false;return}else if(/[^a-z0-9_]/.test(value)){verifyMsg("tips1",48," 请用英文小写、数字、下划线");this.progressOver();this.userok=false;return}else if(!/^[^_].*[^_]$/.test(value)){verifyMsg("tips1",48," 首尾不能是下划线");this.progressOver();this.userok=false;return}else if(value.replace(/[\d]/g,"").length==0){verifyMsg("tips1",48," 不能全是数字");this.progressOver();this.userok=false;return}else if(value.length>16){verifyMsg("tips1",48," 邮箱名必须 4-16 个字符");this.progressOver();this.userok=false;return}_this.checkUser(function(){})},"blur");var keypressTimer1=0;Core.Events.addEvent(this.count_custom_pass,function(){_this.checkPass(0)},"blur");Core.Events.addEvent(this.count_custom_pass,function(){clearTimeout(keypressTimer1);keypressTimer1=setTimeout(function(){_this.checkPass(0)},500)},"keypress");var keypressTimer2=0;Core.Events.addEvent(this.confirm_custom_pass,function(){_this.checkPass(1)},"blur");Core.Events.addEvent(this.confirm_custom_pass,function(){clearTimeout(keypressTimer2);keypressTimer2=setTimeout(function(){_this.checkPass(1)},500)},"keypress")},progressStart:function(){this.inProgress=true;this.loading.show()},progressOver:function(){this.inProgress=false;this.loading.hide()},checkInput:function(){var checkboxObj=$E("isAgreeCheckbox1");return this.userok&&this.passok&&this.passok2&&checkboxObj&&checkboxObj.checked},checkUser:function(callback){var _this=this;_this.userok=false;Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/checkUser.php",{timeout:TIMEOUT_VAL,GET:{name:_this.hotmail_custom_name.value,from:"cnmail",t:+new Date},onComplete:function(res){if(res.code=="A00006"){if(res.data=="yes"){_this.userok=false;verifyMsg("tips1","48"," 该邮箱地址已被占用")}else{_this.userok=true;verifyMsg("tips1","49","");callback()}}else{}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"checkUser",uid:getUserUID()}})}else{winDialog.alert("失败！")}}})},checkPass:function(mode){var _count_pass=this.count_custom_pass.value;var _confirm_count_pass=this.confirm_custom_pass.value;var _this=this;if(mode==0){if(!_count_pass){verifyMsg("tips2",48," 请输入密码");this.progressOver();this.passok=false;return}else if(/[^\x21-\x7e]/.test(_count_pass)){verifyMsg("tips2",48," 密码只能由数字、字母和符号组成");this.progressOver();this.passok=false;return}else if(_count_pass.length<6){verifyMsg("tips2",48," 太短了，至少6位密码");this.progressOver();this.passok=false;return}verifyMsg("tips2",49);_this.checkPass(1);this.passok=true}else if(mode==1){if(_confirm_count_pass!==_count_pass){verifyMsg("tips3",48,_confirm_count_pass.length>0?" 两次输入的密码不同":"请再次输入密码");this.progressOver();this.passok2=false;return}if(_confirm_count_pass&&_count_pass){verifyMsg("tips3",49)}this.passok2=true;return true}},hasToken:function(){if(regToken){return true}else{winDialog.alert("您的操作可能已经失效，请点击确定返回第一步",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});return false}},submit:function(){if(this.inProgress)return;this.progressStart();if(!this.hasToken()){this.progressOver();return}var _count_pass=this.count_custom_pass.value;var _confirm_count_pass=this.confirm_custom_pass.value;var _hotmail_name=this.hotmail_custom_name.value;var _regnick=_hotmail_name.indexOf("@")>-1?_hotmail_name.slice(0,_hotmail_name.indexOf("@")):_hotmail_name;var _this=this;if(this.userok&&this.passok&&this.passok2){Utils.Io.Ijax_2.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/sina_Reg.php?move=true&view="+this.name,{timeout:TIMEOUT_VAL,GET:{t:(new Date).getTime().toString().slice(-5)},POST:{regname:this.hotmail_custom_name.value+"@sina.cn",regnick:_regnick,token:regToken,regpwd:_count_pass},onComplete:function(res){if(res.code=="A00006"){toMsnLive(msnOccupyButAutoFail)}else{onRegistOrMsnBindingError(res,msnOccupyButAutoFail)}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"sinaReg_occ",uid:getUserUID()}})}else{winDialog.alert("失败！")}_this.progressOver()}})}else{this.progressOver()}}};function setDirection(direction){switch(direction){case TO_UNLOGIN:unLogin.init();leftColumn&&(leftColumn.style.display="none");leftColumn=unLogin.layer;unLogin.layer.style.display="";break;case TO_IS_LOGIN:isLogin.init();leftColumn&&(leftColumn.style.display="none");leftColumn=isLogin.layer;isLogin.layer.style.display="";rightColumn.style.display="none";$E("hotmail_occupied").style.display="none";break;case TO_MSN_NO_OCCUPY:msnNoOccupy.init();rightColumn.style.display="none";rightColumn=msnNoOccupy.layer;msnNoOccupy.layer.style.display="";leftColumn.style.display="none";break;case TO_MSN_OCCUPY:msnOccupy.init();rightColumn.style.display="none";rightColumn=msnOccupy.layer;msnOccupy.layer.style.display="";break;case TO_OCCUPY_BUT_AUTO_FAIL:msnOccupyButAutoFail.init();setTimeout(function(){$E("hotmail_custom_name").focus()},50);$E("start_login").style.display="none";rightColumn.style.display="none";rightColumn=msnOccupyButAutoFail.layer;msnOccupyButAutoFail.layer.style.display="";leftColumn.style.display="none";break;default:break}}function msnBinding(view){var cur_uid=getRestrictUID();if(cur_uid){if(!regToken){winDialog.alert("您的操作可能已经失效，请点击确定返回第一步",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});view.progressOver();return}Utils.Io.Ijax_2.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/setLink.php?move=true&view="+(view?view.name:""),{timeout:TIMEOUT_VAL,POST:{token:regToken,moveCommetToo:unLogin.isBlogMoved==undefined?"":unLogin.isBlogMoved==true?1:0},onComplete:function(res){if(res.code=="A00006"){toMsnLive(view)}else{onRegistOrMsnBindingError(res,view)}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"setLink",uid:getUserUID()}})}else{winDialog.alert("失败！")}view.progressOver()}})}else{winDialog.alert("登录失效，请重新登录",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});view.progressOver()}}function toMsnLive(view){var rp=Utils.Cookie.getCookie("msn_return_arr");var uid;var _modifiedCookie;rp=decodeURIComponent(rp);if(rp){rp=Core.String.j2o(rp);uid=getUserUID();if(typeof rp=="object"){Utils.Io.JsLoad_2.request("http://move.blog.sina.com.cn/riaapi/msn/check_tj.php",{timeout:TIMEOUT_VAL,onComplete:function(res){if(res.code=="A00006"){immeToSpace()}else{var ieEvt="onchange";if($IE)ieEvt="onclick";_modifiedCookie=decodeURIComponent(Utils.Cookie.getCookie("msn_return_arr"));var _grant_stat=rp["public"]=="True"?true:false;var _grant_dialog=winDialog.createCustomsDialog({content:['<div class="CP_layercon3 blogManageItem">',"<h3>请选择您搬家后的新浪博客访问权限：</h3>","<p>",'<input type="radio" id="#{rdo1}" value="public" name="rdo1" '+(_grant_stat?"checked":"")+'/><label for="#{rdo1}">公开，所有人可见&nbsp;&nbsp;&nbsp;&nbsp;</label>','<input type="radio" id="#{rdo2}" value="private" name="rdo1" '+(!_grant_stat?"checked":"")+'/><label for="#{rdo2}">私密，仅自己可见</label>',"</p>",'<div class="btn"><a class="SG_aBtn SG_aBtnB" href="#" onclick="return false;" id="#{sure}"><cite>确定</cite></a></div>',"</div>"].join(""),title:"博客访问权限"});_grant_dialog.setMiddle();_grant_dialog.nodes.rdo1[ieEvt]=whenRadioIsChecked;_grant_dialog.nodes.rdo2[ieEvt]=whenRadioIsChecked;_grant_dialog.nodes.sure.onclick=function(){_grant_dialog.hidden();immeToSpace()};_grant_dialog.nodes.btnClose.onclick=function(){_grant_dialog.hidden();immeToSpace()};_grant_dialog.show()}view.progressOver()},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"check_tj",uid:getUserUID()}})}else{winDialog.alert("失败！")}view.progressOver()}})}else{view.progressOver()}}else{winDialog.alert("数据错误，现将跳转第一步",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});setTimeout(function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},3e3);view.progressOver()}function whenRadioIsChecked(evt){var curRadioVal=this.value;var radioStat=curRadioVal=="public"?true:false;var _ck=_modifiedCookie.replace(/"public":"([A-Z]+?)"/i,function(match,f1){if(match){return match.replace(f1,radioStat?"True":"False")}else{return match}});Utils.Cookie.setCookie("msn_return_arr",_ck,3,"/",".move.blog.sina.com.cn")}function immeToSpace(){new Interface("http://move.blog.sina.com.cn/msnmove/mark.php","jsload").request({GET:{uid:uid,cid:rp.cid},onSuccess:function(res){window.location.href="http://spaces.live.com/WPAccountCreated.aspx?canary="+rp.canary+"&wlid="+rp.cid+"&wpid="+uid+"&mc=true&partner=sina"},onError:function(res){window.location.href="http://spaces.live.com/WPAccountCreated.aspx?canary="+rp.canary+"&wlid="+rp.cid+"&wpid="+uid+"&mc=true&partner=sina"},onFail:function(){window.location.href="http://spaces.live.com/WPAccountCreated.aspx?canary="+rp.canary+"&wlid="+rp.cid+"&wpid="+uid+"&mc=true&partner=sina"}})}}function onRegistOrMsnBindingError(res,view){if(res.code=="A2004"||res.code=="A0090"){winDialog.alert($SYSMSG[res.code],{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});view.progressOver()}else if(res.code=="A0091"){winDialog.alert($SYSMSG[res.code],{funcOk:function(){setDirection(TO_UNLOGIN)},funcClose:function(){setDirection(TO_UNLOGIN)}});view.progressOver()}else if(res.code=="A0092"){winDialog.alert($SYSMSG[res.code],{funcOk:function(){msnBinding(view)},funcClose:function(){msnBinding(view)}})}else if(res.code=="A0099"){winDialog.alert($SYSMSG[res.code]);view.progressOver()}else{winDialog.alert($SYSMSG[res.code]||"注册失败，请重试");setDirection(TO_OCCUPY_BUT_AUTO_FAIL);view.progressOver()}}function getUserUID(){var SUPCookie=Utils.Cookie.getCookie("SUP");var transed_SUPCookie=decodeURIComponent(decodeURIComponent(SUPCookie));var matchCookie=transed_SUPCookie.match(/uid=([\x20-\x7e]+?)&user/);var uid=matchCookie&&matchCookie.length&&matchCookie[1];return uid}function getUserLoginName(){var SUPCookie=Utils.Cookie.getCookie("SUP");var transed_SUPCookie=decodeURIComponent(decodeURIComponent(SUPCookie));var matchCookie=transed_SUPCookie.match(/name=([\x20-\x7e]+?)&nick/);var matchLoginName=matchCookie&&matchCookie.length&&matchCookie[1];return matchLoginName}function isCurPageLogin(){var SUPCookie=Utils.Cookie.getCookie("SUP");var transed_SUPCookie;var matchCookie;var matchLoginName;if(SUPCookie){transed_SUPCookie=decodeURIComponent(decodeURIComponent(SUPCookie));matchCookie=transed_SUPCookie.match(/name=([\x20-\x7e]+?)&nick/);matchLoginName=matchCookie.length&&matchCookie[1];if(userHotmail+"|"+matchLoginName==decodeURIComponent(Utils.Cookie.getCookie("curPageLoginMark"))){return true}else{return false}}else{return false}}function getRestrictUID(){var uid=getUserUID();var _uid=Utils.Cookie.getCookie("redirectRestrict");if(uid==_uid){return uid}else{return null}}function setBackLink(view){var node=$E("backLink");var node1=$E("backLink1");var node2=$E("backLink2");var nodes=[node,node1,node2];for(var i=nodes.length-1;i>=0;i--){if(nodes[i]){nodes[i].style.display="";nodes[i].onclick=function(){backTo()}}}return;if(view!=undefined){for(var i=nodes.length;i!=0;i--){if(nodes[i]){nodes[i].style.display="";nodes[i].onclick=function(){backTo()}}}}else{for(var i=nodes.length;i!=0;i--){if(nodes[i]){nodes[i].style.display="none";nodes[i].onclick=function(){}}}}}function backTo(){try{$E("nameTip").style.display="";$E("hotmail_custom").style.display="none";$E("hotmail_moving_confirm").style.display="none";$E("start_login").style.display=""}catch(e){}setDirection(TO_UNLOGIN);if(testOccupy=="unoccupied"){$E("hotmail_isnew").style.display=""}else{$E("hotmail_occupied").style.display="";$E("hotmail_movmov").style.display=""}}function verifyMsg(loc,icon,str){if(str||icon){str=str||"";$E(loc).style.display="";$E(loc).innerHTML='<img class="SG_icon SG_icon'+(icon||"48")+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" align="absmiddle" />'+str+"</span>"}else{$E(loc).style.display="none";$E(loc).innerHTML=""}}function systemBusyAlert(){winDialog.alert("系统繁忙，请稍候再试 ...",{funcOk:function(){if($MOZ){window.location.reload()}},funcClose:function(){if($MOZ){window.location.reload()}}})}function createRandomBlog(targNode){if(createRandomBlog.inProgress)return;if(!createRandomBlog.inited){if(targNode){createRandomBlog.loading=new Loading(targNode.parentNode)}else{createRandomBlog.loading={show:function(){},hide:function(){}}}createRandomBlog.inited=true}winDialog.confirm("是否随机注册一个博客账号？",{textOk:"是",textCancel:"否",defaultButton:1,title:"提示",funcOk:function(){submitRandomCreate()},funcCancel:function(){}},"createRandomBlog");function submitRandomCreate(){if(createRandomBlog.inProgress)return;createRandomBlog.progressStart();var _hotmail_name=userHotmail;var _regnick=_hotmail_name.indexOf("@")>-1?_hotmail_name.slice(0,_hotmail_name.indexOf("@")):_hotmail_name;var _this=this;if(!regToken){winDialog.alert("您的操作可能已经失效，请点击确定返回第一步",{funcOk:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"},funcClose:function(){window.location.href="http://move.blog.sina.com.cn/msnmove/msn_move_entrance.php"}});createRandomBlog.progressOver();return}Utils.Io.Ijax_2.request("http://control.blog.sina.com.cn/blog_rebuild/msn/api/sina_Reg.php?move=true&view=skip",{timeout:TIMEOUT_VAL,POST:{regnick:_regnick,token:regToken},onComplete:function(res){if(res.code=="A00006"){toMsnLive(createRandomBlog)}else{onRegistOrMsnBindingError(res,createRandomBlog)}},onException:function(res){if(res=="timeout"){systemBusyAlert();Utils.Io.JsLoad_2.request("http://control.blog.sina.com.cn/riaapi/msn/apinote.php",{GET:{api:"sinaReg_skip",uid:getUserUID()}})}else{winDialog.alert("失败！")}createRandomBlog.progressOver()}})}}createRandomBlog.inited=false;createRandomBlog.inProgress=false;createRandomBlog.name="createRandomBlog";createRandomBlog.progressStart=function(){createRandomBlog.inProgress=true;createRandomBlog.loading.show()};createRandomBlog.progressOver=function(){createRandomBlog.inProgress=false;createRandomBlog.loading.hide()};var testOccupy=$E("isOccupy").value;var testBind=$E("isLink").value;var userHotmail=$E("hotMail").value;var regToken=$E("regToken").value;var isMoved=+$E("isMoved").value;var leftColumn=unLogin.layer;var rightColumn;$E("msn_tip").style.cssText="display:none";scope.$createRandomBlog=createRandomBlog;if(testOccupy=="unoccupied"){$E("hotmail_isnew").style.display="";rightColumn=$E("hotmail_isnew");if(testBind=="linked"){Core.Events.addEvent($E("hotmail_moving_btn"),function(){winDialog.alert("你的 MSN 帐号已经绑定过新浪博客帐号，继续此操作将撤销你之前的绑定！",{funcOk:function(){$E("hotmail_isnew").style.display="none";setDirection(TO_MSN_NO_OCCUPY)}})})}else{Core.Events.addEvent($E("hotmail_moving_btn"),function(){$E("hotmail_isnew").style.display="none";setDirection(TO_MSN_NO_OCCUPY)})}}else{rightColumn=$E("hotmail_occupied");Core.Events.addEvent($E("hotmail_movmov"),function(){$E("hotmail_occupied").style.display="none";setDirection(TO_OCCUPY_BUT_AUTO_FAIL)})}if(isCurPageLogin()){setDirection(TO_IS_LOGIN)}else{setDirection(TO_UNLOGIN)}function appendCheckbox(){var t=document.createElement("tr");var thObj=document.createElement("th");var tdObj=document.createElement("td");tdObj.style.paddingBottom="0px";tdObj.style.color="#666666";tdObj.innerHTML='<input id="isAgreeCheckbox" type="checkbox" checked=\'true\' />我已经看过并同意<a target="_blank" href="http://login.sina.com.cn/signupagreement.html">《新浪网络服务使用协议》</a>和<a target="_blank" href="http://login.sina.com.cn/signupagreement_freemail.html">《新浪免费邮箱服务条款》</a>';t.appendChild(thObj);t.appendChild(tdObj);var table1=$E("hotmail_moving_confirm").getElementsByTagName("table")[0];var trs=table1.getElementsByTagName("tr");table1.getElementsByTagName("tbody")[0].insertBefore(t,trs[trs.length-1]);var t1=document.createElement("tr");var thObj1=document.createElement("th");var tdObj1=document.createElement("td");tdObj1.style.paddingBottom="0px";tdObj1.style.color="#666666";tdObj1.innerHTML='<input id="isAgreeCheckbox1" type="checkbox" checked=\'true\' />我已经看过并同意<a target="_blank" href="http://login.sina.com.cn/signupagreement.html">《新浪网络服务使用协议》</a>和<a target="_blank" href="http://login.sina.com.cn/signupagreement_freemail.html">《新浪免费邮箱服务条款》</a>';t1.appendChild(thObj1);t1.appendChild(tdObj1);var table2=$E("hotmail_moving_confirm_1").getElementsByTagName("table")[0];var trs1=table2.getElementsByTagName("tr");table2.getElementsByTagName("tbody")[0].insertBefore(t1,trs1[trs1.length-1])}appendCheckbox()});Sina.pkg("Utils.Flash");if(typeof deconcept=="undefined")var deconcept=new Object;if(typeof deconcept.util=="undefined")deconcept.util=new Object;if(typeof deconcept.SWFObjectUtil=="undefined")deconcept.SWFObjectUtil=new Object;deconcept.SWFObject=function(swf,id,w,h,ver,c,quality,xiRedirectUrl,redirectUrl,detectKey){if(!document.getElementById){return}this.DETECT_KEY=detectKey?detectKey:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object;this.variables=new Object;this.attributes=new Array;if(swf){this.setAttribute("swf",swf)}if(id){this.setAttribute("id",id)}if(w){this.setAttribute("width",w)}if(h){this.setAttribute("height",h)}if(ver){this.setAttribute("version",new deconcept.PlayerVersion(ver.toString().split(".")))}this.installedVer=deconcept.SWFObjectUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObject.doPrepUnload=true}if(c){this.addParam("bgcolor",c)}var q=quality?quality:"high";this.addParam("quality",q);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var xir=xiRedirectUrl?xiRedirectUrl:window.location;this.setAttribute("xiRedirectUrl",xir);this.setAttribute("redirectUrl","");if(redirectUrl){this.setAttribute("redirectUrl",redirectUrl)}};deconcept.SWFObject.prototype={useExpressInstall:function(path){this.xiSWFPath=!path?"expressinstall.swf":path;this.setAttribute("useExpressInstall",true)},setAttribute:function(name,value){this.attributes[name]=value},getAttribute:function(name){return this.attributes[name]},addParam:function(name,value){this.params[name]=value},getParams:function(){return this.params},addVariable:function(name,value){this.variables[name]=value},getVariable:function(name){return this.variables[name]},getVariables:function(){return this.variables},getVariablePairs:function(){var variablePairs=new Array;var key;var variables=this.getVariables();for(key in variables){variablePairs[variablePairs.length]=key+"="+variables[key]}return variablePairs},getSWFHTML:function(){var swfNode="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath)}swfNode='<embed pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash" src="'+this.getAttribute("swf")+'" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'"';swfNode+=' id="'+this.getAttribute("id")+'" name="'+this.getAttribute("id")+'" ';var params=this.getParams();for(var key in params){swfNode+=[key]+'="'+params[key]+'" '}var pairs=this.getVariablePairs().join("&");if(pairs.length>0){swfNode+="flashvars="+pairs+'&realfull=1&moz=1"'}swfNode+="/>"}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath)}swfNode='<object id="'+this.getAttribute("id")+'" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" codebase="http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=9,0,28,0" width="'+this.getAttribute("width")+'" height="'+this.getAttribute("height")+'" style="'+this.getAttribute("style")+'">';swfNode+='<param name="movie" value="'+this.getAttribute("swf")+'" />';var params=this.getParams();for(var key in params){swfNode+='<param name="'+key+'" value="'+params[key]+'" />'}var pairs=this.getVariablePairs().join("&");if(pairs.length>0){swfNode+='<param name="flashvars" value="'+pairs+'" />'}swfNode+="</object>"}return swfNode},write:function(elementId){if(this.getAttribute("useExpressInstall")){var expressInstallReqVer=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(expressInstallReqVer)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title)}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"))}}var n=typeof elementId=="string"?document.getElementById(elementId):elementId;var oldTitle=document.title;n.innerHTML=this.getSWFHTML();if(oldTitle!==document.title){document.title=oldTitle}return true}};deconcept.SWFObjectUtil.getPlayerVersion=function(){var PlayerVersion=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){PlayerVersion=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."))}}else if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var counter=3;while(axo){try{counter++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+counter);PlayerVersion=new deconcept.PlayerVersion([counter,0,0])}catch(e){axo=null}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7")}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");PlayerVersion=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always"}catch(e){if(PlayerVersion.major==6){return PlayerVersion}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){}}if(axo!=null){PlayerVersion=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","))}}return PlayerVersion};deconcept.PlayerVersion=function(arrVersion){this.major=arrVersion[0]!=null?parseInt(arrVersion[0]):0;this.minor=arrVersion[1]!=null?parseInt(arrVersion[1]):0;this.rev=arrVersion[2]!=null?parseInt(arrVersion[2]):0};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major)return false;if(this.major>fv.major)return true;if(this.minor<fv.minor)return false;if(this.minor>fv.minor)return true;if(this.rev<fv.rev)return false;return true};deconcept.util={getRequestParameter:function(param){var q=document.location.search||document.location.hash;if(param==null){return q}if(q){var pairs=q.substring(1).split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return pairs[i].substring(pairs[i].indexOf("=")+1)}}}return""}};deconcept.SWFObjectUtil.cleanupSWFs=function(){var objects=document.getElementsByTagName("OBJECT");for(var i=objects.length-1;i>=0;i--){objects[i].style.display="none";for(var x in objects[i]){if(typeof objects[i][x]=="function"){objects[i][x]=function(){}}}}};if(deconcept.SWFObject.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectUtil.cleanupSWFs)};window.attachEvent("onbeforeunload",deconcept.SWFObjectUtil.prepUnload);deconcept.unloadSet=true}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id]}}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObject;Utils.Flash.swfObject=deconcept.SWFObject;Sina.pkg("Core.Math");Core.Math.getUniqueId=function(_start,_end){return parseInt(Math.random()*1e4).toString()+(new Date).getTime().toString()};Lib.LocalDB={_this:null,isFlashReady:false,FlaDom:null,updataFun:null,loadedFun:null,regiFun:[],regiFunArgs:[],scacheReady:function(){var me=Lib.LocalDB;me.isFlashReady=true;if(me.loadedFun){me.loadedFun(me._this)}var f=me.regiFun;var a=me.regiFunArgs;for(var i=0;i<f.length;i++){f[i].apply(null,a[i])}},registerFun:function(fun,args){this.regiFun.push(fun);var a=args||[];this.regiFunArgs.push(a)},set:function(key,data){if(this.isFlashReady){try{this.FlaDom.setLazyInterface(key,data);return true}catch(e){trace("set函数出错")}}return false},get:function(key,escapeMsecond,ignore){if(this.isFlashReady){try{return this.FlaDom.getLazyInterface(key,escapeMsecond,ignore)}catch(e){trace("get函数出错")}}return false},clearCache:function(escapeMsecond,key){if(this.isFlashReady){try{$E("scache").clearCache(escapeMsecond,key)}catch(e){trace("gclearCache函数出错")}}return false},loadFlash:function(containerDiv){var random="";if(window.$Maxthon||window.$360||window.$TT){random="?t="+Core.Math.getUniqueId()}if(!this.FlaDom){var FlashPlayer=new Utils.Flash.swfObject($_GLOBAL.flashBasicURL+"scache.swf"+random,"scache","1","1","9","#00ff00");FlashPlayer.addParam("quality","high");FlashPlayer.addParam("wmode","transparent");FlashPlayer.addParam("allowScriptAccess","always");FlashPlayer.write(containerDiv);this.FlaDom=$E("scache")}},getServer:function(){try{return this.FlaDom.isServer()}catch(e){trace("判断是否是通信主机发生错误");return false}},login:function(uid){try{this.FlaDom.login(uid)}catch(e){trace("login函数出错");trace(uid)}},sendToClient:function(data){try{if(this.getServer()){this.FlaDom.sendToClient(data)}else{}}catch(e){trace("sendToClient函数出错")}},setClientJsFun:function(jsFun){try{if(this.getServer()){this.FlaDom.setClientJsFun(jsFun)}else{trace("非主机不可以设置接收函数")}}catch(e){trace("setClientJsFun函数出错")}},receive:function(data){this.updataFun(data)}};var statisticUniqueUser=Core.Class.create();statisticUniqueUser.prototype={container_id:null,is_init:false,localDB:null,initialize:function(cnt_id){this.container_id=cnt_id;if(!Lib.LocalDB.FlaDom){var _this=this;Lib.LocalDB.registerFun(function(){setTimeout(function(){_this.loaded()},10)});Lib.LocalDB.loadFlash("msnStFlash")}else{this.loaded()}},loaded:function(){var _this=this;if(Lib.LocalDB.get("MSNKey",31536e6)){}else{Lib.LocalDB.set("MSNKey","msn_"+window.staticTime+parseInt(Math.random()*1e5).toString())}this.send()},send:function(){var k=Lib.LocalDB.get("MSNKey",31536e6);var cid="";if(Utils.Cookie.getCookie("c_uid")){cid=Utils.Cookie.getCookie("c_uid")}Utils.Io.JsLoad.request("http://move.blog.sina.com.cn/msnmove/log_rcv_api.php?key="+k+"&url="+encodeURIComponent(window.location.href)+"_time_"+(new Date).getTime()+"&cid="+cid,{onComplete:function(){}})}};$registJob("statisticUniqueUser",function(){window.sUU=new statisticUniqueUser});function main(){var job=new Jobs;job.add("msnLogin");job.add("statisticUniqueUser");job.start()}