if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Sina;for(var i=levels[0]=="Sina"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};function $E(oID){var node=typeof oID=="string"?document.getElementById(oID):oID;if(node!=null){return node}return null}function $C(tagName){return document.createElement(tagName)}function $N(name){return document.getElementsByName(name)}function $T(obj,tagName){return obj.getElementsByTagName(tagName)}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}(function(){var bind=function(fFunction,object){var __method=fFunction;return function(){return __method.apply(object,arguments)}};var debug_namespace="Debug";if(window[debug_namespace]==null||typeof window[debug_namespace].log=="undefined"){window[debug_namespace]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(sInfo){this.addData(sInfo,1)},error:function(sInfo){this.addData(sInfo,2)},warning:function(sInfo){this.addData(sInfo,3)},info:function(sInfo){this.addData(sInfo,4)},log:function(sInfo){this.addData(sInfo,5)},dir:function(oInfo){this.addData(oInfo,5)},addData:function(sInfo,nType,sColor,sBgColor){if(sInfo==null){return}if(typeof sInfo!="object"){sInfo=sInfo.toString()}var oOption={type:nType||"5",color:sColor||this.baseColor[nType].color,bgcolor:sBgColor||this.baseColor[nType].bgcolor};this.cacheData.push([sInfo,oOption]);if(this.initFinished==true){this.showCurrentData([sInfo,oOption])}}};window.trace=bind(window[debug_namespace].log,window[debug_namespace]);window.traceError=bind(window[debug_namespace].error,window[debug_namespace])}})();Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.Array");Core.Array.foreach=function(ar,insp){if(ar==null&&ar.constructor!=Array){return[]}var i=0,len=ar.length,r=[];while(i<len){var x=insp(ar[i],i);if(x!==null){r[r.length]=x}i++}return r};Sina.pkg("Core.Events");(function(_s){var _ua=navigator.userAgent.toLowerCase();var system={$winXP:/windows nt 5.1/.test(_ua),$winVista:/windows nt 6.0/.test(_ua),$win7:/windows nt 6.1/.test(_ua),$macOS:/mac/.test(_ua)};var browser={$OPERA:false,$IE6:false,$IE7:false,$IE8:false,$IE9:false,$SAFARI:false,$FF2:false,$FF3:false,$FF4:false,$FF:false,$CHROME:false,$TT:false,$360:false,$SOGO:false,$Maxthon:false};var engine={$IE:0,$MOZ:false,$WEBKIT:false,$KHTML:false};if(/opera/.test(_ua)||_s.opera){browser.$OPERA=true}else if(/chrome\/(\S+)/.test(_ua)){browser.$CHROME=true}else if(/safari\/(\S+)/.test(_ua)){browser.$SAFARI=true}else if(/msie/.test(_ua)){engine.$IE=true;if(/360se/.test(_ua)){browser.$360=true}else if(/tencenttraveler/.test(_ua)){browser.$TT=true}else if(/se\s\S+\smetasr\s\d+\.\d+/.test(_ua)){browser.$SOGO=true}var uaVersionArray=_ua.match(/msie (\d+)/);var version=parseInt(uaVersionArray[1]);engine.$IE=version;if(version===8){browser.$IE8=true}else if(version===6){browser.$IE6=true}else if(version===9){browser.$IE9=true}else if(version===7){browser.$IE7=true}else if(version===10){browser.$IE10=true}}else if(/firefox/.test(_ua)){var uaVersionArray=_ua.match(/firefox\/(\d+)/);browser.$FF=parseInt(uaVersionArray[1]);if(/firefox\/3/.test(_ua)){browser.$FF3=true}else if(/firefox\/4/.test(_ua)){browser.$FF4=true}else if(/firefox\/2/.test(_ua)){browser.$FF2=true}}else if(/trident\/7.0/.test(_ua)&&/rv:11.0/.test(_ua)){engine.$IE=11;browser.$IE11=true}try{var t=window.external;browser.$Maxthon=t.max_version?true:false}catch(e){}if(/applewebkit\/(\S+)/.test(_ua)){engine.$WEBKIT=true}else if(/khtml\/(\S+)/.test(_ua)){engine.$KHTML=true}else if(/rv:([^\)]+)\) gecko\/\d{8}/.test(_ua)){engine.$MOZ=true}browser.$MOBILE=/mobile/i.test(_ua);if(!browser.$MOBILE){browser.$MOBILE=/HTC/.test(_ua)}function apply(thisObj,cfg){var p;for(p in cfg){thisObj[p]=cfg[p]}}apply(_s,browser);apply(_s,engine);apply(_s,system)})(window);Core.Events.addEvent=function(elm,func,evType,useCapture){var _el=typeof elm=="string"?$E(elm):elm;if(_el==null){trace("addEvent 找不到对象："+elm);return}if(typeof useCapture=="undefined"){useCapture=false}if(typeof evType=="undefined"){evType="click"}if(_el.addEventListener){if(evType=="mousewheel"&&$FF){evType="DOMMouseScroll"}_el.addEventListener(evType,func,useCapture);return true}else if(_el.attachEvent){var r=_el.attachEvent("on"+evType,func);return true}else{_el["on"+evType]=func}};Core.Events.removeEvent=function(oElement,fHandler,sName){var _el=$E(oElement);if(_el==null){trace("removeEvent 找不到对象："+oElement);return}if(typeof fHandler!="function"){return}if(typeof sName=="undefined"){sName="click"}if(_el.addEventListener){_el.removeEventListener(sName,fHandler,false)}else if(_el.attachEvent){_el.detachEvent("on"+sName,fHandler)}fHandler[sName]=null};Sina.pkg("Core.Function");Core.Function.bind3=function(fFunc,object,args){args=args==null?[]:args;var __method=fFunc;return function(){return __method.apply(object,args)}};Core.Array.findit=function(arr,v){var k=-1;Core.Array.foreach(arr,function(value,index){if(v==value){k=index}});return k};window.onerror=function(err,file,line){trace("Error occured:"+err+"<br/>file:"+file+"<br/>line:"+line+"<br/>");return true};function Jobs(oOption){this.option=oOption||{};this._jobTable=[[],[],[],[]]}Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(jobName,rel){this._registedJobTable[jobName]=rel},error:function(sMsg){Debug.error(sMsg);this.errorMsg.push(sMsg)},add:function(jobName,type){type=type||1;if(Core.Array.findit(this._jobTable[type],jobName)==-1){this._jobTable[type].push(jobName)}else{this.error("Error: Job <b>"+jobName+"</b> is existed now.")}},start:function(){if(this.option.onStart!=null){this.option.onStart()}var regJobs=this._registedJobTable;var jobs=this._jobTable[1].concat(this._jobTable[2]);var _this=this;this.fe=Core.Function.bind3(_this.focus,_this,[]);var addFocus=function(){if(_this._jobTable[3].length==0){if(_this.option.onEnd!=null){_this.option.onEnd()}return}Core.Events.addEvent(document.body,_this.fe,"focus");Core.Events.addEvent(window,_this.fe,"scroll");Core.Events.addEvent(document.body,_this.fe,"mousemove");Core.Events.addEvent(document.body,_this.fe,"mouseover")};this.queue(jobs,addFocus)},focus:function(){var _this=this;if(this.focusdown){Core.Events.removeEvent(document.body,_this.fe,"focus");Core.Events.removeEvent(window,_this.fe,"scroll");Core.Events.removeEvent(document.body,_this.fe,"mousemove");Core.Events.removeEvent(document.body,_this.fe,"mouseover");_this.fe=null;return}this.focusdown=true;var jobs=this._jobTable[3];this.queue(jobs,this.option.onEnd)},queue:function(jobs,callback){var _this=this;var getTime=function(){return(new Date).valueOf()};var regJobs=this._registedJobTable;var joblen=jobs.length;var i=0;var interNum=window.setInterval(function(){if(i>=joblen){clearInterval(interNum);interNum=null;if(callback!=null){callback()}return}var jobName=jobs[i];var job=regJobs[jobName];i++;if(typeof job=="undefined"){_this.error("<b>Job["+jobName+"] is undefiend!!!</b>");return}var _try=true;var _start=getTime();try{job.call()}catch(e){_this.error("<b>Job["+jobName+"] failed!!!</b>"+e.message+"");if(callback!=null){callback()}_try=false;throw e}finally{if(_try){var _end=getTime();Debug.info("<b>Job["+jobName+"] done in "+(_end-_start)+"ms.</b>")}}},10)},call:function(jobName,args){if(typeof this._registedJobTable[jobName]!="undefined"){this._registedJobTable[jobName].apply(this,args)}else{trace("<b>Job["+jobName+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}}};$registJob=function(name,rel){Jobs.prototype._registJob(name,rel)};$callJob=function(name){var args=[];if(arguments.length>1){Core.Array.foreach(arguments,function(v,i){args[i]=v});args.shift()}Jobs.prototype.call(name,args)};Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Utils.Io");Utils.Io.loadCss=function(oCss,oTarget){if(oCss==null){return false}oTarget=oTarget||window;var _target=oTarget.document;oCss.id=oCss.id||"";var _css;if(oCss.url){_css=_target.createElement("link");_css.setAttribute("rel","stylesheet");_css.setAttribute("type","text/css");_css.setAttribute("href",oCss.url)}else if(oCss.text){_css=_target.createElement("style");_css.setAttribute("type","text/css");if($IE){_css.styleSheet.cssText=oCss.text}else{_css.innerHTML=oCss.text}}_css.setAttribute("id",oCss.id);_target.getElementsByTagName("head")[0].appendChild(_css)};Sina.pkg("Core.System");(function(){var parseParam=function(oSource,oParams){var key;try{if(typeof oParams!="undefined"){for(key in oSource){if(oParams[key]!=null){oSource[key]=oParams[key]}}}}finally{key=null;return oSource}};Core.System.parseParam=parseParam})();Sina.pkg("Core.String");Utils.Url=function(url){url=url||"";this.url=url;this.query={};this.parse()};Utils.Url.prototype={parse:function(url){if(url){this.url=url}this.parseAnchor();this.parseParam()},parseAnchor:function(){var anchor=this.url.match(/\#(.*)/);anchor=anchor?anchor[1]:null;this._anchor=anchor;if(anchor!=null){this.anchor=this.getNameValuePair(anchor);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var query=this.url.match(/\?([^\?]*)/);query=query?query[1]:null;if(query!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(query)}},getNameValuePair:function(str){var o={};str.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(w,n,v){if(n==""){return}o[n]=v||""});return o},getParam:function(sPara){return this.query[sPara]||""},clearParam:function(){this.query={}},setParam:function(name,value){if(name==null||name==""||typeof name!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[name]=value},setParams:function(o){this.query=o},serialize:function(o){var ar=[];for(var i in o){if(o[i]==null||o[i]==""){ar.push(i+"=")}else{ar.push(i+"="+o[i])}}return ar.join("&")},toString:function(){var queryStr=this.serialize(this.query);return this.url+(queryStr.length>0?"?"+queryStr:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(forceSharp){return this.anchor?"#"+this.serialize(this.anchor):forceSharp?"#":""}};Core.String.encodeDoubleByte=function(str){if(typeof str!="string"){return str}return encodeURIComponent(str)};Utils.Io.JsLoad={};(function(){function createScripts(oOpts,oCFG){processUrl(oOpts,oCFG);var urls=oOpts.urls;var i,len=urls.length;for(i=0;i<len;i++){var js=$C("script");js.src=urls[i].url;js.charset=urls[i].charset;js.onload=js.onerror=js.onreadystatechange=function(){if(js&&js.readyState&&js.readyState!="loaded"&&js.readyState!="complete"){return}oCFG.script_loaded_num++;js.onload=js.onreadystatechange=js.onerror=null;if(!1!==oOpts.isRemove){js.src="";js.parentNode.removeChild(js)}js=null};document.getElementsByTagName("head")[0].appendChild(js)}}function processUrl(oOpts,oCFG){var urls=oOpts.urls;var get_hash=oOpts.GET;var i,len=urls.length;var key,url_cls,varname,rnd;for(i=0;i<len;i++){rnd=window.parseInt(Math.random()*1e8);url_cls=new Utils.Url(urls[i].url);for(key in get_hash){if(oOpts.noencode==true){url_cls.setParam(key,get_hash[key])}else{url_cls.setParam(key,Core.String.encodeDoubleByte(get_hash[key]))}}varname=url_cls.getParam("varname")||"requestId_"+rnd;if(oOpts.noreturn!=true){url_cls.setParam("varname",varname)}if(oOpts.returnType=="jsonp"){var name=url_cls.getParam("callback")||"callback_"+rnd;var callback="script_callbackes."+name;url_cls.setParam("callback",callback);if(!window.script_callbackes){window.script_callbackes=[]}window.script_callbackes[name]=function(res){oCFG.is_loadcomplete=true;delete window.script_callbackes[name];if(oCFG.timeout_flag!=null){clearTimeout(oCFG.timeout_flag)}if(oCFG.is_timeout){return}if(oOpts.onComplete!=null){oOpts.onComplete(res)}}}oCFG.script_var_arr.push(varname);urls[i].url=url_cls.toString();urls[i].charset=urls[i].charset||oOpts.charset}}function ancestor(aUrls,oOpts){var _opts={isRemove:!0,urls:[],charset:"utf-8",noreturn:false,noencode:false,returnType:"",timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var _cfg={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[],timeout_flag:null};_opts.urls=typeof aUrls=="string"?[{url:aUrls}]:aUrls;Core.System.parseParam(_opts,oOpts);createScripts(_opts,_cfg);if(_opts.returnType!="jsonp"){(function(){if(_opts.noreturn==true&&_opts.onComplete==null){return}var i,data=[];if(_cfg.script_loaded_num==_opts.urls.length){_cfg.is_loadcomplete=true;if(_opts.onComplete!=null){for(i=0;i<_cfg.script_var_arr.length;i++){data.push(window[_cfg.script_var_arr[i]])}if(_cfg.script_var_arr.length<2){_opts.onComplete(data[0])}else{_opts.onComplete(data)}}return}if(_cfg.is_timeout==true){return}setTimeout(arguments.callee,50)})()}if(_opts.timeout>0){_cfg.timeout_flag=setTimeout(function(){if(_cfg.is_loadcomplete!=true){if(_opts.onException!=null){_opts.onException()}_cfg.is_timeout=true}},_opts.timeout)}}Utils.Io.JsLoad.request=function(aUrls,oOpts){new ancestor(aUrls,oOpts)}})();if(typeof Lib=="undefined"){Lib={}}Lib.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Lib;for(var i=levels[0]=="Lib"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};Sina.pkg("Utils.Cookie");Utils.Cookie.getCookie=function(name){name=name.replace(/([\.\[\]\$])/g,"\\$1");var rep=new RegExp(name+"=([^;]*)?;","i");var co=document.cookie+";";var res=co.match(rep);if(res){return res[1]||""}else{return""}};Core.System.keyValue=function(string,key){var arr=string.match(new RegExp("(\\?|&)"+key+"=([^&]*)(&|$)"));if(arr!=null)return arr[2];return null};Lib.checkAuthor=function(){var AuthorInfo=unescape(Utils.Cookie.getCookie("SUP"));if(AuthorInfo&&AuthorInfo!=""){$UID=Core.System.keyValue(AuthorInfo,"uid");$nick=decodeURIComponent(Core.System.keyValue(AuthorInfo,"nick"));$isLogin=!!$UID;if(typeof scope.$uid=="undefined"){$isAdmin=false}else{$isAdmin=scope.$uid==$UID}}else{AuthorInfo=Utils.Cookie.getCookie("SU");if(AuthorInfo&&AuthorInfo!=""){var match=AuthorInfo.match(/^([^:]*:){2}(\d{5,11})/);$UID=match&&match[2]||null;window.$isLogin=!!$UID;if(typeof scope.$uid=="undefined"){window.$isAdmin=false}else{window.$isAdmin=scope.$uid==$UID}}else{$UID=null;$isLogin=false;$isAdmin=false}}};function v6SendLog(type,label){}function v7sendLog(type,pageid,msg){if(!type){return false}if(type.split("_").length==3){Lib.checkAuthor();if($isLogin){type+="_"+$UID}}if(typeof scope=="undefined"){window.scope={};scope.$pageid=""}pageid=pageid||scope.$pageid;msg=msg||"";Utils.Io.JsLoad.request("http://hits.sinajs.cn/A2/b.html?type="+type+"&pageid="+pageid+"&msg="+msg,{onComplete:function(){}})}Lib.register=function(name,fn){var ns=name.split(".");var obj={},tmp,nsobj=Lib;while(tmp=ns.shift()){if(ns.length){if(nsobj[tmp]===undefined){nsobj[tmp]={}}nsobj=nsobj[tmp]}else{if(nsobj[tmp]===undefined){nsobj[tmp]=fn(Lib)}}}};Lib.register("util.loadScript",function(){var TRUE=!0,FALSE=!1,cache={};var loadScript=function(url,item){Utils.Io.JsLoad.request(url,{isRemove:FALSE,noreturn:TRUE,onComplete:function(data){cache[url].isLoading=FALSE;var cb=cache[url].cb;for(var i=0,len=cb.length;i<len;i++){cb[i](data)}cache[url].cb=null}})};return function(url,fun){var item=cache[url];var cb=item&&item["cb"];if(!item){cb=[fun];item={isLoading:TRUE,cb:cb};cache[url]=item;loadScript(url,item)}else if(item.isLoading){cb.push(fun)}else{fun()}}});Lib.register("sendSuda",function(lib){var url="http://www.sinaimg.cn/unipro/pub/suda_s_v851c.js";return function(fun){lib.util.loadScript(url,fun)}});Core.Array.uniq=function(ar){var result=[],x;for(var i=0;i<ar.length;i++){x=ar[i];if(Core.Array.findit(result,x)==-1){result.push(x)}}return result};Core.String.trimHead=function(str){return str.replace(/^(\u3000|\s|\t)*/gi,"")};Core.String.trimTail=function(str){return str.replace(/(\u3000|\s|\t)*$/gi,"")};Core.String.trim=function(str){return Core.String.trimHead(Core.String.trimTail(str))};Lib.Uic={_interfaceMultiquery:"http://uic.sso.sina.com.cn/uic/Mutiquery.php",cacheNickName:{},getNickName:function(arrUidLists,fCallBack,requestNo){arrUidLists=Core.Array.uniq(arrUidLists)||[];requestNo=requestNo||10;var _trim=Core.String.trim;var _cache=this.cacheNickName,_uidWithNoCache=[],nickType=[];var _data={};for(var i=0,len=arrUidLists.length;i<len;i++){if(typeof _cache[arrUidLists[i]]=="undefined"&&_cache[arrUidLists[i]]==null){var nickEl=$E("ownernick");var pageid=_trim(scope.$pageid);if(arrUidLists[i]==$UID&&scope.nickname!=null){_data[arrUidLists[i]]=_trim(scope.nickname);continue}_uidWithNoCache.push(arrUidLists[i])}else{_data[arrUidLists[i]]=_cache[arrUidLists[i]]||arrUidLists[i]}}if(_uidWithNoCache.length==0){fCallBack(_data);_data=null}else{var urls=[];for(var i=0;i<_uidWithNoCache.length;i++){nickType[i]=1}if(_uidWithNoCache.length>0){if(nickType.length>0){nickType="["+nickType.toString().replace(/,$/g,"")+"]"}_uidWithNoCache="["+_uidWithNoCache.toString().replace(/,$/g,"")+"]";urls.push({url:this._interfaceMultiquery+"?UID=0&Check=null&UIDS="+_uidWithNoCache+"&UserInfoTypes="+nickType+"&ProductType=2"})}var jsRequest=function(aUrl){Utils.Io.JsLoad.request(aUrl[0].url,{onComplete:function(data){if(data){var uids=data.UserInfos;for(var i=0;i<uids.length;i++){_data[uids[i][0]]=uids[i][2][1];Lib.Uic.cacheNickName[uids[i][0]]=uids[i][2][1]}fCallBack(_data)}}});if(urls.length>0){setTimeout(function(){jsRequest(urls.splice(0,1))},10)}};if(urls.length>0){setTimeout(function(){jsRequest(urls.splice(0,1))},10)}}}};Core.String.byteLength=function(str){if(typeof str=="undefined"){return 0}var aMatch=str.match(/[^\x00-\x80]/g);return str.length+(!aMatch?0:aMatch.length)};Core.String.leftB=function(str,len){var s=str.replace(/\*/g," ").replace(/[^\x00-\xff]/g,"**");str=str.slice(0,s.slice(0,len).replace(/\*\*/g," ").replace(/\*/g,"").length);if(Core.String.byteLength(str)>len)str=str.slice(0,str.length-1);return str};$registJob("suda",function(){var suda_flag=scope&&scope.$pageid&&scope.$pageid==="profile_index";if(typeof _S_pSt=="function"){if(suda_flag){v7sendLog("42_01_11")}return}if(suda_flag){v7sendLog("42_01_11")}Lib.sendSuda(function(){try{_S_pSt("")}catch(e){}if(suda_flag){v7sendLog("42_01_12")}});var ele=$E("blognamespan");if(!ele){return}Lib.checkAuthor();Lib.Uic.getNickName([scope.$uid],function(oResult){var nickName=oResult[scope.$uid];nickName=nickName.replace(/\u7684\u535a\u5ba2$/,"");nickName=Core.String.leftB(nickName,30);nickName=nickName+"的博客";ele.innerHTML=nickName})});Sina.pkg("Core.Dom");Core.Dom.getElementsByClass=function(el,tg,clz){el=el||document;var rs=[];clz=" "+clz+" ";var cldr=el.getElementsByTagName(tg),len=cldr.length;for(var i=0;i<len;++i){var o=cldr[i];if(o.nodeType==1){var ecl=" "+o.className+" ";if(ecl.indexOf(clz)!=-1){rs[rs.length]=o}}}return rs};Core.Dom.byClz=Core.Dom.getElementsByClass;Core.Function.bind2=function(fFunc,object){var __method=fFunc;return function(){return __method.apply(object,arguments)}};Function.prototype.bind2=function(object){var __method=this;return function(){return __method.apply(object,arguments)}};Core.Dom.removeClass=function(obj,className){obj=$E(obj);obj.className=obj.className.replace(new RegExp("\\s*\\b"+className+"\\b"),"")};Core.Dom.removeClassName=Core.Dom.removeClass;Lib.tabToggether=function(tabClass,curClass,eventType,callback){eventType=eventType||"click";callback=callback||function(){};var arr=Core.Dom.getElementsByClass(document,"*",tabClass);for(var i=0;i<arr.length;i++){var tab=arr[i];tab.curClass=curClass;tab.tabClass=tabClass;tab.callback=callback;Core.Events.addEvent(tab,function(e){var preTab=null;var nowTab=this;var ar_r=Core.Dom.getElementsByClass(document,"*",nowTab.tabClass);for(var j=0;j<ar_r.length;j++){var p=ar_r[j];var g="\\b"+nowTab.curClass+"\\b";g=new RegExp(g);var c=p.className;if(c.match(g)){preTab=p;break}}Lib.tabToggether.changFun(preTab,nowTab);tab.callback()}.bind2(tab),eventType)}};Lib.tabToggether.changFun=function(preTab,nowTab){var divid=nowTab.id+"_div";if(!$E(divid))return;var id=preTab.id+"_div";Core.Dom.removeClassName(preTab,preTab.curClass);nowTab.className+=" "+preTab.curClass;$E(id).style.display="none";$E(divid).style.display=""};$registJob("msg_index",function(){var Msg_index={loading:false,tabIds:{1:"",2:"",33:"",34:"",35:"",36:"",3:"",4:"",5:"",6:""}};Lib.tabToggether("msn_tab_cc","current","click");Lib.tabToggether("commet_div_tab","cur","click")});Sina.pkg("Core.Class");Core.Class.AsPrototype={};Core.Class.create=function(){return function(t){if(t!=Core.Class.AsPrototype){this.initialize.apply(this,arguments)}}};Core.Dom.setStyle=function(el,property,val){switch(property){case"opacity":el.style.filter="alpha(opacity="+val*100+")";if(!el.currentStyle||!el.currentStyle.hasLayout){el.style.zoom=1}break;case"float":property="styleFloat";default:el.style[property]=val}};if(!$IE||!($IE<9)){Core.Dom.setStyle=function(el,property,val){if(property=="float"){property="cssFloat"}el.style[property]=val}}Core.Dom.getTop=function(element){var top=0;var el=$E(element);if(typeof el.offsetParent!="unknown"){while(el.offsetParent){top+=el.offsetTop;el=el.offsetParent}}else if(el.y){top+=el.y}return top};Core.Dom.getLeft=function(element){var left=0;var el=$E(element);if(typeof el.offsetParent!="unknown"){while(el.offsetParent){left+=el.offsetLeft;el=el.offsetParent}}else if(el.x){left+=el.x}return left};Lib.applyIf=function(o,s,defaults){if(defaults){Lib.applyIf(o,defaults)}if(o&&s&&Lib.isObject(s)){for(var p in s){if(s.hasOwnProperty(p)&&!o[p]){o[p]=s[p]}}}return o};Lib.isObject=function(o){return Object.prototype.toString.call(o)==="[object Object]"};Lib.apply=function(o,ref,defaults,deep,original){if(defaults){Lib.applyIf(o,defaults)}for(var p in ref){if(original&&o[p]&&!Lib.isObject(o[p])){continue}if(ref.hasOwnProperty(p)){if(deep&&Lib.isObject(ref[p])){o[p]=Lib.apply(o[p]||{},ref[p],deep,original)}else{o[p]=ref[p]}}}return o};Sina.pkg("Ui");if(typeof Ui=="undefined"){Ui=Sina.Ui}Ui.Template=function(tmpl){this.tmpl=tmpl;this.pattern=/(#\{(.*?)\})/g};Ui.Template.prototype={evaluate:function(data){return this.tmpl.replace(this.pattern,function(){return data[arguments[2]]||""})},evaluateMulti:function(data,reverse){var _buffer=[];Core.Array.foreach(data,Core.Function.bind2(function(v,i){i=reverse?data.length-i:i;_buffer[i]=this.evaluate(v)},this));return _buffer.join("")}};(function(){function object(o){function F(){}F.prototype=o;return new F}Function.prototype.$define=function(def){var k;for(k in def){this.prototype[k]=def[k]}if(this.__interface__){for(k in this.prototype){if(this.prototype[k]==="NI"){throw new Error("类定义错误，接口方法["+k+"]未实现")}}}this.prototype.constructor=this;this.$extends=this.$define=this.$implements=function(){throw new Error("$define语句定义后面不能再作其它定义")};return this};Function.prototype.$extends=function(){var me=this,i=arguments.length,sup,fn;if(i===0){throw new Error("$extends语句错误：未指定父类")}sup=arguments[0];fn=function(){sup.apply(this,arguments);me.apply(this,arguments)};fn.prototype=object(sup.prototype);fn.prototype.constructor=fn;fn.$super=sup.prototype;return fn};Function.prototype.$implements=function(){var arg=Array.prototype.slice.call(arguments,0),fn,i=arg.length,k;while(i--){if(typeof arg[i]!=="object"){throw new Error("$implements语句错误：参数必须为object类型")}for(k in arg[i]){typeof this.prototype[k]==="undefined"&&(this.prototype[k]="NI")}}this.__interface__=true;this.$extends=function(){throw new Error("$extends语句错误:$extends语句不能出现在$implements定义之后")};return this}})();Lib.HtmlTemplate=function(tmpl,uniqueID){this.uniqueID=uniqueID}.$extends(Ui.Template).$define({getHtmlString:function(){if(!this._htmlStr){this._htmlStr=this.evaluate(this.getNodeIds())}return this._htmlStr},getNodeIds:function(){if(!this._nodes){var p=/\{[^\}]+(?=\})/g,i,nodes={},rets,r,uniqueID=this._getUniqueID();this.__templateNodesIDs=this.tmpl.match(p);rets=this.__templateNodesIDs;if(rets){i=rets.length;while(i--){r=rets[i].replace("{","");nodes[r]="_"+uniqueID+"_"+r}}this._nodes=nodes}return this._nodes},getNodeId:function(name){if(!this._nodes){this.getNodeIds()}return this._nodes[name]},getNode:function(name){var id=this.getNodeId(name);return!id?null:$E(id)},_getUniqueID:function(){if(!this.uniqueID){this.uniqueID=parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()}return this.uniqueID}});Lib.Panel=Core.Class.create();Lib.Panel.prototype={noIframe:!1,isPostion:!0,appendTo:null,entity:null,backIframe:null,uniqueID:null,isFixed:false,isShow:!1,isHidden:!0,x:0,y:0,template:"",initialize:function(cfg){Lib.apply(this,cfg);var _this=this;this.uniqueID=this._getUniqueID();this._ie6Fixed=function(){if(_this.entity){_this.entity.style.left=document.documentElement.scrollLeft+_this.x+"px";_this.entity.style.top=document.documentElement.scrollTop+_this.y+"px"}if(_this.backIframe){_this.backIframe.style.left=_this.entity.style.left;_this.backIframe.style.top=_this.entity.style.top}}},getNode:function(name){return this.tpl.getNode(name)},setTemplate:function(template){this.template=template;if(this.entity&&this.entity.parentNode){this.entity.parentNode.removeChild(this.entity);this.backIframe&&this.backIframe.parentNode.removeChild(this.backIframe)}this.entity=$C("div");var tempEntity=$C("div");var tmp=new Lib.HtmlTemplate(this.template,this.uniqueID);this.tpl=tmp;tempEntity.innerHTML=tmp.getHtmlString();tempEntity.style.display="none";if(this.appendTo){$E(this.appendTo).appendChild(tempEntity)}else{document.body.appendChild(tempEntity)}this.entity=$E("_"+this.uniqueID+"_panel");if(this.isPostion){this.entity.style.position="absolute"}this.entity.style.display="none";if(this.appendTo){$E(this.appendTo).replaceChild(this.entity,tempEntity)}else{document.body.replaceChild(this.entity,tempEntity)}tempEntity=null;if(!this.noIframe){this.backIframe=$C("iframe");this.backIframe.style.display="none";this.backIframe.style.border="none";this.backIframe.style.zIndex=this.entity.style.zIndex-1;document.body.appendChild(this.backIframe);this._updateBackIframe()}},setPosition:function(x,y){this.x=x;this.y=y;this.entity.style.left=x+"px";this.entity.style.top=y+"px";if($IE6&&this.isFixed){this.entity.style.left=x+document.documentElement.scrollLeft+"px";this.entity.style.top=y+document.documentElement.scrollTop+"px"}if(this.backIframe){this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top}},setFixed:function(state){this.isFixed=state;if($IE6){var _this=this;this.entity.style.position="absolute";if(this.isFixed){_this._ie6Fixed();Core.Events.addEvent(window,_this._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,_this._ie6Fixed,"scroll")}return}this.entity.style.position=this.isFixed?"fixed":"absolute";if(this.backIframe){this.backIframe.style.position=this.entity.style.position}},show:function(){this.entity.style.display="";this.isHidden=!1;this.isShow=!0;if(this.backIframe){this._updateBackIframe();this.backIframe.style.display=""}},hidden:function(){this.hide()},hide:function(){this.entity.style.display="none";this.isHidden=!0;this.isShow=!1;if(this.backIframe){this.backIframe.style.display="none"}},close:function(){this.hidden();this.destroy()},destroy:function(){Core.Events.removeEvent(window,this._ie6Fixed,"scroll");this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.backIframe){this.backIframe.parentNode.removeChild(this.backIframe);this.backIframe=null}},showWithDom:function(dom,offsetLeft,offsetTop){var x=Core.Dom.getLeft(dom)+dom.offsetWidth+offsetLeft;var y=Core.Dom.getTop(dom)+dom.offsetHeight+offsetTop;if($IE6&&this.isFixed){x=x-document.documentElement.scrollLeft;y=y-document.documentElement.scrollTop}this.setPosition(x,y);this.show()},getWidth:function(){var ld=this.entity.style.display;var lv=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=ld;this.entity.style.visibility=lv;return w},getHeight:function(){var ld=this.entity.style.display;var lv=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=ld;this.entity.style.visibility=lv;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},getNodes:function(mode){var m=mode||"o";var pattern=/[^\{\}]+(?=\})/g;var i;var nodes={};var result=this.template.match(pattern);if(result){for(i=0;i<result.length;i++){var r=result[i];switch(m){case"o":nodes[r]=$E("_"+this.uniqueID+"_"+r);break;case"i":nodes[r]="_"+this.uniqueID+"_"+r;break}}}return nodes},_updateBackIframe:function(){Core.Dom.setStyle(this.backIframe,"opacity",0);this.backIframe.style.display="";this.backIframe.style.position=this.entity.style.position;this.backIframe.style.width=this.entity.offsetWidth+"px";this.backIframe.style.height=this.entity.offsetHeight+"px";this.backIframe.style.left=this.entity.style.left;this.backIframe.style.top=this.entity.style.top},_getUniqueID:function(){return parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()}};Core.Events.getEvent=function(){return window.event};if(!$IE||$IE>8){Core.Events.getEvent=function(){if(!$IE&&window.event){return window.event}var o=arguments.callee.caller;var e;var n=0;while(o!=null&&n<40){e=o.arguments[0];if(e&&(e.constructor==Event||e.constructor==MouseEvent)){return e}n++;o=o.caller}return e}}Core.Events.stopEvent=function(el){var ev=el?el:Core.Events.getEvent();if(ev!=null){ev.cancelBubble=true;ev.returnValue=false}};if(!$IE||$IE>8){Core.Events.stopEvent=function(el){var ev=el?el:Core.Events.getEvent();if(ev!=null){ev.preventDefault();ev.stopPropagation()}}}Core.Class.extend=function(destination,supClass,bForce){for(var property in supClass){if(bForce!=null){if(!destination[property]){destination[property]=supClass[property]}}else{destination[property]=supClass[property]}}return destination};Core.Class.define=function(init,superClz,methods){if(init&&init.__isClass&&init.__isClass()){throw new Error("class cnt be used as another class' constructor : "+init)}superClz=superClz||Object;methods=methods||{};methods.initialize=init||methods.initialize||superClz.prototype.initialize||function(){};if(typeof methods.initialize!="function"){throw new Error("only function can be used as constructor")}methods.__isClass=function(){return true};var clz=Core.Class.create();clz.__isClass=methods.__isClass;var proto=superClz==Object?{}:new superClz(Core.Class.AsPrototype);clz.prototype=Core.Class.extend(proto,methods);return clz};Sina.pkg("Utils.Form");Utils.Form.limitMaxLen=function(oTextNode,nMaxLen){var nValue;var keyup=function(){nValue=oTextNode.value;var strLen=Core.String.byteLength(nValue);if(strLen>nMaxLen){oTextNode.value=Core.String.leftB(nValue,nMaxLen)}};Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"keyup");Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"blur");Core.Events.addEvent(oTextNode,Core.Function.bind3(keyup,oTextNode),"focus")};Lib.pkg("Login");Lib.Login.info=function(){var info;if(window["sinaSSOController"]&&(info=sinaSSOController.getLoginInfo())){return info}else{return{}}};(function(){Core.Function.defineGetter=function(obj,p,fn){if(p instanceof Array&&fn instanceof Array){var i=Math.min(p.length,fn.length);while(i--){if(typeof p[i]==="string"&&__checkFunction(fn[i])){obj[p[i]]={valueOf:function(j){return function(){return __getValue(obj,fn[j])}}(i),toString:this.valueOf}}}}else if(typeof p==="string"&&__checkFunction(fn)){obj[p]={valueOf:function(){return __getValue(obj,fn)},toString:this.valueOf}}};function __checkFunction(fn){return typeof fn!=="string"&&String.prototype.slice.call(fn,0,8)=="function"}function __getValue(obj,fn){var ret=fn.call(obj);return typeof ret==="string"||typeof ret==="number"?ret:null}})();Ui.IE6FixedController=function(){
var me=this;this.node=null;this.iframeNode=null;this.__orgX=0;this.__orgY=0;this.__isBindScroll=false;this.__fixedHandle=function(){if(me.node){me.node.style.left=document.documentElement.scrollLeft+me.__orgX+"px";me.node.style.top=document.documentElement.scrollTop+me.__orgY+"px"}if(me.iframeNode){me.iframeNode.style.left=me.node.style.left;me.iframeNode.style.top=me.node.style.top}}}.$define({setFixed:function(node,state){this.updateOrgPosition();if(state&&!this.__isBindScroll){Core.Events.addEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=true}if(!state&&this.__isBindScroll){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false}},setPosition:function(node,fixedState,p){if(typeof p.x!=="undefined"){if(fixedState){node.style.left=p.x+document.documentElement.scrollLeft+"px";this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft}else{node.style.left=p.x+"px"}}if(typeof p.y!=="undefined"){if(fixedState){node.style.top=p.y+document.documentElement.scrollTop+"px";this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop}else{node.style.top=p.y+"px"}}typeof p.z!=="undefined"&&(node.style.zIndex=p.z)},getX:function(node,fixedState){if(fixedState){return parseInt(node.style.left)-document.documentElement.scrollLeft}else{return parseInt(node.style.left)}},getY:function(node,fixedState){if(fixedState){return parseInt(node.style.top)-document.documentElement.scrollTop}else{return parseInt(node.style.top)}},updateIframe:function(isFixed){this.setFixed(this.iframeNode,isFixed);isFixed&&this.__fixedHandle()},updateOrgPosition:function(){if(!this.node){return}this.__orgX=parseInt(this.node.style.left)-document.documentElement.scrollLeft;this.__orgY=parseInt(this.node.style.top)-document.documentElement.scrollTop},destroy:function(){Core.Events.removeEvent(window,this.__fixedHandle,"scroll");this.__isBindScroll=false;this.node=null;this.iframeNode=null}});Core.Events.EventDispatcher=function(target){this.__target=target;this.__events={}}.$define({addEventListener:function(type,handle){if(!this.__checkFunction(handle)){return}var evts=this.__events;type=type.toLowerCase();!evts[type]&&(evts[type]=[]);evts[type].push(handle)},removeEventListener:function(type,handle){var evts=this.__events[type];type=type.toLowerCase();if(!this.__checkFunction(handle)||!evts||!evts.length){return}for(var i=evts.length-1;i>=0;i--){evts[i]==handle&&evts.splice(i,1)}},dispatchEvent:function(type){type=type.toLowerCase();var evts=this.__events[type];if(!evts||!evts.length){return}var args=Array.prototype.slice.call(arguments,0);args.shift();for(var i=0,l=evts.length;i<l;i++){evts[i].apply(this.__target,args)}},__checkFunction:function(func){return typeof func!=="string"&&String.prototype.slice.call(func,0,8)=="function"}});Ui.IRenderer={setCanShow:function(state){},setCanHidden:function(state){},show:function(node){},hidden:function(node){},addEventListener:function(type,handle){},removeEventListener:function(type,handle){}};Ui.SimpleRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IRenderer).$define({setCanShow:function(state){this.__canShow=!!state},setCanHidden:function(state){this.__canHidden=!!state},show:function(node){this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){node.style.display="";this.__eventDispatcher.dispatchEvent("show")}return this},hidden:function(node){this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){node.style.display="none";this.__eventDispatcher.dispatchEvent("hidden")}return this},addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this}});Ui.DisplayObject=function(parent,node){Core.Function.defineGetter(this,["x","y","z","width","height"],[this.__getX,this.__getY,this.__getZ,this.__getWidth,this.__getHeight]);this.__renderer=null;this.__entity=node;this.__isInited=false;this.__parent=parent||document.body;this.__eventDispatcher=new Core.Events.EventDispatcher(this);var ed=this.__eventDispatcher;this.__onBeforeShow=function(){ed.dispatchEvent("beforeShow")};this.__onShow=function(){ed.dispatchEvent("show")};this.__onBeforeHidden=function(){ed.dispatchEvent("beforeHidden")};this.__onHidden=function(){ed.dispatchEvent("hidden")};this.__updateRenderer(Ui.SimpleRenderer)}.$define({isShow:!1,isHidden:!0,setPosition:function(p){!this.__isInited&&this.__initEntity();typeof p.x!=="undefined"&&(this.__entity.style.left=p.x+"px");typeof p.y!=="undefined"&&(this.__entity.style.top=p.y+"px");typeof p.z!=="undefined"&&(this.__entity.style.zIndex=p.z);return this},setSize:function(p){!this.__isInited&&this.__initEntity();typeof p.width!=="undefined"&&(this.__entity.style.width=p.width+"px");typeof p.height!=="undefined"&&(this.__entity.style.height=p.height+"px");return this},setRenderer:function(rendererConstructor){!this.__isInited&&this.__initEntity();this.__updateRenderer(rendererConstructor);return this},show:function(rendererConstructor){this.isHidden=!1;this.isShow=!0;!this.__isInited&&this.__initEntity();this.__updateRenderer(rendererConstructor);this.__renderer.show(this.__entity);return this},hidden:function(rendererConstructor){return this.hide(rendererConstructor)},hide:function(rendererConstructor){this.isHidden=!0;this.isShow=!1;!this.__isInited&&this.__initEntity();this.__updateRenderer(rendererConstructor);this.__renderer.hidden(this.__entity);return this},setCanShow:function(state){this.__renderer.setCanShow(state);return this},setCanHidden:function(state){this.__renderer.setCanHidden(state);return this},addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},destroy:function(){if(!this.__entity){return}!this.__isInited&&this.__initEntity();this.__entity.parentNode&&this.__entity.parentNode.removeChild(this.__entity);this.__entity=null},__initEntity:function(){var st;!this.__entity&&(this.__entity=$C("div"));st=this.__entity.style;st.position="absolute";st.left=0;st.top=0;!this.__entity.parentNode&&this.__parent.appendChild(this.__entity);this.__isInited=true},__updateRenderer:function(rendererConstructor){if(!rendererConstructor){return}var addEvent=function(){this.__renderer.addEventListener("beforeShow",this.__onBeforeShow).addEventListener("show",this.__onShow).addEventListener("beforeHidden",this.__onBeforeHidden).addEventListener("hidden",this.__onHidden)};if(!this.__renderer){this.__renderer=new rendererConstructor;addEvent.call(this)}else if(this.__renderer.constructor!==rendererConstructor){this.__renderer.removeEventListener("beforeShow",this.__onBeforeShow).removeEventListener("show",this.__onShow).removeEventListener("beforeHidden",this.__onBeforeHidden).removeEventListener("hidden",this.__onHidden);this.__renderer=new rendererConstructor;addEvent.call(this)}},__getX:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.left)},__getY:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.top)},__getZ:function(){!this.__isInited&&this.__initEntity();return parseInt(this.__entity.style.zIndex)},__getWidth:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetWidth")},__getHeight:function(){!this.__isInited&&this.__initEntity();return this.__getSize(this.__entity,"offsetHeight")},__getSize:function(node,p){var et=node,v,ov=et.style.visibility;if(et.style.display=="none"){et.style.visibility="hidden";et.style.display="";v=et[p];et.style.display="none";et.style.visibility=ov}else{v=et[p]}return v}});Ui.Panel=function(parent,node){this.nodes={};this.uniqueID=this.__getUniqueID();this.entity=null;this.__iframe=null;this.__isSetAdamant=false;this.__templateNodesIDs=[];this.__isFixed=false;$IE6&&(this.__ie6FixedController=new Ui.IE6FixedController)}.$extends(Ui.DisplayObject).$define({setTemplate:function(tpl){var nd=$C("div");nd.innerHTML=new Ui.Template(tpl).evaluate(this.__getNodes(tpl,"i"));nd.style.display="none";this.__parent.appendChild(nd);this.__updateTemplate(nd);this.nodes=this.__getNodes(tpl);this.entity=this.__entity;this.nodes.panel=this.entity;return this},setFixed:function(state){!this.__isInited&&this.__initEntity();var x=parseInt(this.__entity.style.left),y=parseInt(this.__entity.style.top);if($IE6){this.__ie6FixedController.setFixed(this.__entity,state);this.__isSetAdamant&&this.__ie6FixedController.setFixed(this.__iframe,state)}else{if(state&&!this.__isFixed){this.setPosition({x:x-Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:y-Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="fixed"}if(!state&&this.__isFixed){this.setPosition({x:x+Math.max(document.documentElement.scrollLeft,document.body.scrollLeft),y:y+Math.max(document.documentElement.scrollTop,document.body.scrollTop)});this.__entity.style.position="absolute"}}this.__isFixed=!!state;this.__updateIframe();return this},setAdamant:function(state){this.__isSetAdamant=!!state;this.__isSetAdamant&&!this.__iframe&&this.__createIframe();this.__updateIframe();return this},destroy:function(){if(!this.__entity){return}Ui.Panel.$super.destroy.call(this);this.__ie6FixedController&&this.__ie6FixedController.destroy();this.__iframe&&this.__iframe.parentNode.removeChild(this.__iframe)},setPosition:function(p){!this.__isInited&&this.__initEntity();if($IE6){this.__ie6FixedController.setPosition(this.__entity,this.__isFixed,p)}else{Ui.Panel.$super.setPosition.call(this,p)}this.__updateIframe();return this},setSize:function(p){Ui.Panel.$super.setSize.call(this,p).__updateIframe();return this},show:function(renderer){Ui.Panel.$super.show.call(this,renderer).__updateIframe();return this},hidden:function(renderer){Ui.Panel.$super.hidden.call(this,renderer).__updateIframe();return this},__getX:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getX(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.left)}},__getY:function(){!this.__isInited&&this.__initEntity();if($IE6){return this.__ie6FixedController.getY(this.__entity,this.__isFixed)}else{return parseInt(this.__entity.style.top)}},__createIframe:function(){this.__iframe=$C("iframe");this.__iframe.frameBorder="none";this.__parent.insertBefore(this.__iframe,this.__entity);Core.Dom.setStyle(this.__iframe,"opacity",0);this.__ie6FixedController&&(this.__ie6FixedController.iframeNode=this.__iframe);this.__updateIframe()},__updateIframe:function(){if(this.__iframe){var st=this.__iframe.style;st.backgroundColor="#ffffff";st.left=this.x+"px";st.top=this.y+"px";st.width=this.width+"px";st.height=this.height+"px";st.position=this.__entity.style.position;st.display=this.__entity.style.display;st.zIndex=this.__entity.style.zIndex;$IE6&&this.__ie6FixedController.updateIframe(this.__isFixed)}},__updateIE6FCOrgPosition:function(){this.__ie6FixedController&&this.__ie6FixedController.updateOrgPosition()},__updateTemplate:function(nd){var l,t,z,p,d,et=this.__entity;if(et){et.parentNode&&et.parentNode.removeChild(et);l=et.style.left;t=et.style.top;z=et.style.zIndex;p=et.style.position;d=et.style.display}else{d="none"}et=this.__entity=$E("_"+this.uniqueID+"_panel");if(!et){et=this.__entity=$E("_"+this.uniqueID+"_entity")}if(!et){throw new Error("[Panel Error]there missing identifier #{panel} in panel template")}et.style.left=l||0;et.style.top=t||0;et.style.zIndex=z||0;et.style.position=p||"absolute";et.style.display=d;this.__parent.replaceChild(et,nd);this.__ie6FixedController&&(this.__ie6FixedController.node=this.__entity)},__getNodes:function(template,mode){var m=mode||"o",p=/\{[^\}]+(?=\})/g,i,nodes={},rets,r;this.__templateNodesIDs=template.match(p);rets=this.__templateNodesIDs;if(rets){i=rets.length;while(i--){r=rets[i].replace("{","");switch(m){case"o":nodes[r]=$E("_"+this.uniqueID+"_"+r);break;case"i":nodes[r]="_"+this.uniqueID+"_"+r;break}}}return nodes},__getUniqueID:function(){return parseInt(Math.random()*1e3).toString()+(new Date).getTime().toString()},setContent:function(str){this.nodes.content&&(this.nodes.content.innerHTML=str)},getNodes:function(){return this.nodes}});Ui.Drag=function(captureNode,attachNodes,isDragCapureNode){var me=this;this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.__captureNode=captureNode;this.__dragNodes=[];this.__deltaX=[];this.__deltaY=[];this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__isDraging=false;this.__canDragX=true;this.__canDragY=true;this.__dragHandle=function(){me.__drag()};this.__mouseDownHandle=function(){me.__isDraging=true;me.__eventDispatcher.dispatchEvent("beforeDrag");me.__setCapture(true)};this.__mouseUpHandle=function(){me.__isDraging&&me.__eventDispatcher.dispatchEvent("afterDrag");me.__isDraging=false;me.__setCapture(false)};this.__initNodes(captureNode,attachNodes,isDragCapureNode);this.__initCaputerNode()}.$define({addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},destroy:function(){Core.Events.removeEvent(this.__captureNode,this.__mouseDownHandle,"mousedown");Core.Events.removeEvent(document,this.__mouseUpHandle,"mouseup");this.__captureNode=null;this.__dragNodes=null},__initNodes:function(captureNode,attachNodes,isDragCapureNode){if(attachNodes){attachNodes instanceof Array?this.__dragNodes=attachNodes:this.__dragNodes.push(attachNodes);(typeof isDragCapureNode==="undefined"||isDragCapureNode)&&this.__dragNodes.push(this.__captureNode)}else{this.__dragNodes.push(this.__captureNode)}var dns=this.__dragNodes,i=dns.length;while(i--){!dns[i].style.position&&(dns[i].style.position="absolute");!dns[i].style.left&&(dns[i].style.left=0);!dns[i].style.top&&(dns[i].style.top=0)}},__initCaputerNode:function(){var cn=this.__captureNode,me=this;Core.Events.addEvent(cn,this.__mouseDownHandle,"mousedown");Core.Events.addEvent(document,this.__mouseUpHandle,"mouseup")},__setCapture:function(isCapture){var cn=this.__captureNode,dns=this.__dragNodes,evt=Core.Events.getEvent(),i=dns.length;while(i--){this.__deltaX[i]=evt.clientX-parseInt(dns[i].style.left);this.__deltaY[i]=evt.clientY-parseInt(dns[i].style.top)}if(isCapture){if($IE){cn.setCapture();Core.Events.addEvent(cn,this.__dragHandle,"mousemove")}else{Core.Events.addEvent(document,this.__dragHandle,"mousemove")}}else{if($IE){cn.releaseCapture();Core.Events.removeEvent(cn,this.__dragHandle,"mousemove")}else{Core.Events.removeEvent(document,this.__dragHandle,"mousemove")}}},__drag:function(){if(!this.canDrag){return}var dns=this.__dragNodes,evt=Core.Events.getEvent(),i=dns.length,la=this.lockArea,dX=0,dY=0;this.__eventDispatcher.dispatchEvent("drag");while(i--){dX=evt.clientX-this.__deltaX[i];dY=evt.clientY-this.__deltaY[i];if(this.isLock){dX=Math.min(Math.max(dX,la.left),la.right);dY=Math.min(Math.max(dY,la.top),la.bottom)}dns[i].style.left=dX+"px";dns[i].style.top=dY+"px"}}});Ui.IDragger={addEventListener:function(type,handle){},removeEventListener:function(type,handle){},setDrag:function(node,attachNodes,isDragCapureNode){},setLock:function(state){},setArea:function(area){},destroy:function(){}};Ui.SimpleDragger=function(){this.__drag=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(type,handle)}else{this.__drag.addEventListener(type,handle)}return this},removeEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(type,handle)}else{this.__drag.removeEventListener(type,handle)}return this},setDrag:function(node,attachNode,isDragCapureNode){var me=this;this.__drag=new Ui.Drag(node,attachNode,isDragCapureNode);this.__drag.addEventListener("afterDrag",function(){me.__eventDispatcher.dispatchEvent("afterDrag")});return this},setLock:function(state){this.__drag.isLock=!!state;return this},setArea:function(area){this.__drag.lockArea=area;return this},destroy:function(){this.__drag.destroy()}});Ui.Dialog=function(parent,node){var me=this;this.__dragger=null;this.__isBindUpadateAreaEvent=false;this.__isBindUpdateIE6AreaEvent=false;this.__beforeDragHandle=function(){me.__updateDraggerArea();me.__eventDispatcher.dispatchEvent("beforedrag")};this.__dragHandle=function(){me.__isSetAdamant&&me.__updateIframe();me.__eventDispatcher.dispatchEvent("drag")};this.__afterDragHandle=function(){me.__isFixed&&$IE6&&me.__updateIE6FCOrgPosition();me.__eventDispatcher.dispatchEvent("afterdrag")};this.__updateDraggerAreaHandle=function(){setTimeout(function(){me.__updateDraggerArea()},1)};this.__setMiddleHandle=function(){me.setMiddle()}}.$extends(Ui.Panel).$define({setTemplate:function(tpl){Ui.Dialog.$super.setTemplate.call(this,tpl);this.__initTitleBar();this.setDragger(Ui.SimpleDragger);return this},setContent:function(content){if(!this.nodes.content){return this}this.nodes.content.innerHTML=new Ui.Template(content).evaluate(this.__getNodes(content,"i"));this.__addContentNodes(this.__getNodes(content));return this},setFixed:function(state){Ui.Dialog.$super.setFixed.call(this,state);if(state){Core.Events.addEvent(window,this.__setMiddleHandle,"resize")}else{Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")}this.__updateDraggerArea();return this},setMiddle:function(){var areaHeight=this.__getDocumentSize().height-this.height,goldenSection=(Math.sqrt(5)-1)/2,totalSection=1,goldenSectionY=areaHeight*goldenSection/(goldenSection+totalSection),middleX=this.__getDocumentSize().width/2-this.width/2;if(!this.__isFixed){goldenSectionY+=Math.max(document.documentElement.scrollTop,document.body.scrollTop);middleX+=Math.max(document.documentElement.scrollLeft,document.body.scrollLeft)}this.setPosition({x:Math.max(middleX,0),y:Math.max(goldenSectionY,0)});return this},setAreaLocked:function(state){if(!this.__dragger){return this}this.__dragger.setLock(state);return this},setSize:function(p){!this.__isInited&&this.__initEntity();if(this.nodes.content){typeof p.width!=="undefined"&&(this.nodes.content.style.width=p.width+"px");typeof p.height!=="undefined"&&(this.nodes.content.style.height=p.height+"px")}else{typeof p.width!=="undefined"&&(this.__entity.style.width=p.width+"px");typeof p.height!=="undefined"&&(this.__entity.style.height=p.height+"px")}return this},setDragger:function(draggerConstructor){if(!this.nodes.titleBar||!draggerConstructor){return this}if(!this.__dragger){this.__dragger=new draggerConstructor}else if(this.__dragger.constructor===draggerConstructor){return this}this.__updateDragger(draggerConstructor);return this},destroy:function(){if(!this.__entity){return}Ui.Dialog.$super.destroy.call(this);Core.Events.removeEvent(window,this.__updateDraggerAreaHandle,"resize");Core.Events.removeEvent(window,this.__setMiddleHandle,"resize")},__addContentNodes:function(nodes){var nds=this.nodes,k;for(k in nodes){nds[k]=nodes[k]}},__updateDragger:function(draggerConstructor){if(this.__dragger.constructor!==draggerConstructor){this.__dragger.removeEventListener("beforedrag",this.__beforeDragHandle).removeEventListener("drag",this.__dragHandle).removeEventListener("afterdrag",this.__afterDragHandle);this.__dragger.destroy();this.__dragger=new draggerConstructor}this.__dragger.setDrag(this.nodes.titleBar,this.__entity,false);this.__dragger.addEventListener("beforedrag",this.__beforeDragHandle).addEventListener("drag",this.__dragHandle).addEventListener("afterdrag",this.__afterDragHandle)},__updateDraggerArea:function(){var l,t,r,b;if(this.__isFixed){l=$IE6?document.documentElement.scrollLeft:0;t=$IE6?document.documentElement.scrollTop:0;r=$IE6?document.documentElement.scrollLeft+this.__getDocumentSize().width-this.width:this.__getDocumentSize().width-this.width;b=$IE6?document.documentElement.scrollTop+this.__getDocumentSize().height-this.height:this.__getDocumentSize().height-this.height}else{l=0;t=0;r=document.documentElement.scrollWidth-this.width;b=document.documentElement.scrollHeight-this.height}this.__dragger.setArea({left:l,top:t,right:r,bottom:b})},__initTitleBar:function(){if(!this.nodes.titleBar){return}var tb=this.nodes.titleBar;tb.style.cursor="move";if($IE){Core.Events.addEvent(tb,function(){return false},"selectstart")}else{tb.style.MozUserSelect="none"}},__getDocumentSize:function(){var w=document.documentElement.clientWidth||document.body.clientWidth,h=document.documentElement.clientHeight||document.body.clientHeight;return{width:w,height:h}}});Ui.ModuleDialog=function(tplConfig,iconSet,cfg){this.__bgShadow=null;this.__dialog=null;this.__isInitBgShadow=false;this.__tplConfig=tplConfig;this.__iconSet=iconSet;this.__dialogQueue=[];this.__zIndex=cfg&&cfg.zIndex||5e3;this.__cfg=cfg||{};this.__initDialogEvent()}.$define({alert:function(text,cfg){cfg=cfg||{};var dlg=this.__createMessageDialog(cfg.tplConfig||this.__tplConfig.alert,cfg);dlg.nodes.text&&(dlg.nodes.text.innerHTML=text||"");dlg.show(cfg.renderer||this.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});dlg.nodes.linkOk&&dlg.nodes.linkOk.style.display!=="none"&&dlg.nodes.linkOk.focus();return dlg},newAlert:function(text,cfg,name){cfg.tplConfig=this.__tplConfig.newAlert;this.alert(text,cfg,name)},confirm:function(text,cfg){cfg=cfg||{};var dlg=this.__createMessageDialog(cfg.tplConfig||this.__tplConfig.confirm,cfg),me=this;dlg.nodes.text&&(dlg.nodes.text.innerHTML=text||"");if(dlg.nodes.btnCancel){dlg.nodes.btnCancel.innerHTML=cfg.textCancel||"取消";Core.Events.addEvent(dlg.nodes.btnCancel,function(){cfg.funcCancel&&cfg.funcCancel.call(dlg);dlg.hidden(cfg.renderer||me.__cfg.renderer);Core.Events.stopEvent()},"click");dlg.nodes.linkCancel&&Core.Events.addEvent(dlg.nodes.linkCancel,function(){var e=Core.Events.getEvent();if(e.keyCode=="13"){cfg.funcCancel&&cfg.funcCancel.call(dlg);dlg.hidden(cfg.renderer||me.__cfg.renderer)}},"keydown")}dlg.show(cfg.renderer||me.__cfg.renderer).addEventListener("hidden",function(){this.destroy()});if(cfg.defaultButton==0){dlg.nodes.linkCancel&&dlg.nodes.linkCancel.style.display!=="none"&&dlg.nodes.linkCancel.focus()}else{dlg.nodes.linkOk&&dlg.nodes.linkOk.style.display!=="none"&&dlg.nodes.linkOk.focus()}return dlg},newConfirm:function(text,cfg,name){cfg.tplConfig=this.__tplConfig.newConfirm;this.confirm(text,cfg,name)},create:function(cfg){var me=this;cfg=cfg||{};var dlg=new Ui.Dialog;dlg.setTemplate(cfg.tpl||this.__tplConfig.customs);cfg.content&&dlg.setContent(cfg.content);cfg.width&&!isNaN(cfg.width)&&dlg.setSize({width:cfg.width});cfg.height&&!isNaN(cfg.height)&&dlg.setSize({height:cfg.height});return this.__initDialog(dlg,cfg)},__initDialogEvent:function(){var queue=this.__dialogQueue;Core.Events.addEvent(document,function(){var e=Core.Events.getEvent();if(queue.length&&e.keyCode=="27"){queue[queue.length-1].hidden()}},"keydown")},__createMessageDialog:function(tpl,cfg){var dlg=new Ui.Dialog,me=this,i;dlg.setTemplate(tpl);cfg.width&&!isNaN(cfg.width)&&dlg.setSize({width:cfg.width});cfg.height&&!isNaN(cfg.height)&&dlg.setSize({height:cfg.height});dlg.nodes.subText&&(dlg.nodes.subText.innerHTML=cfg.subText||"");if(dlg.nodes.icon){dlg.nodes.icon.className=this.__iconSet[cfg.icon||"01"]["class"];dlg.nodes.icon.alt=this.__iconSet[cfg.icon||"01"]["alt"]}if(dlg.nodes.btnOk){dlg.nodes.btnOk.innerHTML=cfg.textOk||"确定";Core.Events.addEvent(dlg.nodes.btnOk,function(){dlg.hidden(cfg.renderer||me.__cfg.renderer);cfg.funcOk&&cfg.funcOk.call(dlg);Core.Events.stopEvent()},"click")}dlg.nodes.linkOk&&Core.Events.addEvent(dlg.nodes.linkOk,function(){var e=Core.Events.getEvent();if(e.keyCode=="13"){dlg.hidden(cfg.renderer||me.__cfg.renderer);cfg.funcOk&&cfg.funcOk.call(dlg)}},"keydown");dlg.setDragger(cfg.dragger||me.__cfg.dragger).setFixed(true).setAreaLocked(true);return this.__initDialog(dlg,cfg)},__initDialog:function(dlg,cfg){var me=this;cfg.zIndex&&(me.__zIndex=cfg.zIndex);dlg.nodes.titleName&&(dlg.nodes.titleName.innerHTML=cfg.title||"提示");if(dlg.nodes.btnClose){Core.Events.addEvent(dlg.nodes.btnClose,function(){var isCanHidden=true;cfg.funcBeforeClose&&(isCanHidden=cfg.funcBeforeClose.call(dlg)!==false);cfg.funcClose&&cfg.funcClose.call(dlg);isCanHidden&&dlg.hidden()},"click");Core.Events.addEvent(dlg.nodes.btnClose,function(){Core.Events.stopEvent()},"mousedown")}dlg.setPosition({z:cfg.zIndex||me.__zIndex});dlg.setRenderer(cfg.renderer||this.__cfg.renderer);dlg.setDragger(cfg.dragger||this.__cfg.dragger);dlg.setMiddle();dlg.addEventListener("beforeHidden",function(){me.__updateDialogQueue(this,"remove")});dlg.addEventListener("beforeShow",function(){this.nodes.panel.parentNode.appendChild(this.nodes.panel);var that=this;if(!me.__isInitBgShadow){me.__initBGShadow(this,cfg.isAdamant||me.__cfg.isAdamant)}me.__setBGShadowOpacity(cfg.bgShadowOpacity!==0?cfg.bgShadowOpacity||.4:cfg.bgShadowOpacity);window.setTimeout(function(){me.__bgShadow.show();me.__updateDialogQueue(that,"add")},1)});dlg.setTitle=function(title){this.nodes.titleName&&(this.nodes.titleName.innerHTML=title)};dlg.setHelp=function(url){this.nodes.btnHelp&&(this.nodes.btnHelp.href=url)};dlg.close=function(){this.hidden()};dlg.getNodes=function(){return this.nodes};dlg.getX=function(){return this.x};dlg.getY=function(){return this.y};dlg.getWidth=function(){return this.width};dlg.getHeight=function(){return this.height};return dlg},__initBGShadow:function(dlg,isAdamant){var w=this.__getDocumentSize().width,h=this.__getDocumentSize().height,me=this;this.__bgShadow=new Ui.Panel;this.__bgShadow.setTemplate('<div id="#{panel}" style="background-color:black"></div>').setSize({width:w,height:h}).setAdamant(isAdamant).setFixed(true).setPosition({x:0,y:0,z:me.__zIndex});Core.Events.addEvent(window,function(){me.__bgShadow.setPosition({x:0,y:0}).setSize({width:me.__getDocumentSize().width,height:me.__getDocumentSize().height})},"resize");this.__isInitBgShadow=true},__updateDialogQueue:function(dialog,op){var i,dlg;if(op==="add"){this.__dialogQueue.push(dialog)}else if(op==="remove"){i=this.__dialogQueue.length;while(i--){this.__dialogQueue[i]===dialog&&this.__dialogQueue.splice(i,1)}}if(this.__dialogQueue.length===0){this.__bgShadow.hidden()}else{dlg=this.__dialogQueue[this.__dialogQueue.length-1];this.__bgShadow.nodes.panel.parentNode.insertBefore(this.__bgShadow.nodes.panel,dlg.nodes.panel);this.__bgShadow.__iframe&&this.__bgShadow.__iframe.parentNode.insertBefore(this.__bgShadow.__iframe,this.__bgShadow.nodes.panel);dlg.nodes.linkOk&&dlg.nodes.linkOk.style.display!=="none"&&dlg.nodes.linkOk.focus()}},__setBGShadowOpacity:function(v){v=isNaN(v)?0:Math.max(Math.min(v,1),0);Core.Dom.setStyle(this.__bgShadow.nodes.panel,"opacity",v)},__getDocumentSize:function(){var w=document.documentElement.clientWidth||document.body.clientWidth,h=document.documentElement.clientHeight||document.body.clientHeight;return{width:w,height:h}}});Ui.Transition={simple:function(t,b,c,d){return c*t/d+b},backEaseIn:function(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backEaseOut:function(t,b,c,d){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backEaseInOut:function(t,b,c,d){var s=1.70158;if((t/=d/2)<1){return c/2*(t*t*(((s*=1.525)+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},bounceEaseOut:function(t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}},bounceEaseIn:function(t,b,c,d){return c-Transition.bounceEaseOut(d-t,0,c,d)+b},bounceEaseInOut:function(t,b,c,d){if(t<d/2){return Transition.bounceEaseIn(t*2,0,c,d)*.5+b}else{return Transition.bounceEaseOut(t*2-d,0,c,d)*.5+c*.5+b}},regularEaseIn:function(t,b,c,d){return c*(t/=d)*t+b},regularEaseOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},regularEaseInOut:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return-c/2*(--t*(t-2)-1)+b},strongEaseIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},strongEaseOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},strongEaseInOut:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},elasticEaseIn:function(t,b,c,d){var a,p;if(t==0){return b}if((t/=d)==1){return b+c}p=d*.3;if(!a||a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},elasticEaseOut:function(t,b,c,d){var a,p;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*.3}if(!a||a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},elasticEaseInOut:function(t,b,c,d){var a,p;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){var p=d*(.3*1.5)}if(!a||a<Math.abs(c)){var a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}};Ui.TweenStrategy=function(startValue,endValue,duration,motion){this.startValue=startValue||0;this.endValue=endValue||0;this.duration=duration||0;this.motion=motion||Ui.Transition.simple;this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$define({motion:null,duration:0,startValue:0,endValue:0,_itvID:0,_isTweenning:false,addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},start:function(){if(this._isTweenning){return}this._isTweenning=true;var me=this,t,sv=this.startValue,ev=this.endValue,d=this.duration,value,startTime=(new Date).getTime();this._itvID=window.setInterval(function(){t=((new Date).getTime()-startTime)/1e3;t>me.duration&&(t=me.duration);value=me.motion(t,sv,ev-sv,d);me.onTween&&me.onTween(value);me.__eventDispatcher.dispatchEvent("tween",value);t==me.duration&&me.stop()},25);return this},stop:function(){window.clearInterval(this._itvID);this._isTweenning=false;this.onEnd&&this.onEnd();this.__eventDispatcher.dispatchEvent("end");return this},onTween:function(value){},onEnd:function(){}});Ui.OpacityRenderer=function(){this.__canShow=true;this.__canHidden=true;this.__node=null;this.__tween=new Ui.TweenStrategy(0,0,.6,Ui.Transition.strongEaseOut);this.__state="";this.__lastState="";this.__value=0;this.__node=null;this.__eventDispatcher=new Core.Events.EventDispatcher(this);this.__initTweenEvent()}.$implements(Ui.IRenderer).$define({setCanShow:function(state){this.__canShow=!!state},setCanHidden:function(state){this.__canHidden=!!state},show:function(node){var tn=this.__tween;tn.stop();Core.Dom.setStyle(node,"opacity",this.__value);node.style.display="";this.__node=node;this.__state="show";this.__eventDispatcher.dispatchEvent("beforeShow");if(this.__canShow){tn.startValue=this.__value;tn.endValue=1;tn.start()}return this},hidden:function(node){var tn=this.__tween;tn.stop();this.__node=node;this.__state="hidden";this.__eventDispatcher.dispatchEvent("beforeHidden");if(this.__canHidden){tn.startValue=this.__value;tn.endValue=0;tn.start()}return this},addEventListener:function(type,handle){this.__eventDispatcher.addEventListener(type,handle);return this},removeEventListener:function(type,handle){this.__eventDispatcher.removeEventListener(type,handle);return this},__initTweenEvent:function(){var me=this;this.__tween.addEventListener("tween",function(v){me.__value=v;Core.Dom.setStyle(me.__node,"opacity",v)});this.__tween.addEventListener("end",function(){me.__node&&me.__node.style.filter&&(me.__node.style.filter="");

if(me.__state!==""&&me.__state!==me.__lastState){me.__lastState=me.__state;me.__eventDispatcher.dispatchEvent(me.__state)}me.__state==="hidden"&&(me.__node.style.display="none")})}});Ui.BorderDragger=function(){this.__drag=null;this.__isBindEvent=false;this.__border=null;this.__dragNode=null;this.__isCreated=false;this.__tweenX=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut);this.__tweenY=new Ui.TweenStrategy(0,0,.5,Ui.Transition.strongEaseOut);this.__eventDispatcher=new Core.Events.EventDispatcher(this)}.$implements(Ui.IDragger).$define({addEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.addEventListener(type,handle)}else{this.__drag.addEventListener(type,handle)}return this},removeEventListener:function(type,handle){if(type.toLowerCase()==="afterdrag"){this.__eventDispatcher.removeEventListener(type,handle)}else{this.__drag.removeEventListener(type,handle)}return this},setDrag:function(node,attachNode,isDragCapureNode){if(!this.__isCreated){this.__createBorder(attachNode);this.__initTweenEvent(attachNode)}this.__drag=new Ui.Drag(node,this.__border,isDragCapureNode);this.__dragNode=attachNode;this.__initDragEvent();return this},setLock:function(state){this.__drag.isLock=!!state;return this},setArea:function(area){this.__drag.lockArea=area;return this},destroy:function(){this.__drag.destroy()},__createBorder:function(node){this.__border=$C("div");var st=this.__border.style;st.border="2px dashed #BCC4D0";st.position="absolute";st.display="none";st.backgroundColor="transparent";st.MozUserSelect="none";document.body.appendChild(this.__border);this.__isCreated=true},__initDragEvent:function(){if(this.__isBindEvent){return}var me=this,bst=this.__border.style,nst=this.__dragNode.style,twX=this.__tweenX,twY=this.__tweenY;this.__drag.addEventListener("beforeDrag",function(){bst.zIndex=nst.zIndex+1;bst.position=nst.position;bst.width=me.__dragNode.offsetWidth-4+"px";bst.height=me.__dragNode.offsetHeight-4+"px";bst.left=parseInt(nst.left)+"px";bst.top=parseInt(nst.top)+"px";bst.display=""});this.__drag.addEventListener("afterDrag",function(){if($IE6){nst.left=parseInt(bst.left)+"px";nst.top=parseInt(bst.top)+"px";bst.display="none";me.__eventDispatcher.dispatchEvent("afterDrag")}else{twX.startValue=parseInt(nst.left);twX.endValue=parseInt(bst.left);twY.startValue=parseInt(nst.top);twY.endValue=parseInt(bst.top);twX.start();twY.start()}});this.__isBindEvent=true},__initTweenEvent:function(node){var nst=node.style,bst=this.__border.style,me=this;this.__tweenX.addEventListener("tween",function(v){nst.left=v+"px"});this.__tweenY.addEventListener("tween",function(v){nst.top=v+"px"});this.__tweenX.addEventListener("end",function(){bst.display="none";me.__eventDispatcher.dispatchEvent("afterDrag")})}});var winDialog={};var DialogTemplate={};(function(){var dialogTemplates={alert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns_Mid"><a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newAlert:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),confirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示标题</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div id="#{content}" class="CP_layercon1">','<div class="CP_prompt">','<img id="#{icon}" class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle"/>','<table class="CP_w_ttl"><tr><td id="#{text}"></td></tr></table>','<div id="#{subText}" class="CP_w_cnt SG_txtb"></div>','<p class="CP_w_btns">','<a  id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnOk}"></cite></a>','<a style="margin-left:5px;" id="#{linkCancel}" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite id="#{btnCancel}"> <span id="#{cancel}"></span> </cite></a></p>',"</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),newConfirm:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid"><div class="bLyTop"><strong id="#{titleName}">提示</strong><cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite></div></th>','<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid">','<div class="CP_layercon2 pop_v">','<div class="v_prompt">','<img id="#{icon}" class="SG_icon SG_icon148" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="20" height="20" align="absmiddle" />','<div id="#{text}" class="v_cnt SG_txtb"></div>','<div id="#{subText}"></div>','<p class="v_btns">','<a id="#{linkOk}" class="SG_aBtn SG_aBtnB" href="#"><cite id="#{btnOk}">确定</cite></a>&nbsp;&nbsp;','<a id="#{linkCancel}" class="SG_aBtn SG_aBtnB SG_aBtn_g" href="#"><cite id="#{btnCancel}">取消</cite></a>',"</p>","</div>","</div>","</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),customs:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("")};var iconSet={"01":{"class":"SG_icon SG_icon201",alt:"警告"},"02":{"class":"SG_icon SG_icon202",alt:"失败"},"03":{"class":"SG_icon SG_icon203",alt:"成功"},"04":{"class":"SG_icon SG_icon204",alt:"询问"},"05":{"class":"SG_icon SG_bigLoading",alt:"正在加载"},"06":{"class":"SG_icon SG_icon148",alt:"警告"}};var dialogs={};var moduleDialog=new Ui.ModuleDialog(dialogTemplates,iconSet,{renderer:Ui.OpacityRenderer,dragger:Ui.BorderDragger,isAdamant:$IE6});winDialog.create=winDialog.createCustomsDialog=function(args,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.create(args);return dialogs[name]}else{return moduleDialog.create(args)}};winDialog.alert=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.alert(text,cfg);return dialogs[name]}else{return moduleDialog.alert(text,cfg)}};winDialog.newAlert=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.newAlert(text,cfg);return dialogs[name]}else{return moduleDialog.newAlert(text,cfg)}};winDialog.confirm=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.confirm(text,cfg);return dialogs[name]}else{return moduleDialog.confirm(text,cfg)}};winDialog.newConfirm=function(text,cfg,name){if(name&&typeof name==="string"){dialogs[name]=moduleDialog.newConfirm(text,cfg);return dialogs[name]}else{return moduleDialog.newConfirm(text,cfg)}};winDialog.getDialog=function(name){if(name&&typeof name==="string"){return dialogs[name]}};DialogTemplate=dialogTemplates})();Lib.invite_tpl=['<table id="#{entity}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="javascript:void(0)" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join("");Lib.Login.LoginPost=Core.Class.create();Lib.Login.LoginPost.prototype={url:"http://i.sso.sina.com.cn/js/ssologin.js",callback:null,initialize:function(callback,clearDomain,from){window.sinaSSOConfig=new function(){if(from){this.from=from}this.pageCharset="utf-8";this.noActiveTime=14400;this.setDomain=true;this.entry="boke";this.customInit=function(){};this.customLoginCallBack=callback;this.customLogoutCallBack=function(result){};this.useIframe=true}},login:function(username,password,time){var _this=this;if(typeof sinaSSOController=="undefined"||!sinaSSOController){trace("no sso");Utils.Io.JsLoad.request(this.url,{onComplete:function(){__login()},onException:function(){},timeout:3e4,isRemove:false})}else{trace("has sso");sinaSSOController.init();if(typeof sinaSSOController.setLoginType=="function"){sinaSSOController.setLoginType(2)}if(typeof sinaSSOController.getServerTime=="function"){}trace("init ok");__login()}function __login(){if(typeof time=="undefined"){sinaSSOController.login(username,password)}else{sinaSSOController.login(username,password,time)}}},parse:function(loginStatus){this.callback.call(loginStatus)}};Core.String.j2o=function(str){if(!str||str==""){return null}try{var o=window.eval("("+str+")");return o}catch(e){trace("j2o : 数据分析出错");traceError(e);return null}};Utils.Io.Ijax={arrTaskLists:[],createLoadingIframe:function(){if(this.loadFrames!=null){return false}var rndId1="loadingIframe_thread"+Math.ceil(Math.random()*1e4);var rndId2="loadingIframe_thread"+Math.ceil((Math.random()+1)*1e4);this.loadFrames=[rndId1,rndId2];var html='<iframe id="'+rndId1+'" name="'+rndId1+'" class="invisible"\r\n	              scrolling="no" src=""\r\n	              allowTransparency="true" style="display:none;" frameborder="0"\r\n	              ></iframe>\r\n				  <iframe id="'+rndId2+'" name="'+rndId2+'" class="invisible"\r\n	              scrolling="no" src=""\r\n	              allowTransparency="true" style="display:none;" frameborder="0"\r\n	              ></iframe>';var oIjaxIframeCnt=$C("div");oIjaxIframeCnt.id="ijax_iframes";oIjaxIframeCnt.innerHTML=html;trace("创建 Ijax 需要的 iframe");document.body.appendChild(oIjaxIframeCnt);var loadTimer=setInterval(Core.Function.bind2(function(){if($E(this.loadFrames[0])!=null&&$E(this.loadFrames[1])!=null){clearInterval(loadTimer);loadTimer=null;this.loadingIframe={thread1:{container:$E(this.loadFrames[0]),isBusy:false},thread2:{container:$E(this.loadFrames[1]),isBusy:false}};this.loadByList()}},this),10)},isIjaxReady:function(){if(typeof this.loadingIframe=="undefined"){return false}for(var oLoadCnt in this.loadingIframe){if(this.loadingIframe[oLoadCnt].isBusy==false){this.loadingIframe[oLoadCnt].isBusy=true;return this.loadingIframe[oLoadCnt]}}return false},request:function(url,option){var oTask={};oTask.url=url;oTask.option=option||{};this.arrTaskLists.push(oTask);if(this.loadFrames==null){this.createLoadingIframe()}else{this.loadByList()}},loadByList:function(){if(this.arrTaskLists.length==0){return false}var loadStatus=this.isIjaxReady();if(loadStatus==false){return false}var newData=this.arrTaskLists[0];this.loadData(newData.url,newData.option,loadStatus);this.arrTaskLists.shift()},loadData:function(url,option,loader){var _url=new Utils.Url(url);if(option.GET){for(var key in option.GET){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}if(!/\bdomain\b/.test(url)){_url.setParam("domain","1")}_url=_url.toString();var ifm=loader.container;ifm.listener=Core.Function.bind2(function(){try{var iframeObject=ifm.contentWindow.document,sResult;var tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];if(typeof tArea!="undefined"){sResult=tArea.value}else{sResult=iframeObject.body.innerHTML}if(option.onComplete){option.onComplete(sResult)}else{option.onException()}}catch(e){traceError(e);if(option.onException){option.onException(e.message,_url.toString())}}loader.isBusy=false;Core.Events.removeEvent(ifm,ifm.listener,"load");this.loadByList()},this);Core.Events.addEvent(ifm,ifm.listener,"load");if(option.POST){var oIjaxForm=$C("form");oIjaxForm.id="IjaxForm";oIjaxForm.action=_url;oIjaxForm.method="post";oIjaxForm.target=ifm.id;for(var oItem in option.POST){var value;if(option.noEncode){value=Core.String.encodeDoubleByte(option.POST[oItem])}else{value=option.POST[oItem]}var oInput=$C("input");oInput.type="hidden";oInput.name=oItem;oInput.value=value;oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);oIjaxForm.submit()}else{try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}}};Utils.Io.Ajax={createRequest:function(){var request=null;try{request=new XMLHttpRequest}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(othermicrosoft){try{request=ActiveXObject("Microsoft.XMLHTTP")}catch(failed){}}}if(request==null){}else{return request}},request:function(url,option){option=option||{};option.onComplete=option.onComplete||function(){};option.onException=option.onException||function(){};option.returnType=option.returnType||"txt";option.method=option.method||"get";option.data=option.data||{};if(typeof option.GET!="undefined"&&typeof option.GET.url_random!="undefined"&&option.GET.url_random==0){this.rand=false;option.GET.url_random=null}return this.loadData(url,option)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE){response=request.responseXML}else{var Dparser=new DOMParser;response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response)}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}return request}};if($IE6&&typeof Utils.Io.Ijax!="undefined"){Utils.Io.Ijax.loadData=function(url,option,loader){var _url=new Utils.Url(url);if(option.GET){for(var key in option.GET){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}if(!/\bdomain\b/.test(url)){_url.setParam("domain","1")}_url=_url.toString();var ifm=loader.container;ifm.listener=Core.Function.bind2(function(){try{var iframeObject=ifm.contentWindow.document,sResult;var tArea=Core.Dom.byClz(iframeObject,"textarea","")[0];if(typeof tArea!="undefined"){sResult=tArea.value}else{sResult=iframeObject.body.innerHTML}if(option.onComplete){option.onComplete(sResult)}else{option.onException()}}catch(e){traceError(e);if(option.onException){option.onException(e.message,_url.toString())}}loader.isBusy=false;Core.Events.removeEvent(ifm,ifm.listener,"load");this.loadByList()},this);Core.Events.addEvent(ifm,ifm.listener,"load");if(option.POST){var oIjaxForm=$C("form");oIjaxForm.id="IjaxForm";oIjaxForm.action=_url;oIjaxForm.method="post";oIjaxForm.target=ifm.id;for(var oItem in option.POST){var value;if(option.noEncode){value=Core.String.encodeDoubleByte(option.POST[oItem])}else{value=option.POST[oItem]}var oInput=$C("input");oInput.type="hidden";oInput.name=oItem;oInput.value=value;oIjaxForm.appendChild(oInput)}document.body.appendChild(oIjaxForm);var timenum=100;function innerfun(){if(timenum>0){try{oIjaxForm.submit()}catch(e){setTimeout(innerfun,10)}}timenum--}innerfun()}else{try{window.frames(ifm.id).location.href=_url}catch(e){ifm.src=_url}}}}var Interface=function(url,type){this.url=new Utils.Url(url);this.type=type.toLowerCase()};Interface.prototype={url:null,type:"",request:function(option){var err=option.onError;var suc=option.onSuccess;option.onComplete=option.onSuccess=function(result){try{if(typeof result=="string"){result=result.replace(/;$/,"")}result=typeof result=="string"&&/\s*{/.test(result)?Core.String.j2o(result):result;if(result!=null&&typeof result.code=="undefined"){trace("接口数据异常："+this.url,"#F00");return}if(result!=null){if(result.code=="A00006"){suc(result.data)}else{err(result)}}else{err(result)}}catch(e){traceError(e)}}.bind2(this);option.onException=option.onError=option.onFail||function(){trace("接口失败："+this.url,"#F00");if(arguments.length>0){for(var i=0,len=arguments.length;i<len;i++){if(arguments[i]&&typeof arguments[i]!="undefined"){trace("错误信息："+arguments[i].toString())}}}}.bind2(this);var requestURL=this.url.toString();switch(this.type){case"ijax":Utils.Io.Ijax.request(requestURL,option);break;case"ajax":Utils.Io.Ajax.request(requestURL,option);break;case"script":case"jsload":Utils.Io.JsLoad.request(requestURL,option);break;default:throw new Error("未指定有效的数据传输类型")}}};var $SYSMSG={};$SYSMSG.extend=function(info,override){for(var i in info){$SYSMSG[i]=!!override==false?info[i]:$SYSMSG[i]}};$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"请先登录。",A20101:"内容超长。",A20102:"请输入正确的登录名或密码。",A20103:"请输入正确的验证码。",A20104:"请把对方在黑名单中解除，再加为好友。",A20105:"你的好友数量达到上限，不能添加新好友。",A20106:"博主已设置为拒绝接受好友邀请，请不要打扰哦。",A20107:"不能加自己为好友。",A20108:"你们已经是好友。",A20109:"不能包含sina等特殊含义字符。",A23002:"您已被对方加入黑名单。",A20121:"参数格式不正确。",A20000:"参数格式不正确。",A20001:"内容超长。",A20002:"请输入正确的登录名或密码。",A20003:"请输入正确的验证码。",A20004:"不能包含sina等特殊含义字符。",A20005:"纸条内容不能为空。",A20006:"不能自己给自己发纸条",A20007:"请把对方在黑名单中解除，再发送纸条。",A20020:"给#{nick}的纸条发送失败！",A20008:"对不起，您短时间发表的纸条过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20999:"对不起，您短时间发送的好友请求过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注!",A20009:"博主已设置为拒绝接收所有纸条，请不要打扰哦。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",A20015:"发生错误，请稍作休息~",A30006:"该博主只接收来自好友的纸条，您还不是Ta的好友哦。",A10006:"对不起，您已被博主列入黑名单，无法发送小纸条。"});Core.Dom.getStyle=function(el,property){switch(property){case"opacity":var val=100;try{val=el.filters["DXImageTransform.Microsoft.Alpha"].opacity}catch(e){try{val=el.filters("alpha").opacity}catch(e){}}return val/100;case"float":property="styleFloat";default:var value=el.currentStyle?el.currentStyle[property]:null;return el.style[property]||value}};if(!$IE||$IE>8){Core.Dom.getStyle=function(el,property){if(property=="float"){property="cssFloat"}try{var computed=document.defaultView.getComputedStyle(el,"")}catch(e){traceError(e)}return el.style[property]||computed?computed[property]:null}}Core.System.getScrollPos=function(oDocument){oDocument=oDocument||document;var dd=oDocument.documentElement;var db=oDocument.body;return[Math.max(dd.scrollTop,db.scrollTop),Math.max(dd.scrollLeft,db.scrollLeft),Math.max(dd.scrollWidth,db.scrollWidth),Math.max(dd.scrollHeight,db.scrollHeight)]};Core.Dom.getXY=function(el){if((el.parentNode==null||el.offsetParent==null||Core.Dom.getStyle(el,"display")=="none")&&el!=document.body){return false}var parentNode=null;var pos=[];var box;var doc=el.ownerDocument;box=el.getBoundingClientRect();var scrollPos=Core.System.getScrollPos(el.ownerDocument);return[box.left+scrollPos[1],box.top+scrollPos[0]];parentNode=el.parentNode;while(parentNode.tagName&&!/^body|html$/i.test(parentNode.tagName)){if(Core.Dom.getStyle(parentNode,"display").search(/^inline|table-row.*$/i)){pos[0]-=parentNode.scrollLeft;pos[1]-=parentNode.scrollTop}parentNode=parentNode.parentNode}return pos};if(!$IE){Core.Dom.getXY=function(el){if((el.parentNode==null||el.offsetParent==null||Core.Dom.getStyle(el,"display")=="none")&&el!=document.body){return false}var parentNode=null;var pos=[];var box;var doc=el.ownerDocument;pos=[el.offsetLeft,el.offsetTop];parentNode=el.offsetParent;var hasAbs=Core.Dom.getStyle(el,"position")=="absolute";if(parentNode!=el){while(parentNode){pos[0]+=parentNode.offsetLeft;pos[1]+=parentNode.offsetTop;if($SAFARI&&!hasAbs&&Core.Dom.getStyle(parentNode,"position")=="absolute"){hasAbs=true}parentNode=parentNode.offsetParent}}if($SAFARI&&hasAbs){pos[0]-=el.ownerDocument.body.offsetLeft;pos[1]-=el.ownerDocument.body.offsetTop}parentNode=el.parentNode;while(parentNode.tagName&&!/^body|html$/i.test(parentNode.tagName)){if(Core.Dom.getStyle(parentNode,"display").search(/^inline|table-row.*$/i)){pos[0]-=parentNode.scrollLeft;pos[1]-=parentNode.scrollTop}parentNode=parentNode.parentNode}return pos}}Core.System.winSize=function(_target){var w,h;if(_target){target=_target.document}else{target=document}if(self.innerHeight){if(_target){target=_target.self}else{target=self}w=target.innerWidth;h=target.innerHeight}else if(target.documentElement&&target.documentElement.clientHeight){w=target.documentElement.clientWidth;h=target.documentElement.clientHeight}else if(target.body){w=target.body.clientWidth;h=target.body.clientHeight}return{width:w,height:h}};Core.System.pageSize=function(_target){if(_target){target=_target.document}else{target=document}var _rootEl=target.compatMode=="CSS1Compat"?target.documentElement:target.body;var xScroll,yScroll;if(window.innerHeight&&window.scrollMaxY){xScroll=_rootEl.scrollWidth;yScroll=window.innerHeight+window.scrollMaxY}else if(_rootEl.scrollHeight>_rootEl.offsetHeight){xScroll=_rootEl.scrollWidth;yScroll=_rootEl.scrollHeight}else{xScroll=_rootEl.offsetWidth;yScroll=_rootEl.offsetHeight}var win_s=Core.System.winSize(_target);if(yScroll<win_s.height){pageHeight=win_s.height}else{pageHeight=yScroll}if(xScroll<win_s.width){pageWidth=win_s.width}else{pageWidth=xScroll}return[pageWidth,pageHeight,win_s.width,win_s.height]};(function(){function LazyLoad(oObjects,oOptions){this.node=oObjects;this.config=oOptions;for(var key in this.defaultConfig){this.config[key]=this.defaultConfig[key]}this.initialize();return this}LazyLoad.prototype={defaultConfig:{preloadPixel:500},initialize:function(){this.viewableHeight=LazyLoadListener.getViewableHeight();LazyLoadListener.enrol(this)},callback:function(nHeight){if(this.node.length==0){return}this.viewableHeight=nHeight||this.viewableHeight;var remanent=[];for(var i=0,len=this.node.length;i<len;i++){if(this.node[i]&&this.node[i].dom==null&&Core.Dom.getXY(this.node[i])[1]<this.viewableHeight+this.config.preloadPixel){this.config.callback(this.node[i]);this.node[i]=null}else if(this.node[i]&&this.node[i].dom&&Core.Dom.getXY(this.node[i].dom)[1]<this.viewableHeight+this.config.preloadPixel){this.node[i].callback(this.node[i].dom);this.node[i]=null}else{remanent.push(this.node[i])}}this.node=remanent}};var LazyLoadListener={_isInit:null,_binder:null,_isWindow:null,_member:[],initialize:function(){var container=window,isWindow=container==window||container==document||!container.tagName||/^(?:body|html)$/i.test(container.tagName);if(isWindow){var doc=container.document;container=doc.compatMode=="CSS1Compat"&&($IE||$FF||$OPERA)?doc.documentElement:doc.body}this._container=container;this._binder=isWindow?window:container;this._isWindow=isWindow;this._isInit=true;this.delayResize();this.bindEvent()},getViewableHeight:function(){var eyeableHeight=LazyLoadListener._container.scrollTop+Core.System.winSize().height;this.eyeableHeight=eyeableHeight;return eyeableHeight},bindEvent:function(){if(!this._isInit){this.initialize();return}Core.Events.addEvent(this._binder,LazyLoadListener.delayLoad,"scroll");if(this._isWindow){Core.Events.addEvent(this._binder,LazyLoadListener.delayResize,"resize")}this.binded=true},unbindEvent:function(){Core.Events.removeEvent(LazyLoadListener._binder,LazyLoadListener.delayLoad,"scroll");if(this._isWindow){Core.Events.removeEvent(LazyLoadListener._binder,LazyLoadListener.delayResize,"resize")}this.binded=false},delayLoad:function(){if(LazyLoadListener.scrollWatch){clearTimeout(LazyLoadListener.scrollWatch)}LazyLoadListener.scrollWatch=setTimeout(function(){LazyLoadListener.callback();clearTimeout(LazyLoadListener.scrollWatch);LazyLoadListener.scrollWatch=null},100)},delayResize:function(){if(LazyLoadListener.resizeWatch){clearTimeout(LazyLoadListener.resizeWatch)}LazyLoadListener.resizeWatch=setTimeout(function(){LazyLoadListener.callback();clearTimeout(LazyLoadListener.resizeWatch);LazyLoadListener.resizeWatch=null},100)},enrol:function(oLazy){LazyLoadListener._member.push(oLazy)},callback:function(){LazyLoadListener.getViewableHeight();if(LazyLoadListener._member.length>0){for(var i=0,len=LazyLoadListener._member.length;i<len;i++){LazyLoadListener._member[i].callback(LazyLoadListener.eyeableHeight)}}if(LazyLoadListener.eyeableHeight==Core.System.pageSize()[1]){LazyLoadListener.unbindEvent()}}};Lib.LazyLoad=function(oObjects,oOptions){if(LazyLoadListener.binded!=true){LazyLoadListener.bindEvent(oObjects,oOptions)}new LazyLoad(oObjects,oOptions)}})();var Layer=function(template){this.entity=null;this.ifm=null;var _this=this;var Property={width:0,height:0,x:0,y:0,isFixed:false,uniqueID:"",entityID:"",contentID:"",template:template,templateString:"",nodes:{}};this.getProperty=function(){return Property};(function initialize(){var p=_this.getProperty();p.uniqueID="_"+_this.getUniqueID();p.entityID=p.uniqueID+"_entity";p.contentID=p.uniqueID+"_content";_this.setTemplate(p.template);p.width=parseInt(_this.entity.style.width);if($IE6){_this.addIframe()}document.body.appendChild(_this.entity);_this.hidden()})();this._ie6Fixed=function(){_this.entity.style.left=document.documentElement.scrollLeft+_this.getProperty().x+"px";_this.entity.style.top=document.documentElement.scrollTop+_this.getProperty().y+"px";if(_this.ifm){_this.ifm.style.left=document.documentElement.scrollLeft+_this.getProperty().x+"px";_this.ifm.style.top=document.documentElement.scrollTop+_this.getProperty().y+"px"}}};Layer.prototype={setTemplate:function(template){var p=this.getProperty();if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}if(typeof template=="object"){p.nodes=template;if(this.entity){this.entity.parentNode.removeChild(this.entity);this.entity=null}this.entity=p.nodes.entity;document.body.appendChild(this.entity);if(!p.nodes.entity||!p.nodes.content){throw new Error("[layer.js] missing entity or content in layer nodes")}else{this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=p.x+"px";this.entity.style.top=p.y+"px"}return}var pattern=/[^\{\}]+(?=\})/g;p.template=template;p.templateString=p.template.match(pattern);this.entity=$C("div");var tempEntity=$C("div");var tmp=new Ui.Template(p.template);tempEntity.innerHTML=tmp.evaluate(this.getNodes("i"));document.body.appendChild(tempEntity);if(!$E(p.entityID)||!$E(p.contentID)){throw new Error("[layer.js] there missing #{entityID} or #{contentID} in layer template")}else{this.entity=$E(p.entityID);this.entity.style.position="absolute";this.entity.style.zIndex="1024";this.entity.style.left=p.x+"px";this.entity.style.top=p.y+"px";document.body.replaceChild(this.entity,tempEntity);tempEntity=null}p.nodes=this.getNodes()},setSize:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts);if(opts.width){p.nodes.content.style.width=p.width+"px"}if(opts.height){p.nodes.content.style.height=p.height+"px"}this.updateIfmSize()},setPosition:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts);this.entity.style.left=p.x+"px";this.entity.style.top=p.y+"px";if($IE6&&p.isFixed){this.entity.style.left=p.x+document.documentElement.scrollLeft+"px";this.entity.style.top=p.y+document.documentElement.scrollTop+"px"}if(this.ifm){this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top}},getWidth:function(){var ld=this.entity.style.display;var lv=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";w=this.entity.offsetWidth;this.entity.style.display=ld;this.entity.style.visibility=lv;return w},getHeight:function(){var ld=this.entity.style.display;var lv=this.entity.style.visibility;this.entity.style.visibility="hidden";this.entity.style.display="";h=this.entity.offsetHeight;this.entity.style.display=ld;this.entity.style.visibility=lv;return h},getX:function(){return parseInt(this.entity.style.left)},getY:function(){return parseInt(this.entity.style.top)},updateIfmSize:function(){if(this.ifm){var _this=this;_this.ifm.style.width=_this.entity.offsetWidth+"px";_this.ifm.style.height=_this.entity.offsetHeight+"px"}},setFixed:function(isFixed){var p=this.getProperty();p.isFixed=isFixed;var _this=this;if($IE6){_this.entity.style.position="absolute";if(p.isFixed){_this._ie6Fixed();Core.Events.addEvent(window,_this._ie6Fixed,"scroll")}else{Core.Events.removeEvent(window,_this._ie6Fixed,"scroll")}return}if(p.isFixed&&$FF2){_this.updateFixed();return}this.entity.style.position=p.isFixed?"fixed":"absolute"},updateFixed:function(){var p=this.getProperty();if(p.isFixed&&$FF2){var _this=this;var lastX=p.x,lastY=p.y;_this.entity.style.position="absolute";_this.setPosition({x:p.x+document.documentElement.scrollLeft,y:p.y+document.documentElement.scrollTop});_this.entity.style.position="fixed";_this.setPosition({x:lastX,y:lastY})}},show:function(){this.entity.style.display="";if(this.ifm){this.ifm.style.display="";this.updateIfmSize()}},hidden:function(){this.entity.style.display="none";

if(this.ifm){this.ifm.style.display="none"}},addIframe:function(){this.ifm=$C("iframe");this.ifm.style.position="absolute";this.ifm.style.zIndex="1024";this.ifm.style.left=this.entity.style.left;this.ifm.style.top=this.entity.style.top;document.body.appendChild(this.ifm);Core.Dom.setStyle(this.ifm,"opacity",0)},getNodes:function(mode){var p=this.getProperty();var m=mode||"o";var i;var nodes={};var result=p.templateString;if(result){for(i=0;i<result.length;i++){var r=result[i];switch(m){case"o":nodes[r]=$E(p.uniqueID+"_"+r);break;case"i":nodes[r]=p.uniqueID+"_"+r;break}}}return"entity"in nodes?nodes:p.nodes},getUniqueID:function(){return parseInt(Math.random()*1e4).toString()+(new Date).getTime().toString()},setContent:function(sHTML){var p=this.getProperty();if(sHTML){p.nodes.content.innerHTML=sHTML}}};(function(){var transitions={simple:function(time,startValue,changeValue,duration){return changeValue*time/duration+startValue},backEaseIn:function(t,b,c,d){var s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},backEaseOut:function(t,b,c,d,a,p){var s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},backEaseInOut:function(t,b,c,d,a,p){var s=1.70158;if((t/=d/2)<1){return c/2*(t*t*(((s*=1.525)+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+b},bounceEaseOut:function(t,b,c,d){if((t/=d)<1/2.75){return c*(7.5625*t*t)+b}else if(t<2/2.75){return c*(7.5625*(t-=1.5/2.75)*t+.75)+b}else if(t<2.5/2.75){return c*(7.5625*(t-=2.25/2.75)*t+.9375)+b}else{return c*(7.5625*(t-=2.625/2.75)*t+.984375)+b}},bounceEaseIn:function(t,b,c,d){return c-transitions.bounceEaseOut(d-t,0,c,d)+b},bounceEaseInOut:function(t,b,c,d){if(t<d/2){return transitions.bounceEaseIn(t*2,0,c,d)*.5+b}else{return transitions.bounceEaseOut(t*2-d,0,c,d)*.5+c*.5+b}},strongEaseInOut:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},regularEaseIn:function(t,b,c,d){return c*(t/=d)*t+b},regularEaseOut:function(t,b,c,d){return-c*(t/=d)*(t-2)+b},regularEaseInOut:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return-c/2*(--t*(t-2)-1)+b},strongEaseIn:function(t,b,c,d){return c*(t/=d)*t*t*t*t+b},strongEaseOut:function(t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},strongEaseInOut:function(t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},elasticEaseIn:function(t,b,c,d,a,p){if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*.3}if(!a||a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},elasticEaseOut:function(t,b,c,d,a,p){if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*.3}if(!a||a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},elasticEaseInOut:function(t,b,c,d,a,p){if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){var p=d*(.3*1.5)}if(!a||a<Math.abs(c)){var a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b}};var getUniqueID=function(oNode){return oNode.uniqueID};if(!$IE){getUniqueID=function(oNode){try{var rnd_ID;if(oNode.getAttribute("uniqueID")==null){rnd_ID="moz__id"+parseInt(Math.random()*100)+"_"+(new Date).getTime();oNode.setAttribute("uniqueID",rnd_ID);return rnd_ID}return oNode.getAttribute("uniqueID")}finally{rnd_ID=null}}}function getType(oObject){try{var s=oObject.constructor.toString().toLowerCase();return s.slice(s.indexOf("function")+9,s.indexOf("()"))}finally{s=null}}function getStartValue(oNode,aProperty){var i,_len,_arr=[];_len=aProperty.length;for(i=0;i<_len;i++){_arr[_arr.length]=parseFloat(Core.Dom.getStyle(oNode,aProperty[i]))}return _arr}function formatProperty(oProperty){return getType(oProperty)!="array"?[oProperty]:oProperty}function formatValue(oEndingValue,aProperty){try{var _type=getType(oEndingValue);var _valuearray=[],_suffixarray=[],i,_len,_suffix;if(_type!="array"){_suffix=getSuffix(oEndingValue);_suffix[1]=aProperty=="opacity"?"":_suffix[1];_valuearray=[_suffix[0]];_suffixarray=[_suffix[1]]}else{_len=oEndingValue.length;for(i=0;i<_len;i++){_suffix=getSuffix(oEndingValue[i]);_suffix[1]=aProperty[i]=="opacity"?"":_suffix[1];_valuearray[_valuearray.length]=_suffix[0];_suffixarray[_suffixarray.length]=_suffix[1]}}return[_valuearray,_suffixarray]}finally{_type=_valuearray=_suffixarray=i=_len=_suffix=null}}function getSuffix(sValue){try{var charCase=/(-?\d.?\d*)([a-z%]*)/i.exec(sValue);return[charCase[1],charCase[2]?charCase[2]:"px"]}finally{charCase=null}}var runList={};var saveList={};function getInstance(oNode){try{var uID=getUniqueID(oNode);var runFunc;if(runList[uID]!=true){runFunc=new ancestor;saveList[uID]={node:oNode,func:runFunc};runList[uID]=true;return runFunc}else{return saveList[uID].func}}finally{uID=runFunc=null}}function ancestor(){this._timer=null}ancestor.prototype.start=function(oNode,oProperty,oEndingValue,nSeconds,sAnimation,oFunc){this.reset();oFunc=oFunc||{};if(oFunc.before){this._func.before=oFunc.before}if(oFunc.end){this._func.end=oFunc.end}if(oFunc.tween){this._func.tween=oFunc.tween}var _propertyArr=formatProperty(oProperty);var _startValueArr=getStartValue(oNode,_propertyArr);var _endValueArr=formatValue(oEndingValue,_propertyArr);this._node=oNode;this._property=_propertyArr;this._endingvalue=_endValueArr[0];this._suffixvalue=_endValueArr[1];this._startvalue=_startValueArr;this._end=false;this._fps=0;if(nSeconds!=null){this._seconds=nSeconds}if(transitions[sAnimation]!=null){this._animation=transitions[sAnimation]}this._starttime=(new Date).getTime();this._func.before();this._timer=setInterval(Core.Function.bind3(this.play,this),10)};ancestor.prototype.play=function(){var nTime=((new Date).getTime()-this._starttime)/1e3;var i,ani,_len=this._property.length;if(nTime>this._seconds){nTime=this._seconds}for(i=0;i<_len;i++){ani=this._animation(nTime,this._startvalue[i],this._endingvalue[i]-this._startvalue[i],this._seconds);Core.Dom.setStyle(this._node,this._property[i],ani+this._suffixvalue[i])}this._fps++;this._func.tween();if(nTime==this._seconds){this.stop()}};ancestor.prototype.stop=function(){clearInterval(this._timer);this._end=true;this._func.end()};ancestor.prototype.reset=function(){clearInterval(this._timer);this._end=false;this._node=null;this._property=[];this._startvalue=[];this._endingvalue=[];this._suffixvalue=[];this._fps=0;this._seconds=.5;this._animation=transitions.simple;this._func={end:function(){},tween:function(){},before:function(){}}};function tween(oNode,oProperty,oEndingValue,nSeconds,sAnimation,oFunc){var instance=getInstance(oNode);instance.start.apply(instance,arguments)}tween.stop=function(oNode){getInstance(oNode).stop()};tween.isTween=function(oNode){return!getInstance(oNode)._end};Ui.tween=tween})();var DialogDisplaySet={alpha1:{show:function(dom,offsetY,callBack){var v=0,deltaY=0,startY=parseInt(dom.style.top)-offsetY;dom.style.top=startY;Core.Dom.setStyle(dom,"opacity",v);dom.style.display="";var itvId=window.setInterval(function(){if(v<=1){Core.Dom.setStyle(dom,"opacity",v)}if(deltaY<=startY+offsetY){dom.style.top=startY+deltaY+"px"}deltaY+=1.5;v+=.05;if(v>.9&&parseInt(dom.style.top)>=startY+offsetY){window.clearInterval(itvId);if(callBack){callBack()}}},10)},hidden:function(dom,offsetY,callBack){var v=1;var startY=parseInt(dom.style.top);var endY=startY-offsetY;var currentY=startY;var itvId=window.setInterval(function(){if(v>=0){Core.Dom.setStyle(dom,"opacity",v)}if(currentY>=endY){dom.style.top=currentY+"px"}currentY-=1.5;v-=.05;if(v<=0&&currentY<endY){window.clearInterval(itvId);if(callBack){callBack()}}},10)}},alpha:{show:function(dom,offsetY,callBack){Core.Dom.setStyle(dom,"opacity",.3);dom.style.display="";dom.style.top=parseInt(dom.style.top)-offsetY+"px";var y1=parseInt(dom.style.top)+offsetY;Ui.tween(dom,["top","opacity"],[y1,.9],.4,"simple",{end:callBack})},hidden:function(dom,offsetY,callBack){var y1=parseInt(dom.style.top)-offsetY;Ui.tween(dom,["top","opacity"],[y1,0],.2,"simple",{end:callBack})}},fallDown:{show:function(dom,y0,y1,callBack){dom.style.display="";dom.style.top=y0+"px";Ui.tween(dom,"top",y1,.6,"bounceEaseOut",{end:callBack})},hidden:function(dom,y0,y1,callBack){dom.style.display="";dom.style.top=y0+"px";Ui.tween(dom,"top",y1,.6,"strongEaseIn",{end:callBack})}}};Core.Events.fixEvent=function(e){if(typeof e=="undefined")e=window.event;if(!e.target){e.target=e.srcElement;e.pageX=e.x;e.pageY=e.y}if(typeof e.layerX=="undefined")e.layerX=e.offsetX;if(typeof e.layerY=="undefined")e.layerY=e.offsetY;return e};var Drag3=function(beDragObj,movedObjs,dragMode){var _this=this;this.beDragObj=beDragObj;this.movedObjs=movedObjs||this.beDragObj;this.dragMode=dragMode||"normal";this.canDrag=true;this.isLock=false;this.lockArea={left:0,right:0,top:0,bottom:0};this.dragSet={normal:function(){_this.normalDrag()},border:function(){_this.borderDrag()},opacity:function(){_this.opacityDrag()}};this.dragObjsFunc=function(){_this.onDrag();_this.dragObjs()};(function initialize(){_this.beDragObj.style.MozUserSelect="none";Core.Events.addEvent(_this.beDragObj,function(){return false},"selectstart");Core.Events.addEvent(_this.beDragObj,function(){return false},"drag");for(var i=0;i<_this.movedObjs.length;i++){if(_this.movedObjs[i]!=_this.beDragObj){_this.movedObjs[i].style.position="absolute";if(!_this.movedObjs[i].style.left){_this.movedObjs[i].style.left=_this.movedObjs[i].offsetLeft+"px"}if(!_this.movedObjs[i].style.top){_this.movedObjs[i].style.top=_this.movedObjs[i].offsetTop+"px"}}}Core.Events.addEvent(_this.beDragObj,_this.dragSet[_this.dragMode],"mousedown");if($IE){Core.Events.addEvent(_this.beDragObj,function(){Core.Events.removeEvent(_this.beDragObj,_this.dragObjsFunc,"mousemove");_this.beDragObj.releaseCapture();_this.onDragEnd()},"mouseup")}else{Core.Events.addEvent(document,function(){Core.Events.removeEvent(document,_this.dragObjsFunc,"mousemove");_this.onDragEnd()},"mouseup")}})()};Drag3.prototype={capture:function(){this.canDrag=true},release:function(){this.canDrag=false},onDragStart:function(){},onDrag:function(){},onDragEnd:function(){},dragObjs:function(){e=Core.Events.getEvent();for(var i=0;i<this.movedObjs.length;i++){if(this.isLock){if(e.clientX-this.movedObjs[i].deltaX<this.lockArea.left){this.movedObjs[i].style.left=this.lockArea.left+"px"}else{if(e.clientX-this.movedObjs[i].deltaX>this.lockArea.right-this.movedObjs[i].offsetWidth){this.movedObjs[i].style.left=this.lockArea.right-this.movedObjs[i].offsetWidth+"px"}else{this.movedObjs[i].style.left=e.clientX-this.movedObjs[i].deltaX+"px"}}if(e.clientY-this.movedObjs[i].deltaY<this.lockArea.top){this.movedObjs[i].style.top=this.lockArea.top+"px"}else{if(e.clientY-this.movedObjs[i].deltaY>this.lockArea.bottom-this.movedObjs[i].offsetHeight){this.movedObjs[i].style.top=this.lockArea.bottom-this.movedObjs[i].offsetHeight+"px"}else{this.movedObjs[i].style.top=e.clientY-this.movedObjs[i].deltaY+"px"}}}else{this.movedObjs[i].style.left=e.clientX-this.movedObjs[i].deltaX+"px";this.movedObjs[i].style.top=e.clientY-this.movedObjs[i].deltaY+"px"}}},normalDrag:function(){var _this=this;e=Core.Events.getEvent();for(var i=0;i<_this.movedObjs.length;i++){_this.movedObjs[i].deltaX=e.clientX-parseInt(_this.movedObjs[i].style.left);_this.movedObjs[i].deltaY=e.clientY-parseInt(_this.movedObjs[i].style.top)}if(_this.canDrag){if($IE){_this.beDragObj.setCapture();Core.Events.addEvent(_this.beDragObj,_this.dragObjsFunc,"mousemove")}else{Core.Events.addEvent(document,_this.dragObjsFunc,"mousemove")}}_this.onDragStart()},borderDrag:function(obj,borderWidth){},opacityDrag:function(obj,opacityValue){}};Ui.Drag3=Drag3;var Dialog=function(template){var _this=this;_this.entity=null;_this.ifm=null;var Property={id:"",x:0,y:0,width:0,height:0,isFixed:false,layer:new Layer(template),template:template,canDrag:false,dragEntity:null,name:"",uniqueID:"",isShow:false,nodes:{},focusNode:null,displayMode:"normal",_modeDisplayRuning:false,enabled:true};this.getProperty=function(){return Property};(function initialize(){var p=_this.getProperty();var i;p.uniqueID=p.layer.getProperty().uniqueID;p.id=p.uniqueID+"_dialog";p.nodes=_this.getNodes();_this.entity=p.layer.entity;_this.ifm=p.layer.ifm;p.width=parseInt(_this.entity.style.width);if(p.nodes.titleBar){p.dragEntity=new Ui.Drag3(p.nodes.titleBar,_this.ifm?[_this.ifm,_this.entity]:[_this.entity]);p.nodes.titleBar.style.cursor="move";Core.Events.addEvent(p.nodes.titleBar,function(){return false},"selectstart");p.dragEntity.onDrag=function(){_this.onDrag()}}Core.Events.addEvent(window,function(){if(p.isShow&&p.isFixed){var win=Core.System.winSize();var _x=win.width/2-_this.getWidth()/2;var _y=win.height/2-_this.getHeight()/2;_x=_x<0?0:_x;_y=_y<0?0:_y;_this.setPosition({x:_x,y:_y})}},"resize")})()};Dialog.prototype={setPosition:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts);this.getProperty().layer.setPosition(opts)},setSize:function(opts){var p=this.getProperty();Core.System.parseParam(p,opts);p.layer.setSize(opts)},setFixed:function(isFixed){var p=this.getProperty();p.isFixed=isFixed;this.getProperty().layer.setFixed(p.isFixed)},setContent:function(sHTML){var p=this.getProperty();this.getProperty().layer.setContent(sHTML)},setTemplate:function(template){var p=this.getProperty();p.template=template;p.layer.setTemplate(p.template)},setDrag:function(canDrag){var p=this.getProperty();p.canDrag=canDrag;if(p.canDrag){p.dragEntity.capture()}else{p.dragEntity.release()}},getWidth:function(){return this.getProperty().layer.getWidth()},getHeight:function(){return this.getProperty().layer.getHeight()},getX:function(){return this.getProperty().layer.getX()},getY:function(){return this.getProperty().layer.getY()},show:function(mode){var p=this.getProperty();var _this=this;p.isShow=true;if(this.ifm){this.ifm.style.display=""}this.onShow();if(p.displayMode=="normal"||mode=="normal"){this.entity.style.display=""}else{p._modeDisplayRuning=true;p.enabled=false;this._showWithMode(function(){p._modeDisplayRuning=false;p.enabled=true;if(_this.onDisplaied){_this.onDisplaied()}})}},close:function(mode){var _this=this;var p=this.getProperty();if(p.displayMode=="normal"||mode=="normal"){p.isShow=false;p.layer.hidden();this.destroy();this.onClose();if(_this.onDisplayFinished){_this.onDisplayFinished()}}else if(!p._modeDisplayRuning){p._modeDisplayRuning=true;p.enabled=false;this._hiddenWithMode(function(){p.isShow=false;p.layer.hidden();p._modeDisplayRuning=false;p.enabled=true;_this.destroy();_this.onClose();if(_this.onDisplayFinished){_this.onDisplayFinished()}})}},hidden:function(mode){var _this=this;var p=this.getProperty();if(p.displayMode=="normal"||mode=="normal"){p.isShow=false;p.layer.hidden();this.onHidden();if(_this.onDisplayFinished){_this.onDisplayFinished()}}else if(!p._modeDisplayRuning){p._modeDisplayRuning=true;p.enabled=false;this._hiddenWithMode(function(){p.isShow=false;p.layer.hidden();_this.onHidden();p._modeDisplayRuning=false;p.enabled=true;if(_this.onDisplayFinished){_this.onDisplayFinished()}})}},_showWithMode:function(callBack){var p=this.getProperty();var win=Core.System.winSize();var _this=this;switch(p.displayMode){case"alpha":DialogDisplaySet["alpha"].show(this.entity,20,callBack);break}},_hiddenWithMode:function(callBack){var p=this.getProperty();var _this=this;var win=Core.System.winSize();switch(p.displayMode){case"alpha":DialogDisplaySet["alpha"].hidden(this.entity,20,callBack);break}},destroy:function(){try{if(this.getProperty().nodes.iframe){this.getProperty().nodes.iframe.src=""}}catch(ex){}this.entity&&this.entity.parentNode.removeChild(this.entity);this.entity=null;if(this.ifm){this.ifm.parentNode.removeChild(this.ifm);this.ifm=null}},onShow:function(){},onClose:function(){},onHidden:function(){},onDrag:function(){},onDisplaied:function(){},onDisplayFinished:function(){},setAreaLocked:function(state){var p=this.getProperty();p.dragEntity.isLock=state;var _this=this;if(state){_this._updateLockArea();Core.Events.addEvent(window,function(){_this._updateLockArea()},"resize")}},_updateLockArea:function(){var p=this.getProperty();var win=Core.System.winSize();if(p.isFixed){if($IE6){p.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+win.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+win.height};Core.Events.addEvent(window,function(){p.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+win.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+win.height}},"scroll");Core.Events.addEvent(window,function(){p.dragEntity.lockArea={left:document.documentElement.scrollLeft,right:document.documentElement.scrollLeft+win.width,top:document.documentElement.scrollTop,bottom:document.documentElement.scrollTop+win.height}},"resize")}else{p.dragEntity.lockArea={left:0,right:win.width,top:0,bottom:win.height}}}else{p.dragEntity.lockArea={left:0,right:document.documentElement.scrollWidth,top:0,bottom:document.documentElement.scrollHeight}}},updateFixed:function(){this.getProperty().layer.updateFixed()},getNodes:function(mode){return this.getProperty().layer.getNodes(mode)},setFocus:function(){var p=this.getProperty();if(p.focusNode&&p.focusNode.style.display!="none"){try{p.focusNode.focus()}catch(ex){}}else if(this.entity.style.display!="none"){this.entity.focus()}},getUniqueID:function(){return this.getProperty().layer.getUniqueID()}};Core.Array.ArrayWithout=function(){if(arguments.length<2){return arguments.length==1?arguments[0]:null}var results=[];var aa=arguments[0];if(aa===null||aa.constructor!=Array){return null}if(arguments[1].constructor==Array){var args=[];args[0]=aa;Core.Array.foreach(arguments[1],function(v,i){args[i+1]=v})}else{args=arguments}for(var i=0;i<aa.length;i++){var isWithout=true;for(var j=1;j<args.length;j++){if(aa[i]==args[j]){isWithout=false;break}}if(isWithout){results.push(aa[i])}}return results};Lib.register("util.LS",function(lib){var ls;var Storage=function(wnd,undefined){var localStorageName="data-sina-blog-storage",localStorageKeys="data-sina-blog-storage-keys",doc=wnd.document,storageContainer=doc.createElement("input"),length,keys,removeArray=Core.Array.ArrayWithout,mark=function(key,isRemove,temp,reg){storageContainer.load(localStorageName);temp=storageContainer.getAttribute(localStorageKeys)||"";reg=RegExp("\\b"+key+"\\b,?","i");var hasKey=reg.test(temp)?1:0;temp=isRemove?temp.replace(reg,""):hasKey?temp:temp===""?key:temp.split(",").concat(key).join(",");storageContainer.setAttribute(localStorageKeys,temp);storageContainer.save(localStorageName)};var box=document.body||document.getElementsByTagName("head")[0]||document.documentElement;storageContainer.id="____storage_container_box";storageContainer.type="hidden";box.appendChild(storageContainer);storageContainer.addBehavior("#default#userData");storageContainer.load(localStorageName);var keyStr=storageContainer.getAttribute(localStorageKeys);keys=keyStr?keyStr.split(","):[];length=keys.length;return{key:function(index){if(isNaN(index)){index=0}return keys[parseInt(index,10)]},getItem:function(key){storageContainer.load(localStorageName);return storageContainer.getAttribute(key)},setItem:function(key,value){storageContainer.setAttribute(key,value);storageContainer.save(localStorageName);this.length++;keys.push(key);mark(key)},removeItem:function(key){storageContainer.removeAttribute(key);storageContainer.save(localStorageName);this.length--;removeArray(keys,key);mark(key,1)},clear:function(){storageContainer.load(localStorageName);var attrs=storageContainer.getAttribute(localStorageKeys).split(","),len=attrs.length;if(attrs[0]==="")return;for(var i=0;i<len;i++){storageContainer.removeAttribute(attrs[i]);storageContainer.save(localStorageName)}storageContainer.setAttribute(localStorageKeys,"");storageContainer.save(localStorageName);this.length=0},length:length}};var getStorage=function(wnd){if(wnd.localStorage){return wnd.localStorage}else if(wnd.sessionStorage){return wnd.sessionStorage}else if(wnd.globalStorage){return wnd.globalStorage}else{return Storage(wnd)}};var getLS=function(){if(!ls){ls=getStorage(window)}return ls};return{key:function(index){return getLS().key(index)},getItem:function(key){return getLS().getItem(key)},setItem:function(key,value){try{getLS().setItem(key,value);return true}catch(e){return false}},removeItem:function(key){return getLS().removeItem(key)},clear:function(){return getLS().clear()}}});$SYSMSG.extend({A00001:"系统繁忙，请稍候再试。",A00007:"未登录。",A00004:"系统繁忙，请稍候再试。",A00112:"博客名称超长。",A00113:"您已开通博客，请点击<a href='http://control.blog.sina.com.cn/blogprofile/index.php'>个人中心</a>进入。",A00116:"不能包含 sina 等有特殊含义的字符。",A11003:"此账户已完成博客快速设置，点击确定，直接进入博客。",A44001:"博客个性地址不能为空。",A44002:"地址格式不对。",A44003:"抱歉，此地址已被占用。",A44005:"抱歉，请按照正确格式填写博客地址。"});(function(){if(scope.blogOpener){scope.addBlogOpenerEvent=function(){};return}var openURL="http://control.blog.sina.com.cn/riaapi/reg/open_blog.php";var openBlog=function(){this._hasInit=false};openBlog.prototype={getCon:function(){var checkcodeHTML=['<div class="boxA" style="margin: 20px 0; overflow: hidden; zoom: 1;">','<div id="checkCodeBox_open_msg" class="check-code-box clearfix" > </div>',"</div>"].join("");return['<div class="CP_layercon8">'+'<div class="nowOpenBlog">'+"<strong>您的博客尚未开通,仅一步操作就能开通您的个人博客</strong>"+'<div class="boxA">'+"<label>博客名称：</label>"+'<input id="blogNameInput_t" type="text" class="ipt" />'+'<img style="display:none" id="blogNameIcon_t" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" class="SG_icon SG_icon49 tips">'+'<p id="blogNameError_t" class="tip">名称不能为空</p>'+"</div>"+'<div  class="boxA"> '+"<p>隐私设置："+'<input type="radio" name="isPrivate_t" checked id="openAll1_t" class="rd" /><label for="openAll1_t">对所有人开放</label>'+'<input type="radio" name="isPrivate_t" id="openMe1_t" class="rd" /><label for="openMe1_t">仅对自己开放，私密博客</label>'+"</p>"+"</div>"+checkcodeHTML+'<div id="ErrTips_t" class="ErrTips">系统繁忙，请稍后再试</div>'+'<div class="boxB">'+'<p><a id="openBlogOkBtn_t" class="btn" href="javascript:void(0)">完成开通</a><a id="openBlogCancel" href="javascript:void(0)">取消</a></p>'+"</div>"+"</div>"+"</div>"].join("")},_initDialog:function(){Lib.checkAuthor();this.key=getKeyName();this._dialog=winDialog.createCustomsDialog({content:this.getCon()},"openblog");var checkCodeBox_open_msg={id:"#checkCodeBox_open_msg"};checkManager_open_msg=new Lib.checkManager(checkCodeBox_open_msg);this.bindEvent();blogNameEvent($E("blogNameInput_t"),$E("blogNameError_t"),[],$E("blogNameIcon_t"))},showDialog:function(callBack,needToOpen,forceOpen){needToOpen=needToOpen||false;if(!this._hasInit){this._initDialog();this._hasInit=true}var me=this;scope.whenOpenBlogCallback=callBack;if(!scope.hasOpenBlog){trace("这是一位后登陆的用户");var t=0;var timmer=setInterval(function(){trace("呀，怎么还没有出结果啊--"+t);if(scope.hasOpenBlog){clearInterval(timmer);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{trace("他们没有开通博客");me._showDialog(needToOpen)}}t++;if(t==10){Lib.checkAuthor();trace("等不及了，自己发吧。。。");clearInterval(timmer);new Interface("http://control.blog.sina.com.cn/riaapi/profile/unread.php","jsload").request({GET:{uid:$UID,product:"blog"},onSuccess:function(data){scope.hasOpenBlog=data.isbloguser==1?"open":"no";trace("~~~~~~~~~~~~~~~~~~~"+scope.hasOpenBlog);if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");me._showDialog(needToOpen)}}})}},10)}else{trace("这是已登陆的用户");if(scope.hasOpenBlog=="open"){trace("并且他开通的博客");if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback()}}else{if(!$E("openblogcss")){Utils.Io.loadCss({id:"openblogcss",url:$_GLOBAL.cssBasicURL+"module/layer/re_nowopen.css"})}trace("他们没有开通博客");this._showDialog(needToOpen)}}if(forceOpen){$E("openBlogCancel").style.display="none";this._dialog.getNodes().btnClose.style.display="none"}},_showDialog:function(needToOpen){$E("blogNameInput_t").value=getShotName();hiddenError($E("blogNameError_t"),$E("blogNameIcon_t"));$E("ErrTips_t").style.visibility="hidden";$E("blogNameIcon_t").style.display="none";this._dialog.show();this._dialog.setAreaLocked(true);this._dialog.setMiddle()},bindEvent:function(){var me=this;Core.Events.addEvent($E("openBlogCancel"),function(){me.closeDialog();return false});Core.Events.addEvent($E("openBlogOkBtn_t"),function(){if(!checkManager_open_msg.validate()){if(!$E("comment_check_img")){winDialog.alert("请拖动滑块儿开始验证")}else{winDialog("验证码不能为空")}return}whenOpenBlog({nameErrorEle:$E("blogNameError_t"),nameOkIcon:$E("blogNameIcon_t"),openName:$E("blogNameInput_t").value||getShotName(),isprivate:$E("openAll1_t").checked?0:1,errorEle:$E("ErrTips_t"),from:"floatingLayer",okCallback:function(res,blogInfo){if(scope.whenOpenBlogCallback){scope.whenOpenBlogCallback(res,blogInfo)}if($E("openedBlogTray")&&$E("openedBlogTray").style.display=="none"){$E("outOfOpenBlogTray").style.display="none";$E("noOpenedBlogTray").style.display="none";$E("openedBlogTray").style.display=""}if($E("noOpendBlogSearchTip")&&$E("noOpendBlogSearchTip").style.display=="block"){$E("noOpendBlogSearchTip").style.display="none";$E("opendBlogSearchTip").style.display="block"}scope.hasOpenBlog="open";me.closeDialog();scope.whenOpenBlogCallback=function(){}}});return false})},closeDialog:function(){var me=this;this._dialog.hidden()}};function getShotName(){var val=$nick;var nameLen=Core.String.byteLength(val);while(nameLen>18){val=val.substring(0,val.length-1);nameLen=Core.String.byteLength(val)}return val+"的博客"}scope.openBlogGetShotName=getShotName;function blogNameEvent(inputEle,errEle,optArr,icon){inputEle.onfocus=function(){inputEle.className="ipt focus";styleThey(optArr,"");icon.style.display=""};inputEle.onblur=function(){inputEle.className="ipt";checkBlogName(inputEle,errEle,icon);styleThey(optArr,"none")};inputEle.onkeyup=function(){checkBlogName(inputEle,errEle,icon)}}scope.openBlogNameEvent=blogNameEvent;function whenOpenBlog(opt){if(whenOpenBlog.requestComplete===false){return}if(opt.nameErrorEle.innerHTML){changeTextBgC(opt.nameErrorEle.parentNode);setTimeout(function(){changeTextBgC(opt.nameErrorEle.parentNode)},442);return}var targetButtonId=opt.from==="floatingLayer"?"openBlogOkBtn_t":"openBlogOkBtn";$E(targetButtonId).className="loading";var blogInfo={loginName:getKeyName(),blogName:opt.openName};var my_data={uid:$UID,loginname:blogInfo.loginName,blogname:blogInfo.blogName,version:7,src:"layer",isprivate:opt.isprivate};var data_my=checkManager_open_msg.getPostData(my_data);new Interface(openURL,"jsload").request({GET:data_my,onSuccess:function(res){whenOpenBlog.requestComplete=true;$E(targetButtonId).className="btn";opt.okCallback(res,blogInfo);blogInfo=null},onError:function(res){var nameErr=$E("blogNameError"),nameIcon=$E("blogNameIcon"),layerNameErr=$E("blogNameError_t"),layerNameIcon=$E("blogNameIcon_t");switch(res.code){case"A11008":if(nameErr&&nameIcon){showError(nameErr,"输入内容有误，请修改",nameIcon)};if(layerNameErr&&layerNameIcon){showError(layerNameErr,"输入内容有误，请修改",layerNameIcon)};break;case"A11010":if(nameErr&&nameIcon){showError(nameErr,"输入内容有误，请修改",nameIcon)};if(layerNameErr&&layerNameIcon){showError(layerNameErr,"输入内容有误，请修改",layerNameIcon)};break;case"B36002":winDialog.alert("验证码错误，请修改。");break;default:showError(opt.errorEle,"系统繁忙，请稍后再试。");break}whenOpenBlog.requestComplete=true;$E(targetButtonId).className="btn"}})}scope.openBlogWhenOpenBlog=whenOpenBlog;function changeTextBgC(ele){for(var i=1;i<=55;i++){(function(val){setTimeout(function(){ele.style.backgroundColor="rgb(255, "+ +(200+val)+", "+(200+val)+")"},val*8)})(i)}}function getKeyName(){var key=decodeURIComponent(Utils.Cookie.getCookie("SUP"));key=key.split("&name=")[1];key=decodeURIComponent(key.split("&")[0]);return key}function styleThey(eleArr,str){for(var i=0;eleArr[i];i++){eleArr[i].style.display=str}}function checkBlogName(inputEle,errEle,icon){var val=inputEle.value;if(/^(?:\s|[　])+|(?:\s|[　])+$/.test(val)){inputEle.value=Core.String.trim(val);val=inputEle.value}if(val){var nameLen=Core.String.byteLength(val);if(nameLen>24){showError(errEle,"博客名称超长",icon)}else{hiddenError(errEle,icon)}}else{showError(errEle,"博客名称不能为空",icon)}}function showError(ele,str,icon){ele.innerHTML=str;ele.style.display="block";if(ele.id.indexOf("ErrTips")>=0){ele.style.visibility="visible"}if(icon){icon.className="SG_icon SG_icon48 tips"}}function hiddenError(ele,icon){ele.innerHTML="";ele.style.display="none";if(icon){icon.className="SG_icon SG_icon49 tips"}}scope.blogOpener=new openBlog;scope.addBlogOpenerEvent=function(el){Core.Events.addEvent(el,function(e){scope.blogOpener.showDialog(function(res,blogInfo){Lib.LocalDB.clearCache(1,"uid_"+$UID+"unread");Lib.util.LS.removeItem("uid"+$UID);if(scope.$pageid=="fakeIndex"){window.location.href="http://i.blog.sina.com.cn/blogprofile/index.php?atten=1";return}if($E("openedBlogTray")){$E("openedBlogTray").style.display="";$E("noOpenedBlogTray").style.display="none";$E("outOfOpenBlogTray").style.display="none";if(blogInfo){$E("loginBarAppMenuLabel").innerHTML=blogInfo.loginNick}}else{var wnd=window;wnd.$tray&&wnd.$tray.renderLogin()}var successOpenFun=function(){if(scope.___importV){scope.___importV();scope.___openBlogFlag=1}};var alertConf={subText:!scope.___importV?['<div class="CP_w_cnt SG_txtb">欢迎您在新浪博客安家！除了写博客，看博客外，您还可以进入个人中心完善您的个人资料，更有很多有趣的应用等着您哦。</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php" onclick="winDialog.getDialog(\'unregister\').hidden();" target="_blank">到博客个人中心&gt;&gt;</a></li>',"</ul>"].join(""):"",icon:"03",funcOk:successOpenFun,funcClose:successOpenFun,width:300};winDialog.alert("开通博客成功",alertConf,"unregister");var commentNickEl=$E("commentNick");if(commentNickEl){var child=commentNickEl.firstChild;while(child){commentNickEl.removeChild(child);child=commentNickEl.firstChild}commentNickEl.innerHTML=blogInfo.loginNick+":"}},true)},"click")}})();Lib.register("blogv.getVHTML",function(){return function(wtype,isLinked){var title,className;if(isNaN(wtype)){wtype=-1}else{wtype=parseInt(wtype,10)}if(0==wtype){title="新浪个人认证";className=" SG_icon146"}else if(0<wtype&&8>wtype){title="新浪机构认证";className=" SG_icon147"}var str;if(!1!==isLinked){isLinked=!0}if(title){str='<img class="SG_icon '+className+'" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="15" height="15" title="'+title+'" alt="'+title+'" align="absmiddle" />'}else{str=""}if(str&&isLinked){str='<a target="_blank" href="http://blog.sina.com.cn/v/verify">'+str+"</a>"}return str}});var Lib=Lib||{};(function(proxy){var Builder=function(domJson,box){this.box=null;this.domList={};this.actList={};if(box){this.box=box}else{this.box=document.createElement("DIV")}if(domJson){this.makeTree(this.box,domJson)}};(function(_p){_p.init=function(){};_p.disp=function(){};_p.NODEMAP={AREA:"MAP",CAPTION:"TABLE",COL:"TABLE|COLGROUP",COLGROUP:"TABLE",LEGEND:"FIELDSET",OPTGROUP:"SELECT",OPTION:"SELECT",PARAM:"OBJECT",TBODY:"TABLE",TD:"TR",TFOOT:"TABLE",TH:"TABLE|TR",THEAD:"TABLE",TR:"TBODY|THEAD|TH|TFOOT"};_p.create=function(tagName,attributes){var dom=null;if(tagName=="TEXT"){dom=document.createTextNode(attributes)}else{dom=document.createElement(tagName)}if(typeof attributes=="object"){for(var k in attributes){switch(k){case"class":dom.className=attributes[k];break;case"id":this.domList[attributes[k]]=dom;break;case"action":if(this.actList[attributes[k]]){this.actList[attributes[k]]=[dom].concat(this.actList[attributes[k]])}else{this.actList[attributes[k]]=dom}break;case"style":dom.style.cssText=attributes[k];break;case"innerHTML":dom.innerHTML=attributes[k];break;case"nodeValue":dom.nodeValue=attributes[k];break;default:dom.setAttribute(k,attributes[k])}}}return dom;

};_p.check=function(parent,childObj){var tnames=this.NODEMAP[childObj.tagName];if(this.NODEMAP[childObj.tagName]){var pList=tnames.split("|");for(var i=0,len=pList.length;i<len;i++){if(parent.tagName==pList[i]){return true}}return false}return true};_p.append=function(parent,childObj){childObj.tagName=childObj.tagName.toLocaleUpperCase();if(!this.check(parent,childObj)){return false}var returnDom=this.create(childObj.tagName,childObj.attributes);parent.appendChild(returnDom);return returnDom};_p.makeTree=function(parent,objList){for(var i=0,len=objList.length;i<len;i++){var Leaves=this.append(parent,objList[i]);if(!Leaves){alert("tree wrong!!!");return false}if(objList[i].childList&&objList[i].childList.length){this.makeTree(Leaves,objList[i].childList)}}}})(Builder.prototype);proxy.Builder=Builder;proxy.domBuilder=new Builder})(Lib);var CommentV2={};CommentV2.Geetest=Core.Class.create();CommentV2.Geetest.prototype={geetestObj:null,node:"",options:{type:"float"},initialize:function(node,options){if(options){this.options=options}this.node=node||"";this.load()},reqGeetestAuth:function(){var _this=this;var url="http://control.blog.sina.com.cn/riaapi/StartCaptchaServlet.php";Utils.Io.JsLoad.request(url,{GET:{rand:Math.round(Math.random()*100)},returnType:"json",onComplete:function(res){if(res.code==="A00006"&&res.data.success===1){_this.loadGeetest(res.data)}else if(res.data.success===2){if(!window.scope){window.scope={}}window.scope.check_code_type="old"}}})},loadGeetest:function(config){var _this=this;_this.geetestObj=new window.Geetest({product:_this.options.type||"float",gt:config.gt,challenge:config.challenge,offline:!config.success,sandbox:true});_this.geetestObj.appendTo(_this.node)},load:function(){var _this=this;if(!window.Geetest){s=document.createElement("script");s.src="http://api.geetest.com/get.php?callback=gtcallback";document.body.appendChild(s);window.gtcallback=function(){_this.reqGeetestAuth()}}else{_this.reqGeetestAuth()}}};Core.Events.fireEvent=function(oElement,sEvent){var evt;oElement=$E(oElement);if(oElement.fireEvent){oElement.fireEvent("on"+sEvent)}else{if($MOBILE){evt=document.createEvent("HTMLEvents")}else{evt=document.createEvent("MouseEvents")}evt.initEvent(sEvent,true,true);oElement.dispatchEvent(evt)}};!function(window){if(window.Evter){return}function toJson(str){try{return new Function("return "+str)()}catch(e){return null}}var _handlers={},_needlock={},_busy={},_eid=1;window.Evter={add:function(ename,handler){if(typeof ename==="string"&&typeof handler==="function"){if(ename.charAt(0)==="-"){ename=ename.substr(1);_needlock[ename]=true}if(_handlers[ename]){traceError('Evter handler "'+ename+'" has been defined!');return}_handlers[ename]=handler}},click:function(elem,ename,handler){var curname=elem.getAttribute("e-name"),cdr=elem.getElementsByTagName("*"),i=cdr.length;while(i--){cdr[i].getAttribute("e-name")||cdr[i].setAttribute("e-name","b")}if(curname){if((" "+curname+" ").indexOf(" "+ename+" ")===-1){elem.setAttribute("e-name",curname+" "+ename)}}else{elem.setAttribute("e-name",ename)}if(handler){this.add(ename,handler)}},remove:function(ename){delete _handlers[ename];delete _needlock[ename]},fire:function(ename,eTarget,event,eSource){if(_needlock[ename]&&eTarget){eTarget.$EID||(eTarget.$EID=" "+_eid++);if(_busy[ename+eTarget.$EID]){return}_busy[ename+eTarget.$EID]=true}var handler=_handlers[ename];handler&&handler(eTarget,event,eSource)},data:function(elem,data){var edata=elem.getAttribute("e-data"),type=typeof data;if(type==="undefined"||data===null){return edata?toJson(edata):null}else if(type==="object"){var k,v;if(edata){edata=toJson(edata);if(typeof edata==="object"){for(k in data){edata[k]=data[k]}}else{edata=data}}else{edata=data}data=[];for(k in edata){v=edata[k];data.push(k+":"+(typeof v==="string"?"'"+v.replace(/'/g,"\\'")+"'":v))}data="{"+data.join(",")+"}"}else if(type==="string"){data="'"+data.replace(/'/g,"\\'")+"'"}elem.setAttribute("e-data",data)},free:function(eTarget,ename){eTarget&&delete _busy[ename+eTarget.$EID]}};Core.Events.addEvent(document.body,function(event){event=event||window.event;var eSource=event.target||event.srcElement,eTarget=eSource,ename=eTarget.getAttribute("e-name");if(ename==="b"){do{eTarget=eTarget.parentNode;ename=eTarget.getAttribute("e-name")}while(ename==="b")}if(ename){if(_needlock[ename]){eTarget.$EID||(eTarget.$EID=" "+_eid++);if(_busy[ename+eTarget.$EID]){return}_busy[ename+eTarget.$EID]=true}var handler=_handlers[ename];if(handler){handler(eTarget,event,eSource)}else{var enames=ename.split(" "),i=0,len=enames.length;for(;i<len;i++){ename=enames[i];if(_needlock[ename]){eTarget.$EID||(eTarget.$EID=" "+_eid++);if(_busy[ename+eTarget.$EID]){continue}_busy[ename+eTarget.$EID]=true}handler=_handlers[ename];handler&&handler(eTarget,event,eSource)}}}},"click")}(window);Lib.imgCheck=function(){this.imgSrc="http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?";this.fresh_chk=false;this.events=["img_check_post"];this.init()};Lib.imgCheck.prototype={init:function(){this.render();this.bindEvent()},render:function(){var html=["<span>验证码：</span>",'<input type="text" style="width: 46px;" id="login_check" tabindex="4" onclick="return false;" />&nbsp;&nbsp;','<a class="SG_linka" id="check_show">请点击后输入验证码</a>','<img id="comment_check_img" align="absmiddle" style="display:none;" />&nbsp;&nbsp;','<a id="comment_get_vcode" href="#" onclick="return false;">收听验证码</a>'].join("");$E("checkCodeBox").innerHTML=html},bindEvent:function(){var self=this;Core.Events.addEvent("check_show",function(){self.refresh()},"click");Core.Events.addEvent("comment_check_img",function(){self.fresh_chk=false;self.refresh()},"mousedown");Core.Events.addEvent("login_check",function(){self.refresh()},"focus");Core.Events.addEvent("commentArea",function(){self.refresh()},"focus");Core.Events.addEvent($E("login_check"),function(){Evter.fire("img_check_post")},"keydown")},refresh:function(){if(this.fresh_chk){return}$E("comment_check_img").src=this.imgSrc+(new Date).valueOf();$E("comment_check_img").style.display="inline";$E("check_show").style.display="none";this.fresh_chk=true},getValidate:function(){return Core.String.trim($E("login_check").value)}};Lib.AudioCheck={};var random="";if(window.$Maxthon||window.$360||window.$TT){random="?t="+(new Date).getTime()}Lib.AudioCheck.swfUrl=$_GLOBAL.flashBasicURL+"mp3.swf"+random;Lib.AudioCheck.soundUrl="http://interface.blog.sina.com.cn/riaapi/cksound/cksound.php";Lib.AudioCheck.render=function(target,soundUrl){$E(target).innerHTML='		<a style="margin-left:3px;" id="comment_get_vcode" href="javascript:;" onclick="Lib.AudioCheck.callAudioCheck();return false;">收听验证码</a>		<img id="play_img" name="play_img" src="http://image2.sina.com.cn/blog/tmpl/v3/images/blank.gif" align="absmiddle" style="margin-right:2px;" height="15">		<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=5,0,0,0" width="0" height="0" id="mp3_player" align="middle">		<param name="allowScriptAccess" value="always" />		<param name="movie" value="'+this.swfUrl+'" />		<param name="quality" value="high" />		<param name="bgcolor" value="#ffffff" />		<param name="FlashVars" value="mp3URL='+soundUrl+'" />		<embed src="'+this.swfUrl+'" FlashVars="mp3URL='+soundUrl+'" quality="high" bgcolor="#ffffff" width="0" height="0" name="mp3_player" swLiveConnect="true" align="middle" allowScriptAccess="always" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer"/>		</object>	'};Lib.AudioCheck.callAudioCheck=function(){setTimeout(function(){$E("play_img").src="http://blogimg.sinajs.cn/v5images/play_img.gif";window.document.mp3_player.SetVariable("isPlay","1");$E("login_check").value="";$E("login_check").focus()},500);var url="http://comet.blog.sina.com.cn/api?maintype=hits&act=3&uid=00000203";Utils.Io.JsLoad.request(url,{onComplete:function(){}})};$SYSMSG.extend({B36001:"操作失败，此博文不存在或被删除。",B36002:"验证码错误，请重新输入。",B36003:"请输入昵称。",B36004:"登录名或密码错误。",B36005:"呢称不能使用此类特殊词汇，请重新输入。",B36006:"昵称必须是8个中文或16个字符以内，且不能为纯数字，请重新输入。",B36007:"呢称不能使用此类特殊词汇，请重新输入。",B36008:"不能3秒内连续发评论，请梢后再试。",B36009:"不能发内容重复的评论。",B36020:"暂无评论。",B36021:"暂无评论。",B36022:"评论内容必须是1000中文或2000字符以内，请重新输入。",B36023:"对不起，黑名单已达到上限",B36024:"对方拒绝了你的评论。",B36031:"操作失败，此评论不存在或被删除。",B36032:"操作失败，此评论不存在或被删除。",B36033:"操作失败，此评论不存在或被删除。",B36041:"请输入回复内容。",B36042:"回复内容必须是1000中文或2000字符以内，请重新输入。",B36043:"操作失败，自己不能回复自己的评论。",B36101:"操作失败，此博文不存在或被删除。",B36102:"评论发布失败，此博文设置不允许评论。",B36103:"操作失败，此评论不存在或被删除。",B36104:"评论已发布，需要审核后才能显示，请稍候…",B36113:"博主已关闭匿名评论，请登录后再评论",B36105:"请输入评论内容。",B36106:"请输入验证码。",B36107:"请输入登录名。",B36108:"请输入密码。",B36109:"读取中，请稍候…",B36110:"读取失败，请刷新。",B36111:"确定要删除此评论吗？删除后不可恢复。",B36112:"确定要删除此回复吗？删除后不可恢复。",B36115:"请拖动滑块儿开始验证",B36201:"确定要删除此评论吗？删除后不可恢复。",B36202:"确定要删除此回复吗？删除后不可恢复。",B36203:"请选择要删除的内容。",B36204:"已回复该评论，请勿重复提交。",B36998:"系统维护中，服务暂不可用。",B36999:"对不起，您短时间发表的留言过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",36999:"对不起，您短时间发表的留言过多，请多休息会，注意身体！感谢您对新浪博客的支持和关注！",B90001:"抱歉，该文章不允许评论。",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~",B36205:"请登录后在回复评论",B36206:"对不起，您已被对方列入黑名单，无法发评论。",B36207:"请登录后在删除评论",B36208:"评论内容必须是140中文或280字符以内，请重新输入",B36209:"此条评论已被原博主删除",B36210:"博主已关闭评论功能",B36211:"此博文已被博主设为私密",A00004:"此评论不存在或已被博主删除"});Core.Dom.insertAfter=function(newElement,targetElement){var parent=targetElement.parentNode;if(parent.lastChild==targetElement){parent.appendChild(newElement)}else{parent.insertBefore(newElement,targetElement.nextSibling)}return newElement};Core.Dom.wrap=function(elm,tagName){var wrapper=$C(tagName);Core.Dom.insertAfter(wrapper,elm);wrapper.appendChild(elm);return wrapper};Lib.checkManager=function(obj){this.checkObj=null;this.init(obj)};Lib.checkManager.prototype={init:function(obj_int){var self=this;if(obj_int&&obj_int.id){this.geetest=new CommentV2.Geetest(obj_int.id)}else{this.geetest=new CommentV2.Geetest("#checkCodeBox")}var geetestHD=setInterval(function(){if(self.geetest.geetestObj){clearInterval(geetestHD);self.checkObj=self.geetest.geetestObj;self.checkObj.onReady(function(){if(self.geetest.options.type==="float"){var gt_hoder=Core.Dom.byClz(document,"div","gt_holder");gt_hoder[gt_hoder.length-1].style.zIndex="9999"}})}else if(scope.check_code_type==="old"){clearInterval(geetestHD);this.checkObj=new Lib.imgCheck;var dom=$E("comment_get_vcode");var cont=Core.Dom.wrap(dom,"span");if(cont){Lib.AudioCheck.render(cont,Lib.AudioCheck.soundUrl+"?"+(new Date).getTime())}}},20)},refresh:function(){this.checkObj.refresh()},validate:function(){return this.checkObj.getValidate()},setFreshChk:function(flag){this.checkObj.fresh_chk&&(this.checkObj.fresh_chk=flag)},getPostData:function(paramm){var data={};var extend=function(o,n){for(var p in n)if(n.hasOwnProperty(p)&&!o.hasOwnProperty(p))o[p]=n[p]};validate=this.validate();if(typeof validate==="object"){for(var i in validate){data[i]=validate[i]}}else{data.authcode=validate}extend(data,paramm);return data},getErrorCode:function(){var errCode="B36115";if(scope.check_code_type==="old"){errCode="B36106"}return errCode}};Lib.Invite_Base=Core.Class.create();var checkManager=null;Lib.Invite_Base.prototype={html:['<div class="CP_layercon2 addFriendItem">','<div class="toWho">#{head_image}<span>#{nickname}</span></div>','<div class="formTowho">','<div class="row1" style="display:#{login};">登录名：','<input id="invite_loginname" type="text" class="fm1" style="width:80px;"/>&nbsp;&nbsp;&nbsp;','密码：<input id="invite_password" type="password" class="fm1" style="width:73px;" maxlength="16"/>','&nbsp;&nbsp;<a target="_blank" href="http://login.sina.com.cn/getpass.html">找回密码</a><em class="SG_txtc">','|</em><a target="_blank" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp">注册</a>','<input id="saveOnline_invite" type="checkbox" checked value="" style="display:inline-block;margin-top:3px;"/><label for="saveOnline_invite" style="margin-top:10px; display:inline-block;">记住登录状态</label>','<span id="saveCaution_invite" style="color:#999; margin-left:10px; display:none;">建议在网吧/公用电脑上取消该选项</span>','</div><p id="invite_user_error" class="ErrTips" style="display:none;">请输入正确的登录名或密码</p>','<div class="row2"><textarea id="invite_content"></textarea></div>','<div class="row1"><span id="invite_limit" class="SG_floatR SG_txtc">您还可以输入#{content_length}个汉字</span>','<div id="checkCodeBox" class="check-code-box clearfix" style="padding: 29px 0px 9px;"></div>',"</div>",'<div class="btn">','<a id="invite_submit" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>',"#{dialogTitle}</cite></a>&nbsp;&nbsp;",'<a id="invite_cancel" class="SG_aBtn SG_aBtnB" href="#" onclick="return false;"><cite>取消</cite></a>',"</div>","</div>","</div>"].join(""),dialogName:"invite",initialize:function(sUid,onlineTime){this.uid=sUid;this.onlineTime=onlineTime||15;Lib.checkAuthor();if(!this.isAllowSend()){return}var data={head_image:this.headImage!=null?this.headImage:'<img src="'+("http://portrait"+(this.uid%8+1)+".sinaimg.cn/"+this.uid+"/blog/50")+'" align="absmiddle" alt="'+scope.owenerNickName+'" title="'+scope.owenerNickName+'" />',nickname:this.title(),login:$isLogin?"none":"",checkImage:"http://interface.blog.sina.com.cn/riaapi/checkwd_image.php?"+Math.random(),content_length:this.contentLength/2,dialogTitle:this.dialogTitle};var content=new Ui.Template(this.html).evaluate(data);var checkCodeBox_invite={id:"#checkCodeBox"};checkManager=new Lib.checkManager(checkCodeBox_invite);if(this.dialog==null){window.$inviteDialog=this.dialog=winDialog.createCustomsDialog({content:"",title:this.dialogTitle,tpl:Lib.invite_tpl});this.dialog.addEventListener("hidden",function(){this.destroy()})}else{}this.dialog.setContent(content);this.dialog.setMiddle();this.dialog.show();this.dialog.setAreaLocked(true);Utils.Form.limitMaxLen($E("invite_content"),this.contentLength);Core.Events.addEvent("invite_submit",Core.Function.bind2(this.checkData,this));Core.Events.addEvent("invite_cancel",Core.Function.bind2(this.closeDailog,this));Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check);this.check=setInterval(Core.Function.bind2(function(){var lengthOfContent=Core.String.byteLength($E("invite_content").value);var visibleCount=Math.max(0,Math.floor((this.contentLength-lengthOfContent)/2));$E("invite_limit").innerHTML="您还可以输入"+visibleCount+"个汉字"},this),500)},this),"focus");Core.Events.addEvent("invite_content",Core.Function.bind2(function(){clearInterval(this.check);this.check=null},this),"blur");this.initSaveCaution();this.reloadName()},isAllowSend:function(){return true},initSaveCaution:function(){var cautionCheck=$E("saveOnline_invite");var cautionTip=$E("saveCaution_invite");if(!$isLogin){cautionCheck[$IE?"onclick":"onchange"]=validChecked}var cancelStatus=1;function validChecked(){if(cautionCheck.checked){cautionTip.style.display="inline-block"}else{cautionTip.style.display="none"}if(cancelStatus){var url="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00002&rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}});cancelStatus=null}}},reloadName:function(){var userInfo=Lib.Login.info();var defaultName=userInfo.ln;if(defaultName){$E("invite_loginname").value=defaultName}},checkData:function(){if(!$isLogin){this.username=Core.String.trim($E("invite_loginname").value);this.password=Core.String.trim($E("invite_password").value);if(this.username==""||this.password==""){$E("invite_user_error").style.display="";return}else{$E("invite_user_error").style.display="none"}}this.checkcode=checkManager.validate();if(!checkManager.validate()){showError(checkManager.getErrorCode());return}if(!$isLogin){if($E("saveOnline_invite").checked){v7sendLog("48_01_39_1")}else{v7sendLog("48_01_39_0")}this.login()}else{var me=this;scope.blogOpener.showDialog(function(){me.postContent()})}},login:function(){this.request=new Lib.Login.LoginPost(Core.Function.bind2(function(loginStatus){if(loginStatus.result){if(this.postContent){Lib.checkAuthor();$tray.renderLogin();var me=this;scope.blogOpener.showDialog(function(){me.postContent()})}}else{trace("登陆失败 ："+loginStatus.reason);$E("invite_user_error").style.display=""}},this),false,"referer:"+location.hostname+location.pathname+",func:000"+(/messagesend/.test(this.Interface.url.url)?"2":"3"));this.request.login(this.username,this.password,$E("saveOnline_invite").checked?this.onlineTime:null)},resultHTML:new Ui.Template(['<div class="CP_layercon1">','<div class="CP_prompt">','<img class="SG_icon #{icon}" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif"',' width="50" height="50" align="absmiddle" />','<table class="CP_w_ttl"><tr><td>#{content}</td></tr></table>','<p class="CP_w_btns_Mid"><a class="SG_aBtn SG_aBtnB" href="#" ','onclick="window.$inviteDialog && window.$inviteDialog.hidden();return false;"><cite> 确定 </cite></a></p>',"</div>","</div>"].join("")),postContent:function(){$tray.renderLogin();var i_addInvite=this.Interface;var param_m={tuid:this.uid,fuid:$UID,content:$E("invite_content").value,varname:"addFriendRequest",version:7,rnd:(new Date).valueOf()};var param=null;param=checkManager.getPostData(param_m);i_addInvite.request({GET:param,onSuccess:Core.Function.bind2(function(){v7sendLog("45_01_13_"+scope.$uid);var data={icon:"SG_icon203",content:this.successMSG()};this.dialog.setContent(this.resultHTML.evaluate(data));if(this.afterSubmit!=null){this.afterSubmit()}},this),onError:Core.Function.bind2(function(oData){if(oData.code=="A20109"||oData.code=="A20004"){winDialog.alert($SYSMSG[oData.code])}else if(oData.code=="A20003"||oData.code=="A20103"){winDialog.alert("验证码错误");checkManager.refresh()}else if(oData.code=="A11007"){var msg=$SYSMSG["A11007"].replace("#{linkNewBlog}","http://blog.sina.com.cn/u/"+$UID);winDialog.alert(msg)}else{var data={icon:"SG_icon202",content:$SYSMSG[oData.code].replace(/#{nick}/,scope.owenerNickName)};this.dialog.setContent(this.resultHTML.evaluate(data))}if(this.afterSubmit!=null){this.afterSubmit()}},this),onFail:Core.Function.bind2(function(){var data={icon:"SG_icon202",content:$SYSMSG.A00001};this.dialog.setContent(this.resultHTML.evaluate(data));this.afterSubmit()},this)})},closeDailog:function(){this.dialog.hidden()}};Lib.Invite=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"加好友",contentLength:200,title:function(){var owenerWType=isNaN(scope.owenerWType)?-1:parseInt(scope.owenerWType);var userV=Lib.blogv.getVHTML(owenerWType);return'加"'+scope.owenerNickName+userV+'"为好友'},successMSG:function(){return["邀请发送成功，请等待对方确认。",'<div class="CP_w_cnt SG_txtb" style="font-size:12px;font-weight:normal;">以后对方的动态（发博文，图片，投票等），都可以在<span style="color: red;">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a style="font-weight:normal;font-size:12px;" href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=addfiend" target="_blank">到个人中心查看其他好友动态&gt;&gt;</a></li>',"</ul>"].join("")},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/invitesend.php","jsload"),isAllowSend:function(){if(!scope||!scope.$private)return true;var invitSet=scope.$private.invitationset||0;if(0===invitSet){return true}else{winDialog.alert($SYSMSG["A20106"]);return false}}});Lib.invite=function(sUid){new Lib.Invite(sUid)};Lib.invite3=function(sUid,name){scope.owenerNickName=name;new Lib.Invite(sUid)};Lib.Scrip=Core.Class.define(Lib.Invite_Base.prototype.initialize,Lib.Invite_Base,{dialogTitle:"发纸条",headImage:"",contentLength:300,title:function(){return"发纸条给："+scope.owenerNickName},successMSG:function(){return"给"+scope.owenerNickName+"的纸条发送成功！"},Interface:new Interface("http://control.blog.sina.com.cn/riaapi/profile/messagesend.php","jsload"),afterSubmit:function(){},isAllowSend:function(){if(!scope||!scope.$private)return true;var pageSet=scope.$private.pageset||0;if(1===pageSet){this._showMsg("A20009");return false}if($isLogin){var isFriend=-1!=$E("comp901_btn_invite").innerHTML.indexOf("已是好友");if(2===pageSet&&!isFriend){this._showMsg("A30006");return false}}return true},_showMsg:function(code){winDialog.alert($SYSMSG[code])}});Lib.scrip=function(sUid){new Lib.Scrip(sUid)};Lib.pkg("Lib.Component");$SYSMSG.extend({A00001:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00002:"很抱歉，您的IP出现异常，请稍后再试",A00003:"无权限进行此操作，请重新登录。",A00004:"无权限进行此操作，请重新登录。",A00005:"操作失败，可能系统繁忙或系统遇到未知错误，请稍后再试。也可联系新浪客服：致电4006900000。",A00006:"操作成功",A00007:"无权限进行此操作，请重新登录。",A00009:"网络繁忙，请稍后再试",A00010:"无升级权限",A11007:"你还未开通新浪博客，请先<a href='http://login.sina.com.cn/hd/reg_sec.php?entry=blog'> 开通博客</a>",A00800:"对不起，您短时间点击喜欢过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！"});function showError(code,ico){var msg=$SYSMSG[code]||code;winDialog.alert(msg,{icon:ico||"01"})}$SYSMSG.extend({A33001:"对方已经被你加为关注了！<br/>请不要重复添加。",A33002:"对方拒绝了你的关注请求！",A33003:"关注已达上限，不能再添加新的关注了！<br/>可以到<a href='http://control.blog.sina.com.cn/blogprofile/attention.php"+"' target='_blank'>关注的人</a>去取消关注一些人，再回来关注吧。",A33004:"关注成功！",A33005:"你不能添加自己为关注！",A33008:"取消关注失败",A33009:"移除关注成功，加黑名单失败",A33010:"对不起，您短时间添加关注过多，请多休息，注意身体！感谢您对新浪博客的支持和关注！",A20013:"您已经发送多条相似内容了哦，请先休息一下吧~",A20014:"已经有很多博主发过相似评论了，换个内容会更精彩~"});Utils.Cookie.setCookie=function(name,value,expire,path,domain,secure){var cstr=[];cstr.push(name+"="+escape(value));if(expire){var dd=new Date;var expires=dd.getTime()+expire*36e5;dd.setTime(expires);cstr.push("expires="+dd.toGMTString())}if(path){cstr.push("path="+path)}if(domain){cstr.push("domain="+domain)}if(secure){cstr.push(secure)}document.cookie=cstr.join(";")};String.prototype.format=function(){var r=!arguments[0]||typeof arguments[0]=="undefined"?"":arguments[0].toString();var re=/(.*?)({(\d+)(:([0-9a-z]+))?})/gi;var t=this.match(re);if(t){for(var i=0,l=t.length;i<l;i++){t[i]=t[i].replace(re,function(){return RegExp.$1});t[i]=RegExp.$1;switch(typeof arguments[parseInt(RegExp.$3)]){case"undefined":t[i]+=RegExp.$2;break;case"number":t[i]+=isNaN(RegExp.$5)||RegExp.$5==""?arguments[parseInt(RegExp.$3)]:arguments[parseInt(RegExp.$3)].toString(Math.max(Math.min(Math.round(RegExp.$5),36),2));break;default:t[i]+=arguments[parseInt(RegExp.$3)]}}t.push(this.replace(re,""));return t.join("")}return this};Sina.pkg("Core.Math");Core.Math.getUniqueId=function(_start,_end){return parseInt(Math.random()*1e4).toString()+(new Date).getTime().toString()};(function(){var _inputNode;var _rndID=parseInt(Math.random()*100);var _showMenuItems=[];var _selectMenuIndex=-1;var _selectMenuText="";var _css="#userPosition {padding: 0;margin: 0;border: 0;position: absolute;z-index: 999;}\r\n				#sinaNote {position: absolute;z-index: 999999;width: auto;overflow: hidden;padding: 0;margin: 0;\r\n				border: 1px solid #CCCCCC;background: #ffffff;text-align:left;}\r\n				#sinaNote li {font-size: 12px;list-style: none;margin: 0 1px;height: 20px;padding: 0 5px;clear: both;\r\n				line-height: 20px;cursor: pointer;color: #999999;}\r\n				#sinaNote li.note {text-align: left;color: #999999;}";var _viewWindow=window;var passcardOBJ={overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:"",menuStatus:{"sina.com":true,"sina.cn":true,"vip.sina.com":true,"qq.com":true,"163.com":true,"126.com":true,"hotmail.com":true,"yahoo.com.cn":true,"gmail.com":true}};passcardOBJ.createNode=function(){var d=_viewWindow.document;var div=d.createElement("div");div.innerHTML='<ul id="sinaNote" style="display:none;"></ul>';var obj=d.createElement("style");obj.setAttribute("type","text/css");try{if($IE){obj.styleSheet.cssText=_css}else{obj.innerHTML=_css}}catch(e){trace(e.message)}var total=d.createElement("div");total.appendChild(div);total.appendChild(obj);d.body.appendChild(total)};passcardOBJ.arrowKey=function(keyCodeNum){if(keyCodeNum==38){if(_selectMenuIndex<=0){_selectMenuIndex=_showMenuItems.length}_selectMenuIndex--;passcardOBJ.selectLi(_selectMenuIndex)}if(keyCodeNum==40){if(_selectMenuIndex>=_showMenuItems.length-1){_selectMenuIndex=-1}_selectMenuIndex++;passcardOBJ.selectLi(_selectMenuIndex)}};passcardOBJ.showList=function(e){_selectMenuText="";var keyCodeNum=Core.Events.getEvent().keyCode;if(keyCodeNum==38||keyCodeNum==40){passcardOBJ.arrowKey(keyCodeNum);return false}if(!$E("sinaNote")){passcardOBJ.createNode()}var username=$E(e).value;var menuList={};var atIndex=username.indexOf("@");var InputCase="";var InputStr="";if(atIndex>-1){InputCase=username.substr(atIndex+1);InputStr=username.substr(0,atIndex)}_showMenuItems=[];_selectMenuIndex=0;_showMenuItems[_showMenuItems.length]="sinaNote_MenuItem_Title_"+_rndID;for(var key in this.menuStatus){this.menuStatus[key]=true;if(InputCase!=""&&InputCase!=key.substr(0,InputCase.length)){this.menuStatus[key]=false}else{_showMenuItems[_showMenuItems.length]="sinaNote_MenuItem_"+key+"_"+_rndID}}var listcontent='<li class="note">请选择登录类型</li>';listcontent+='<li id="sinaNote_MenuItem_Title_'+_rndID+'">'+username+"</li>";var itemLabel;for(var mykey in this.menuStatus){if(this.menuStatus[mykey]==true){if(InputStr==""){itemLabel=username+"@"+mykey}else{itemLabel=InputStr+"@"+mykey}listcontent+='<li id="sinaNote_MenuItem_'+mykey+"_"+_rndID+'" title="'+itemLabel+'">'+itemLabel+"</li>"}}$E("sinaNote").innerHTML=listcontent;for(var i=0;i<username.length;i++){if(username.charCodeAt(i)<160){$E("sinaNote").style.display="";this.selectList(e)}else{this.hideList()}}var el=$E(e);var note=$E("sinaNote");var frameLeft=0;var frameTop=0;var framePos;if(_viewWindow!=window){framePos=Core.Dom.getXY(window.frameElement);frameLeft=framePos[0];frameTop=framePos[1]}var inputWidth=el.offsetWidth;if(inputWidth<200){inputWidth=200}note.style.width=inputWidth-2+"px";var inputXY=Core.Dom.getXY(el);note.style.left=inputXY[0]-($IE?2:-1)+frameLeft+"px";note.style.top=inputXY[1]+el.offsetHeight-($IE?2:-1)+frameTop+"px"};passcardOBJ.selectList=function(e){var unames=$E("sinaNote").getElementsByTagName("li");for(var i=1;i<unames.length;i++){unames[1].style.backgroundColor=passcardOBJ.overbgcolor;unames[1].style.color=passcardOBJ.outfcolor;unames[i].onmousedown=function(){var temp=this.innerHTML;if(temp.indexOf("非新浪邮箱")>-1){var pos=temp.split("@");$E(e).value=pos[0]}else{$E(e).value=this.innerHTML}if(Core.Events.getEvent()!=null){Core.Events.stopEvent()}};unames[i].onmouseover=function(){if(i!=1){unames[1].style.backgroundColor=passcardOBJ.outbgcolor;unames[1].style.color=passcardOBJ.overfcolor}this.style.backgroundColor=passcardOBJ.overbgcolor;this.style.color=passcardOBJ.outfcolor};unames[i].onmouseout=function(){this.style.backgroundColor=passcardOBJ.outbgcolor;this.style.color=passcardOBJ.overfcolor;unames[1].style.backgroundColor=passcardOBJ.overbgcolor;unames[1].style.color=passcardOBJ.outfcolor}}};passcardOBJ.selectLi=function(nIndex){var menuNode;$E("sinaNote_MenuItem_Title_"+_rndID).style.backgroundColor=passcardOBJ.outbgcolor;$E("sinaNote_MenuItem_Title_"+_rndID).style.color=passcardOBJ.overfcolor;for(var i=0;i<_showMenuItems.length;i++){menuNode=$E(_showMenuItems[i]);menuNode.style.backgroundColor=passcardOBJ.outbgcolor;menuNode.style.color=passcardOBJ.overfcolor}$E(_showMenuItems[nIndex]).style.backgroundColor=passcardOBJ.overbgcolor;$E(_showMenuItems[nIndex]).style.color=passcardOBJ.outfcolor;_selectMenuText=$E(_showMenuItems[nIndex]).innerHTML};passcardOBJ.hideList=function(){if(!$E("sinaNote")){passcardOBJ.createNode()}$E("sinaNote").style.display="none"};passcardOBJ.init=function(oNode,oColors,oFocusNode,oWindowTarget){oWindowTarget=oWindowTarget||window;if(oWindowTarget.document.body==null){setTimeout(Core.Function.bind3(function(){this.init(oNode,oColors,oFocusNode,oWindowTarget)},this),100)}for(var key in oColors){this[key]=oColors[key]}Core.Events.addEvent(document,passcardOBJ.hideList,"click");Core.Events.addEvent(oNode,passcardOBJ.hideList,"blur");Core.Events.addEvent(oNode,Core.Function.bind3(passcardOBJ.showList,this,[oNode]),"keyup");Core.Events.addEvent(oNode,function(e){var keyCodeNum=Core.Events.getEvent().keyCode;var isSinaMail;if(keyCodeNum==13||keyCodeNum==9){if(_selectMenuText!=""){var temp=_selectMenuText;if(temp.indexOf("非新浪邮箱")>-1){var pos=temp.split("@");oNode.value=pos[0]+"@";isSinaMail=false}else{oNode.value=_selectMenuText;isSinaMail=true}}if(isSinaMail){if(oFocusNode!=null){setTimeout(function(){oFocusNode.focus()},0)}}else{if(oNode){oNode.focus()}}}},"keydown");if(oWindowTarget){_viewWindow=oWindowTarget}};Lib.passcardOBJ=passcardOBJ})();Lib.Login.Ui=Core.Class.create();var msnRefreshTimer=0;function msnrefreshWindow(){var setCookie=Utils.Cookie.setCookie;var getCookie=Utils.Cookie.getCookie;clearTimeout(msnRefreshTimer);var reg_token=getCookie("reg_token");if(reg_token){trace("token find out...");setCookie("reg_token","","","/",".blog.sina.com.cn")}else{trace("no token...");msnRefreshTimer=setTimeout(msnrefreshWindow,1e3);return}var cookieArr;var cid;var code;var c_cid=getCookie("c_uid");var CBcookie=getCookie("msnLinkCB");var altReg=getCookie("AlT");setCookie("msnLoginComeFrom",window.location.href,1,"/",".blog.sina.com.cn");if(CBcookie){cookieArr=CBcookie.split("_");cid=cookieArr[0];code=cookieArr[1]}if(c_cid!=cid)return;switch(code){case"noCid":break;case"loginError":break;case"unlink":deleteCookie("msnLinkCB");funcNoAccount(reg_token);break;case"done":deleteCookie("msnLinkCB");setCookie("loginFromMsn","msn",24,"/",".blog.sina.com.cn");funcSuccess(altReg,reg_token);break;case"pass":break}function funcSuccess(arg,reg_tk){trace("has Account");if(arg){trace("alt:"+arg);var iframe=$C("iframe");iframe.setAttribute("height",0);iframe.setAttribute("width",0);document.body.appendChild(iframe);iframe.src="https://login.sina.com.cn/sso/login.php?entry=blogmsn&service=blogmsn&alt="+encodeURIComponent(arg)+"&savestate=7&returntype=TEXT";(function(){var me=arguments.callee;if(!me.count)me.count=0;if(me.count++>10){trace("放弃获取SUP");iframe.parentNode.removeChild(iframe);return}trace("尝试获取SUP, count:"+me.count);if(getCookie("SUP")){trace("获取到 SUP"+getCookie("SUP"));window.location.reload();return}setTimeout(me,1e3)})()}else{window.location.reload()}}function funcNoAccount(){trace("noAccount");window.location.href="http://blog.sina.com.cn/blog_rebuild/msn/interface/connect_user_confirm.php"}function deleteCookie(name){var Then=new Date;Then.setTime(Then.getTime()-1);document.cookie=name+"=_pass;path=/;domain=.blog.sina.com.cn;expires="+Then.toGMTString()}function jsonDecode(str){if(!str||str==""){return null}try{return window.eval("("+str+")")}catch(e){return null}}}Lib.Login.Ui.prototype={dialog:null,isInit:false,request:null,callback:null,initialize:function(){},login:function(callback,clearDomain,from){this.callback=callback||null;this.clearDomain=clearDomain||false;this.from=from||null;this.initDom();this.initEvent();this.dialog.show();this.dialog.setAreaLocked(true);this.reloadName();this.onShow();this.focus();if(scope.$pageid==="blogMove"){$E("login_move_tip").style.display=""}if($IE6){this.initAD()}Lib.passcardOBJ.init($E("login_name_d"),{overfcolor:"#999",overbgcolor:"#e8f4fc",outfcolor:"#000000",outbgcolor:""},$E("login_pass_d"))},reloadName:function(){var userInfo=Lib.Login.info();var defaultName=userInfo.ln;if(defaultName){$E("login_name_d").value=defaultName}var alf=Utils.Cookie.getCookie("ALF");if(alf!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}alf=Utils.Cookie.getCookie("LiRe");if(alf!=""&&$E("login_save")){$E("login_save").checked=true;$E("login_save_tips").style.display="none"}},initDom:function(){var me=this;this.dialog=winDialog.createCustomsDialog({tpl:me.tpl});this.dialog.addEventListener("hidden",function(){this.destroy()});this.dialog.setContent(this.struc);this.dialog.setTitle("登录新浪博客");this.dialog.setMiddle()},initEvent:function(){var callback=this.parse.bind2(this);this.request=new Lib.Login.LoginPost(callback,this.clearDomain,this.from);Core.Events.addEvent("login_button",this.doLogin.bind2(this));Core.Events.addEvent("login_name_d",function(e){var code=e.keyCode;if(code==13){this.doLogin()}}.bind2(this),"keydown");

Core.Events.addEvent("login_pass_d",function(e){var code=e.keyCode;if(code==13){this.doLogin()}}.bind2(this),"keydown");var cancelStatus=1;Core.Events.addEvent("login_save",function(){if($E("login_save").checked){$E("login_save_tips").style.display=""}else{$E("login_save_tips").style.display="none"}if(cancelStatus){var url="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?ck_login=A00001&rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}});cancelStatus=null}})},doLogin:function(){Core.Events.stopEvent();var username=$E("login_name_d").value;var password=$E("login_pass_d").value;username=Core.String.trim(username);password=password;if(username==""){this.error("请输入登录名");return false}if(password==""){this.error("请输入密码");return false}if(typeof sinaSSOController!="undefined"&&typeof sinaSSOController.loginExtraQuery!="undefined"){if(typeof sinaSSOController.loginExtraQuery.door!="undefined"){var vcode=$E("login_vcode").value;sinaSSOController.loginExtraQuery.door=vcode||1}}if($E("login_save").checked){v7sendLog("48_01_38_1");this.request.login(username,password,60)}else{v7sendLog("48_01_38_0");this.request.login(username,password)}return false},parse:function(loginStatus){if(loginStatus.result){Lib.checkAuthor();if($E("login_save").checked){Utils.Cookie.setCookie("LiRe",true,2400,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("LiRe","",2400,"/",".blog.sina.com.cn")}var date=new Date,y=date.getFullYear(),m=date.getMonth(),d=date.getDate();var time=new Date(y,m,d,24).getTime();Utils.Cookie.setCookie("onceloggedonblog",time,720,"/",".blog.sina.com.cn");var me=this;function cbreload(){if(this.callback){try{$tray.renderLogin()}catch(e){}this.callback.call()}else{window.location=window.location.toString().replace(/#.*/,"")}}var cbed=false;Utils.Io.JsLoad.request("http://login.sina.com.cn/bindmail/checkmailuser.php?entry=blog&name="+encodeURIComponent($E("login_name_d").value)+"&utf82gbk=1&callback=scope.$bindEmailAlert",{noreturn:true,timeout:5e3,onException:function(){if(!cbed){cbreload.call(me)}}});scope.$bindEmailAlert=function(data){cbed=true;if(data.ret!="y"&&data.errcode!="not_verify"||Utils.Cookie.getCookie("sbr_noTBE")==1){cbreload.call(me)}else{var dialog=winDialog.createCustomsDialog({content:['<div id="#{entityID} style="width:358px;height:144px" class="CP_layercon2 unilayer">','<div id="#{contentID}" class="CP_prompt">','<img height="50" align="absmiddle" width="50" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" class="SG_icon SG_icon201">','<table class="CP_w_ttl"><tbody><tr><td>经检测您的帐号存在一定的安全隐患！<br>建议绑定邮箱</td></tr></tbody></table>','<p class="CP_w_btns_Mid"><a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{bindit}" target="_blank"><cite> 绑定 </cite></a>&nbsp;&nbsp;<a href="javascript:;" class="SG_aBtn SG_aBtnB" id="#{nobind}"><cite> 暂不绑定 </cite></a></p>',"</div>",'<div class="unilayerB SG_j_linedot1">','<p class="SG_txtb"><input type="checkbox" id="#{noalertbind}"><label for="#{noalertbind}">一周内不提醒</label></p>',"</div>","</div>"].join(""),shadow:1},"bindEmail");dialog.setMiddle();dialog.show();dialog.nodes["btnClose"].onclick=function(){cbreload.call(me);dialog.hidden()};dialog.nodes["nobind"].onclick=function(){setTimeout(function(){cbreload.call(me);dialog.hidden()},100)};dialog.nodes["bindit"].href="http://login.sina.com.cn/bindmail/bindmail.php?entry=blog";dialog.nodes["bindit"].onclick=function(){cbreload.call(me)};dialog.nodes["noalertbind"].onclick=function(){if(this.checked){Utils.Cookie.setCookie("sbr_noTBE","1",24*7,"/",".blog.sina.com.cn")}else{Utils.Cookie.setCookie("sbr_noTBE","",0,"/",".blog.sina.com.cn")}}}};this.dialog.hidden()}else{if(loginStatus.errno==="4049"){sinaSSOController.loginExtraQuery={door:0};$E("login_ckimg").style.display="";$E("login_vcode").value="";$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";Core.Events.addEvent($E("reloadCode"),function(){$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value="";$E("login_div_error").innerHTML=""});this.error("");return}if(loginStatus.errno==="2070"){Core.Events.fireEvent($E("reloadCode"),"click");this.error(loginStatus.reason);return}if(loginStatus.errno=="4047"){this.error(loginStatus.reason);return}else if(loginStatus.errno=="4057"){this.error(loginStatus.reason);return}else if(loginStatus.errno=="4040"){this.error(loginStatus.reason);return}this.error("登录名或密码错误");$E("checkImg").src="http://login.sina.com.cn/cgi/pin.php?r="+Core.Math.getUniqueId()+"&s=0";$E("login_vcode").value=""}},friendlyTip:function(reason){var ret=reason;var node=$E("login_name_d");var name=node.value;var me=this;if(!/[\u0391-\uFFE5]+/.test(name)&&!/^\d+$/.test(name)&&!/^@/.test(name)){var str="你的登录名可能是 ";var linkTpl='<a href="#" class="underline" onclick="$_RENAME(/@.*/, \'{1}\');return false">{0}{1}</a>';var linkArr=["@sina.com","@sina.cn"];var finalLink="";if(/@sina\.cn$/.test(name)){finalLink=linkTpl.format("{0}",linkArr[0])}else if(/@sina\.com$/.test(name)){finalLink=linkTpl.format("{0}",linkArr[1])}else{finalLink=linkTpl.format("{0}",linkArr[0])+" 或 "+linkTpl.format("{0}",linkArr[1])}ret=(str+finalLink).format(name.replace(/@.*/,""))}return ret},rename:function(){window.$_RENAME=function(reg,suf){var node=$E("login_name_d");node.value=node.value.replace(reg,"")+suf;$E("login_pass_d").focus();$E("login_div_error").innerHTML=""};return window.$_RENAME}(),focus:function(){var nameEl=$E("login_name_d");if(nameEl.value==""){nameEl.focus()}else{$E("login_pass_d").focus()}},initAD:function(){$E("login_ad").src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html"},onShow:function(){},error:function(msg){$E("login_div_error").innerHTML=msg;$E("login_pass_d").value="";this.focus()},tpl:['<table id="#{panel}" class="CP_w">','<thead id="#{titleBar}">',"<tr>",'<th class="tLeft"><span></span></th>','<th class="tMid">','<div class="bLyTop">','<strong id="#{titleName}">提示标题</strong>','<cite><a id="#{btnClose}" href="#" onclick="return false;" class="CP_w_shut" title="关闭">关闭</a></cite>',"</div>","</th>",'<th class="tRight"><span></span></th>',"</tr>","</thead>","<tfoot>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid"><span></span></td>','<td class="tRight"><span></span></td>',"</tr>","</tfoot>","<tbody>","<tr>",'<td class="tLeft"><span></span></td>','<td class="tMid" id="#{content}">',"</td>",'<td class="tRight"><span></span></td>',"</tr>","</tbody>","</table>"].join(""),struc:'		<div class="CP_layercon2 passLoginItem">			<div>				<div id="login_move_tip" style="display:none;margin-bottom:12px">可以使用新浪微博、邮箱、通行证的帐号进行登录</div>				<div class="boxA">登录名：					<input tabIndex="201" type="text" class="fm1" style="width:215px;" name="login_name" id="login_name_d" tabIndex=1/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/signup/signupmail.php?entry=blog&srcuid='+scope.$uid+'&src=blogicp" target="_blank">立即注册</a>				</div>				<div class="boxA">密　码：					<input tabIndex="202" type="password" class="fm1" style="width:215px;" name="login_pass" maxlength="16" id="login_pass_d" tabIndex=2/>  <a style="font-size: 12px;" href="http://login.sina.com.cn/getpass.html" target="_blank">找回密码</a>				</div>				<div id="login_ckimg" class="boxA" style="display:none"> <p class="p_img">验证码：                  	<input type="text" id="login_vcode" name="login_vcode" class="fm1" size="10" maxlength="5" />                  	<img width="100" align="absmiddle" id="checkImg" src="http://login.sina.com.cn/cgi/pin.php?r='+Core.Math.getUniqueId()+'&s=0" /> <a href="javascript:;" onclick="return false;" style="font-size: 12px;"><span id="reloadCode">换一换</span></a></p> 			    </div>				<div class="ErrTips" id="login_div_error"></div>				<div class="boxB"><p><input tabIndex="203" type="checkbox" value="" id="login_save" checked="checked" /><label for="login_save"> 记住登录状态</label></p><p id="login_save_tips" style="color:#999;display:none;">建议在网吧/公用电脑上取消该选项</p><p style="margin-top: 8px;"><a id="login_button" class="SG_aBtn SG_aBtnB SG_aBtn_sub" href="javascript:;" tabIndex=204><cite>登录<input type="text"/></cite></a> </p></div>			</div>			<div class="connect_msn" id="connect_msn" style="position:relative;">				<span>使用 MSN 帐号登录博客</span>				<a href="#" onclick="Lib.checkAuthor();v7sendLog(\'48_01_36\'); window.open(\'https://login.live.com/oauth20_authorize.srf?client_id=0000000040046F08&redirect_uri=http%3A%2F%2Fcontrol.blog.sina.com.cn%2Fblog_rebuild%2Fmsn%2FmsnLoginCallBack.php&response_type=code&scope=wl.basic%20wl.signin%20wl.offline_access%20wl.share%20wl.emails\',\'neww\',\'left='+(screen.width-440)/2+",top="+(screen.height-400)/2+',height=400,width=440\');msnrefreshWindow();" style="background:transparent url(http://simg.sinajs.cn/blog7style/images/msn_login01.gif) no-repeat left top; width:70px; height:22px; line-height:22px; display:inline-block; text-align:left; text-indent:2em; text-decoration:none; color:white; font-weight:bold; font-size:14px;">登录</a>			</div>			<a href="http://blog.sina.com.cn/s/blog_4b0f52990100miil.html" target="_blank"style="left:308px;position:relative;top:-24px;">如何登录？</a>			<div class="CP_lg_ad SG_j_linedot1">				<iframe id="login_ad" src="http://blog.sina.com.cn/lm/iframe/71/2008/0731/21.html" frameborder="0" scrolling="no" height="25" width="auto"></iframe>			</div>		</div>'};(function(){var addAttention=function(nVisitId,nUserId,addedCallBack){Lib.checkAuthor();var i_attention=new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_add.php","ijax");i_attention.request({POST:{uid:nVisitId||$UID,aid:nUserId||scope.$uid},onSuccess:function(){},onError:function(oData){var msg="";switch(oData.code){case"A11007":msg=$SYSMSG["A11007"].replace("#{linkNewBlog}","http://login.sina.com.cn/hd/reg_sec.php?entry=blog");winDialog.alert(msg,{funcOk:function(){window.open("http://login.sina.com.cn/hd/reg_sec.php?entry=blog","_blank","")}});break;case"A33003":msg=$SYSMSG.A33003.replace("#{UID}",$UID);winDialog.alert(msg);break;case"A33004":var alertConf={subText:['<div class="CP_w_cnt SG_txtb">以后对方的动态（发博文，图片，投票等），都可以在<span style="color:red">个人中心</span>查看啦！</div>','<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention" onclick="winDialog.getDialog(\'attention\').hidden();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03",width:300};try{var attentionButton=$E("module_901_attention");attentionButton.className="SG_aBtn SG_aBtn_dis";attentionButton.innerHTML="<cite onclick=\"Lib.Component.isAttentioned('"+$UID+"', '"+scope.$uid+"');\">已关注</cite>"}catch(e){}msg=$SYSMSG["A33004"];alertConf["subText"]=alertConf["subText"].replace(/#{UID}/g,$UID);winDialog.alert(msg,alertConf,"attention");break;default:showError(oData.code)}addedCallBack(oData.code)},onFail:function(){showError($SYSMSG.A00001)}})};Lib.Component.Attention=function(nVisitId,nUserId,addedCallBack){Lib.checkAuthor();var me=this;addedCallBack=addedCallBack||function(){};if(!$isLogin){var Login=new Lib.Login.Ui;Login.login(function(){scope.blogOpener.showDialog(function(){Core.Function.bind3(addAttention,null,[nVisitId,nUserId,addedCallBack])()})},false,"referer:"+location.hostname+location.pathname+",func:0004")}else{scope.blogOpener.showDialog(function(){addAttention(nVisitId,nUserId,addedCallBack)})}};Lib.Component.deleteAttention=function(sUid,sAid){winDialog.getDialog("attention").close();winDialog.confirm("是否要取消关注？",{funcOk:function(){new Interface("http://control.blog.sina.com.cn/riaapi/profile/attention_del.php","jsload").request({GET:{uid:$UID,aid:scope.$uid},onSuccess:function(){var attentionButton=$E("module_901_attention");attentionButton.className="SG_aBtn";attentionButton.innerHTML="<cite onclick=\"Lib.Component.Attention('"+$UID+"', '"+scope.$uid+"');\">加关注</cite>"},onError:function(){winDialog.alert("取消失败！请重试。")},onFail:function(){winDialog.alert("取消失败！请重试。")}})},funcCancel:function(){Lib.Component.isAttentioned()},textOk:"是",textCancel:"否"})};Lib.Component.isAttentioned=function(){winDialog.alert("已关注此人！",{subText:['<ul class="CP_w_part CP_w_aLine">','<li><a href="http://control.blog.sina.com.cn/blogprofile/index.php?type=3&from=attention2" onclick="winDialog.getDialog(\'attention\').close();" target="_blank">到个人中心查看关注动态&gt;&gt;</a></li>',"</ul>"].join(""),icon:"03"},"attention")}})();CenterTips=Core.Class.create();CenterTips.prototype={obj:null,tpl:['<table id="#{entity}" class="CP_w">',"<tbody>","<tr>",'<td class="tMid">','<div class="" style="width:auto;" id="#{content}">',"</div>","</td>","</tr>","</tbody>","</table>"].join(""),content:['<div class="SG_clewbox twosed">','<span id="#{icon}"><img class="SG_icon SG_icon203" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle" /></span>','<a title="关闭" href="javascript:window.centerTips.hidden();void(0);" class="layer_close SG_icon SG_icon76"></a>','<div class="SG_clewtxt"  id="#{msg}">',"</div>",'<div class="clearit"></div>',"</div>"].join(""),initialize:function(){this.obj=winDialog.createCustomsDialog({tpl:this.tpl,title:"",content:this.content,width:258,height:77},"tips")},show:function(msg,iserror){if(iserror){this.obj.nodes["icon"].innerHTML='<img class="SG_icon SG_icon201" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle" />'}else{this.obj.nodes["icon"].innerHTML='<img class="SG_icon SG_icon203" src="http://simg.sinajs.cn/blog7style/images/common/sg_trans.gif" width="50" height="50" align="absmiddle" />'}this.obj.nodes["msg"].innerHTML=msg;this.obj.show();this.obj.setMiddle();var m=this;setTimeout(function(){m.obj.hidden()},2e3)},hidden:function(){this.obj.hidden()}};window.centerTips=new CenterTips;$registJob("msg_panel",function(){scope.msg_panel=new Lib.Panel;var html='<div id="#{panel}" class="feed_addlist feedTop_addlist " style="background:#fff;z-index:1000">\r\n              <div style="display: block;" class="cBox_main">\r\n                            <ul class="toollist">\r\n                                <li style="display:none;"><a id="#{follow}" href="javascript:void(0);">加关注</a></li>\r\n                                <li style="display:none;"><a id="#{friend}" href="javascript:void(0);">加好友</a></li>\r\n                                <li style="display:none;"><a id="#{delete}" href="javascript:void(0);">删除</a></li>\r\n                                <li style="display:none;"><a id="#{recover}" href="javascript:void(0);">恢复</a></li>\r\n                                <li style="display:none;"><a id="#{report}" href="javascript:void(0);">举报</a></li>\r\n                                <li style="display:none;" class="end"><a id="#{backlist}" href="javascript:void(0);">黑名单</a></li>\r\n                            </ul>\r\n                            </div>\r\n            </div>';scope.msg_panel.setTemplate(html);scope.msg_panel.commentId="";scope.msg_panel.friendUid="";scope.msg_panel.friendNick="";scope.msg_panel.addFollow=function(friendId){if($UID==scope.msg_panel.friendUid){winDialog.alert("抱歉！不能关注自己");return false}Lib.Component.Attention($UID,scope.msg_panel.friendUid);return false};scope.msg_panel.addfriend=function(friendId){if($UID==scope.msg_panel.friendUid){winDialog.alert("抱歉！不能加自己为好友");return false}Lib.invite3(scope.msg_panel.friendUid,scope.msg_panel.friendNick);return false};scope.msg_panel.blackList=function(){if($UID==scope.msg_panel.friendUid){winDialog.alert("抱歉！不能把自己添加到黑名单");return false}winDialog.confirm("确实将此人加入黑名单？<br/>加入黑名单的用户将不能和你沟通",{funcOk:function(){new Interface("http://control.blog.sina.com.cn/blog_rebuild/riaapi/profile/note/deleblackuid.php","jsload").request({GET:{uid:$UID,friend_uid:scope.msg_panel.friendUid,inblack:1},onSuccess:function(){window.centerTips.show("已成功添加到黑名单")},onError:function(res){if(typeof res){if(res.code=="blacklist_full"){winDialog.alert("抱歉！您的黑名单已经满了")}else{showError(res.code)}}else{}}})}});return false};scope.msg_panel.report=function(){report("44a300b8010005ti_200501");return false};scope.msg_panel.dele=function(){};scope.msg_panel.recover=function(){};scope.msg_panel._showEvent=function(_m,e,commentId,friendUid,friendNick){scope.msg_panel.commentId=commentId;scope.msg_panel.friendUid=friendUid;scope.msg_panel.friendNick=friendNick;var eles=scope.msg_panel.getNodes();if(eles["backlist"].parentNode.style.display!="none"||typeof eles["backlist"].bFlg!="undefined"){if($UID==friendUid){eles["backlist"].parentNode.style.display="none";eles["backlist"].bFlg=true}else{eles["backlist"].parentNode.style.display=""}}_m=_m.getElementsByTagName("img")[0];scope.msg_panel.setPosition(_m.getBoundingClientRect().left+document.documentElement.scrollLeft,_m.getBoundingClientRect().top+Math.max(document.body.scrollTop,document.documentElement.scrollTop)+13);scope.msg_panel.show();Core.Events.stopEvent(e);return false};Core.Events.addEvent(document.body,function(){scope.msg_panel.hidden()},"click")});Core.String.shorten=function(str,len,suffix){if(Core.String.byteLength(str)<=len){return str}if(suffix!=""){suffix=suffix||"..."}else{suffix=""}return Core.String.leftB(str,len)+suffix};Core.String.decodeHTML=function(str){var div=document.createElement("div");div.innerHTML=str;return div.innerText==undefined?div.textContent:div.innerText};Utils.Form.Radio={};Utils.Form.Radio.get=function(radioObj){if(!radioObj)return"";var radioLength=radioObj.length;if(radioLength==undefined)if(radioObj.checked)return radioObj.value;else return"";for(var i=0;i<radioLength;i++){if(radioObj[i].checked){return radioObj[i].value}}return""};Utils.Form.Radio.set=function(radioObj,newValue){if(!radioObj)return;var radioLength=radioObj.length;if(radioLength==undefined){radioObj.checked=radioObj.value==newValue.toString();return}for(var i=0;i<radioLength;i++){radioObj[i].checked=false;if(radioObj[i].value==newValue.toString()){radioObj[i].checked=true}}};scope.reportMainTpl=['<div id="#{panel}" class="blog_report">','<div id="#{titleBar}" class="BRpt_topTit">','<a href="#" onclick="return false;" id="#{btnClose}" title=""><img src="http://simg.sinajs.cn/blog7style/images/common/report/icon_clo.gif" /></a>',"</div>",'<div id="#{content}" class="BRpt_mid">',"</div>","</div>"].join("");scope.reportStartTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_RtConn">','<p id="#{resumeInfo}" class="Brpt_RtInf"></p>','<textarea id="#{resumeContent}" readonly="readonly" class="Brpt_RtTxt"></textarea>','<p class="Brpt_Rhost"><input type="checkbox" id="#{cbBlogHost}" /><label for="#{cbBlogHost}">同时举报博主</label></p>','<div class="clear"></div>','<div class="Brpt_choCla">','<p class="claTit">请选择您举报类别（<span class="cho">必选</span>）：</p>','<p class="cla_conn">','<input id="ero" value="1" type="radio" name="chocla" /><label for="ero">色情</label>','<input id="pol" value="2" type="radio" name="chocla" /><label for="pol">政治</label>','<input id="adv" value="5" type="radio" name="chocla" /><label for="adv">广告</label>','<input id="oth" value="4" type="radio" name="chocla" /><label for="oth">其他</label>',"</p>",'<p>对部分内容(个人侵权、企业侵权等)的举报投诉，请拨打新浪网客服电话4006900000，转人工服务、索取《新浪网删帖申请文档》并提供相关证明材料。<br/><span style="color:red;">新浪网删帖不收取任何费用</span></p>',"</div>",'<p class="Brpt_othInt">您可以填写更多举例说明：</p>','<textarea id="#{reportReason}" class="Brpt_RtTxt"></textarea>',"</div>",'<div class="Brpt_RCBtn">','<a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a>','<a class="BRpt_btn" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>取消</span></a>','<div class="clearit"></div>',"</div>"].join("");scope.reportBadTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_exclt">','<p class="Brpt_extP1">您已经成功举报了该信息，工作人员会尽快处理。</p>','<p class="Brpt_extP2">再次感谢您对新浪博客的支持！</p>','<div class="Brpt_extBtn"><a class="BRpt_btn" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>',"</div>"].join("");scope.reportSuccessTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_extRst">','<p class="Brpt_eRTit">举报完成！感谢您对我们工作的支持，我们将在24小时内处理。</p>','<div class="Brpt_eRmtd">','<p class="tit">您还可以：</p>','<div class="conn">','<p class="mtd">','<input type="checkbox" id="#{cbCustom}"/>','<label for="#{cbCustom}">我是新浪博客用户，我要接收处理结果</label><span id="#{guestText}">(您还没有登录)</span>',"</p>","</div>",'<div class="conn2">','<p class="mtd"><input type="checkbox" id="#{cbOtherMethod}" /><label for="#{cbOtherMethod}">我要通过其他方式接收处理结果</label></p>','<div id="#{userForm}" style="display:none;">','<p class="perInf"><span>您的姓名：</span><input id="#{userName}" type="text" /></p>','<p class="perInf"><span>您的邮箱：</span><input id="#{userEmail}" type="text" /></p>','<p class="perInf"><span>您的电话：</span><input id="#{userTel}" type="text" /></p>',"</div>","</div>","</div>",'<div class="Brpt_eRBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnOk}" title=""><span>确认</span></a><div class="clear"></div></div>'].join("");scope.reportFinishedTpl=['<div class="BRpt_Mtop">',"<p>新浪博客愿和您一起共同打造健康和谐的网络信息交流平台。并有7×24小时的值班服务，及时有效的处理您的举报。</p>","</div>",'<div class="Brpt_thx">',"<p>再次感谢您对新浪博客举报的大力支持！</p>",'<div class="Brpt_thxBtn"><a class="BRpt_btnGy" href="#" onclick="return false;" id="#{btnCancel}" title=""><span>关闭</span></a></div>',"</div>"].join("");scope.GeneralReport=Core.Class.create();scope.GeneralReport.prototype={type:"",_hashType:{comment:{"class":"2",initFunction:null},blog:{"class":"1",initFunction:null},guestBook:{"class":"3",initFunction:null},friend:{"class":"4",initFunction:null},photoComment:{"class":"5",initFunction:null},paperlist:{"class":"6",initFunction:null}},dataInterface:null,canSubmit:true,bodyID:"",reportUID:"",userNameInfo1:"",userNameInfo2:"",titleInfo:"",nickName:"",contentInfo:"",tUID:"",_isInitDialog:false,_dialog:null,initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_content.php?version=7","ijax");this._hashType["comment"]["initFunction"]=this._commentInit;this._hashType["blog"]["initFunction"]=this._blogInit;this._hashType["guestBook"]["initFunction"]=this._guestBookInit;this._hashType["friend"]["initFunction"]=this._friendInit;this._hashType["photoComment"]["initFunction"]=this._photoCommentInit;this._hashType["paperlist"]["initFunction"]=this._paperlistInit},show:function(){!this._isInitDialog&&this._initDialog();this._dialog.setAreaLocked(true);this._dialog.setMiddle();this._dialog.show();this._isInitDialog=true;this._hashType[this.type]["initFunction"].call(this)},hidden:function(){this._dialog.hidden()},clear:function(){var nd=this._dialog.nodes;nd.resumeInfo.innerHTML="";nd.resumeContent.value="";nd.cbBlogHost.checked=false;Utils.Form.Radio.set($N("chocla"),"");nd.reportReason.value=""},submit:function(){var me=this;this.dataInterface.request({POST:{body_id:me.bodyID,"class":me._hashType[me.type]["class"],type:Utils.Form.Radio.get($N("chocla")),fnickname:me.nickName,fuid:me.reportUID,tuid:me.tUID,reason:me._dialog.nodes["reportReason"].value,is_report:me._dialog.nodes["cbBlogHost"].checked},onSuccess:function(data){me.canSubmit=true;me.onSuccessed(data)},onError:function(err){me.canSubmit=true;me.onError(err)},onFail:function(){me.canSubmit=true}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportStartTpl});var me=this,nd=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){me.clear()});Core.Events.addEvent(nd.btnOk,function(){if(me.canSubmit){me.canSubmit=false;me.submit()}},"click");Core.Events.addEvent(nd.btnCancel,function(){me._dialog.hidden()},"click");Utils.Form.limitMaxLen(nd.reportReason,400)},_commentInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"在博文"+this.titleInfo+"中发表的评论，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_blogInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"发表的"+this.titleInfo+"，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_guestBookInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"在"+this.userNameInfo2+"博客的留言，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_friendInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"给您发的好友申请，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=true},_photoCommentInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"在图片"+this.titleInfo+"中发表的评论，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},_paperlistInit:function(){this._dialog.nodes["resumeInfo"].innerHTML="您要举报的是"+this.userNameInfo1+"给您发送的纸条，摘要如下：";this._dialog.nodes["resumeContent"].value=this.contentInfo;this._dialog.nodes["cbBlogHost"].checked=false},onSuccessed:function(data){},onError:function(err){}};Utils.Form.inputListen=function(el,nLen,oOption){el=$E(el);if(typeof nLen!="undefined"){nLen=isNaN(nLen)?null:nLen*1}if(el==null||nLen==null||el.nodeType!=1){return false}oOption=oOption||{};var limitRe=oOption.limitRe;var doubleByte=oOption.doubleByte;doubleByte=doubleByte==null?true:doubleByte;var userinput=function(){try{var evt=Core.Events.getEvent();if(evt){var keyCode=evt.which||evt.keyCode;if(keyCode==37||keyCode==39){return false}}}catch(e){}var nLength=el.max;while(limitRe!=null&&limitRe.test(el.value)){el.value=el.value.replace(limitRe,"")}if(doubleByte==true){if(Core.String.byteLength(el.value)>nLength){var str=el.value.substr(0,nLength);while(Core.String.byteLength(str)>nLength){str=str.replace(/.$/,"")}el.value=str;el.maxLength=str.length}else{el.maxLength=nLength-el.value.replace(/[\x00-\xff]/g,"").length}}else{el.maxLength=nLength}if(nLength<el.value){el.value=el.value.substr(0,nLength)}};var Blur=function(){if(limitRe!=null&&limitRe.test(el.value)){el.value=el.value.replace(limitRe,"")}};el.max=nLen;el.maxLength=nLen;userinput();if(el.beWatched==null){el.beWatched=true;if(!$IE){Core.Events.addEvent(el,userinput,"input")}else{Core.Events.addEvent(el,userinput,"keyup");Core.Events.addEvent(el,userinput,"keypress");Core.Events.addEvent(el,userinput,"mouseout")}Core.Events.addEvent(el,Blur,"blur")}};scope.SuccessedReport=Core.Class.create();scope.SuccessedReport.prototype={loginUI:null,_isInitDialog:false,canSubmit:true,dataInterface:null,dataID:"",bodyID:"",userInfo:{nickName:""},initialize:function(){this.dataInterface=new Interface("http://control.blog.sina.com.cn/admin/advice/impeach_post_userinfo.php?version=7","ijax");this.loginUI=new Lib.Login.Ui},show:function(){!this._isInitDialog&&this._initDialog();this._dialog.setAreaLocked(true);this._dialog.setMiddle();this._dialog.show();this._isInitDialog=true},displayUserInfo:function(state){this._dialog.nodes["userForm"].style.display=state===false?"none":""},login:function(){var me=this;this.loginUI.login(function(){me.submit()})},clear:function(){var nd=this._dialog.nodes;nd.cbCustom.checked=false;nd.cbOtherMethod.checked=false;nd.userForm.style.display="none";nd.userName.value="";nd.userEmail.value="";nd.userTel.value=""},hidden:function(){this._dialog.hidden()},submit:function(){var me=this,nd=this._dialog.nodes;Lib.checkAuthor();me.canSubmit=false;this.dataInterface.request({POST:{id:me.dataID,body_id:me.bodyID,nickname:typeof $nick=="undefined"?"":$nick,name:nd.userName.value,email:nd.userEmail.value,phone:nd.userTel.value,uid:$UID,is_login:nd.cbCustom.checked?"1":"0"},onSuccess:function(data){me.canSubmit=true;me.onSuccessed(data)},onError:function(err){me.canSubmit=true;me.onError(err)},onFail:function(){me.canSubmit=true}})},_initDialog:function(){this._dialog=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportSuccessTpl});var me=this,nd=this._dialog.nodes;this._dialog.addEventListener("hidden",function(){me.clear()});Lib.checkAuthor();nd.guestText.style.display=$isLogin?"none":"";Core.Events.addEvent(nd.btnOk,function(){if(me.canSubmit){Lib.checkAuthor();if(!$isLogin&&nd.cbCustom.checked){me.login()}else{me.submit()}}},"click");Core.Events.addEvent(nd.cbOtherMethod,function(){me.displayUserInfo(nd.cbOtherMethod.checked)},"click");Utils.Form.inputListen(nd.userName,100);Utils.Form.inputListen(nd.userEmail,200);Utils.Form.inputListen(nd.userTel,100)},onSuccessed:function(data){},onError:function(err){}};$SYSMSG.extend({B04102:"您输入的电子邮件格式错误，请重新输入",B04105:"很抱歉，您输入的内容过多，请删减后重新提交",B04107:"您要举报的内容已经不存在，感谢您的支持",B04108:"举报分类错误",B04109:"您还没有选择举报类别，请选择后继续操作",B04110:"您的昵称为空，请输入后继续操作",B04111:"系统繁忙，请稍后再试",B04112:"您已经举报过该用户，再次感谢您的支持",B04113:"系统繁忙，请稍后再试",B04114:"系统繁忙，请稍后再试",B04115:"系统繁忙，请稍后再试",B04116:"系统繁忙，请稍后再试"});Lib.BlogReport=Core.Class.create();Lib.BlogReport.prototype={generalReport:null,successedReport:null,badReport:null,finishedReport:null,isBRInit:false,isFRInit:false,initialize:function(){this.generalReport=new scope.GeneralReport;this.successedReport=new scope.SuccessedReport},start:function(type,nickName,bodyID,reportUID,userNameInfo1,userNameInfo2,titleInfo,contentInfo,tUID){var me=this,gr=this.generalReport;contentInfo=Core.String.decodeHTML(contentInfo);gr.nickName=nickName;gr.type=type;gr.reportUID=reportUID;gr.userNameInfo1=userNameInfo1;gr.userNameInfo2=userNameInfo2;gr.titleInfo=titleInfo;gr.contentInfo=Core.String.byteLength(contentInfo)>800?Core.String.shorten(contentInfo,800):contentInfo;gr.bodyID=bodyID;gr.tUID=tUID?tUID:"";gr.onSuccessed=function(data){me.reportSuccess(nickName,bodyID,data["dataID"]);this.hidden()};gr.onError=function(err){if(err["code"]==="B04112"){me.showBad();this.hidden()}else{winDialog.alert($SYSMSG[err["code"]])}};gr.show()},showBad:function(){var me=this;if(!this.isBRInit){this.badReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportBadTpl});Core.Events.addEvent(this.badReport.nodes["btnOk"],function(){me.badReport.hidden()},"click")}this.badReport.setAreaLocked(true);this.badReport.setMiddle();this.badReport.show()},reportSuccess:function(nickName,bodyID,dataID){var me=this,sr=this.successedReport;sr.bodyID=bodyID;sr.dataID=dataID;sr.userInfo.nickName=nickName;sr.onSuccessed=function(data){me.finished();this.hidden()};sr.onError=function(err){winDialog.alert($SYSMSG[err["code"]])};sr.show()},finished:function(){var me=this;if(!this.isFRInit){this.finishedReport=winDialog.createCustomsDialog({tpl:scope.reportMainTpl,content:scope.reportFinishedTpl});Core.Events.addEvent(this.finishedReport.nodes["btnCancel"],function(){me.finishedReport.hidden()},"click")}this.finishedReport.setAreaLocked(true);this.finishedReport.setMiddle();this.finishedReport.show()}};$registJob("report_guestBook",function(){var hostNickName="",BR=new Lib.BlogReport;window.report=function(cID){var bodyID=scope.$uid+"_"+cID,links=$E("guestNick_"+cID).getElementsByTagName("a"),reportUID=links.length>0?links[0].href.split("/").pop():"",nickName=links.length>0?links[0].innerHTML:"新浪网友",userNameInfo1=$E("guestNick_"+cID).innerHTML,userNameInfo2="",titleInfo="",contentInfo=$E("content_"+cID).innerHTML;if(hostNickName===""){Lib.Uic.getNickName([scope.$uid],function(result){if(result&&result[scope.$uid]){hostNickName=result[scope.$uid];BR.start("guestBook",nickName,bodyID,reportUID,userNameInfo1,'<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+hostNickName+"</a>",titleInfo,contentInfo)}else{BR.start("guestBook","新浪网友",bodyID,reportUID,userNameInfo1,"<strong>新浪网友</strong>",titleInfo,contentInfo)}})}else{userNameInfo2='<a target="_blank" href="http://blog.sina.com.cn/u/'+scope.$uid+'">'+hostNickName+"</a>";

BR.start("guestBook",nickName,bodyID,reportUID,userNameInfo1,userNameInfo2,titleInfo,contentInfo)}return false}});$registJob("msg_comment",function(){var commonds=["加关注","加好友","举报","黑名单"];var eles=scope.msg_panel.getNodes();scope.msg_panel.report=function(){report(scope.msg_panel.commentId);return false};eles["follow"].parentNode.style.display="";Core.Events.addEvent(eles["follow"],scope.msg_panel.addFollow);eles["friend"].parentNode.style.display="";Core.Events.addEvent(eles["friend"],scope.msg_panel.addfriend);eles["report"].parentNode.style.display="";Core.Events.addEvent(eles["report"],scope.msg_panel.report);eles["backlist"].parentNode.style.display="";Core.Events.addEvent(eles["backlist"],scope.msg_panel.blackList)});$registJob("loginStatus",function(){Lib.checkAuthor();var _getCookie=Utils.Cookie.getCookie;var _setCookie=Utils.Cookie.setCookie;var statusUid=_getCookie("_s_loginStatus");var loginUid=_getCookie("_s_loginuid");if($isLogin){if(loginUid===$UID){return}}else{if(!statusUid||statusUid===loginUid){return}}_setCookie("_s_loginuid",$UID||statusUid,24-(new Date).getHours(),"","blog.sina.com.cn");var url="http://control.blog.sina.com.cn/blog_rebuild/riaapi/padblog/padInfo.php?rnd="+Math.random();Utils.Io.JsLoad.request(url,{onComplete:function(){},onException:function(){}})});function main(){var job=new Jobs;job.add("suda");job.add("msg_index");job.add("msg_panel");job.add("report_guestBook");job.add("msg_guestBook");job.add("loginStatus");job.start()}