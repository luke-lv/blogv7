if(typeof Sina=="undefined"){Sina={}}Sina.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Sina;for(var i=levels[0]=="Sina"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};function $E(oID){var node=typeof oID=="string"?document.getElementById(oID):oID;if(node!=null){return node}return null}function $C(tagName){return document.createElement(tagName)}function $N(name){return document.getElementsByName(name)}function $T(obj,tagName){return obj.getElementsByTagName(tagName)}try{document.execCommand("BackgroundImageCache",false,true)}catch(e){}(function(){var bind=function(fFunction,object){var __method=fFunction;return function(){return __method.apply(object,arguments)}};var debug_namespace="Debug";if(window[debug_namespace]==null||typeof window[debug_namespace].log=="undefined"){window[debug_namespace]={cacheData:[],base_url:"http://sjs.sinajs.cn/bind2/",product:scope.$PRODUCT_NAME,baseColor:{1:{color:"#FFF",bgcolor:"#E00"},2:{color:"#F00"},3:{color:"#FFF000"},4:{color:"#0F0"},5:{color:"#FFF"}},fatal:function(sInfo){this.addData(sInfo,1)},error:function(sInfo){this.addData(sInfo,2)},warning:function(sInfo){this.addData(sInfo,3)},info:function(sInfo){this.addData(sInfo,4)},log:function(sInfo){this.addData(sInfo,5)},dir:function(oInfo){this.addData(oInfo,5)},addData:function(sInfo,nType,sColor,sBgColor){if(sInfo==null){return}if(typeof sInfo!="object"){sInfo=sInfo.toString()}var oOption={type:nType||"5",color:sColor||this.baseColor[nType].color,bgcolor:sBgColor||this.baseColor[nType].bgcolor};this.cacheData.push([sInfo,oOption]);if(this.initFinished==true){this.showCurrentData([sInfo,oOption])}}};window.trace=bind(window[debug_namespace].log,window[debug_namespace]);window.traceError=bind(window[debug_namespace].error,window[debug_namespace])}})();Sina.pkg("Core");if(typeof Core=="undefined"){Core=Sina.Core}Sina.pkg("Core.Array");Core.Array.foreach=function(ar,insp){if(ar==null&&ar.constructor!=Array){return[]}var i=0,len=ar.length,r=[];while(i<len){var x=insp(ar[i],i);if(x!==null){r[r.length]=x}i++}return r};Sina.pkg("Core.Events");(function(_s){var _ua=navigator.userAgent.toLowerCase();var system={$winXP:/windows nt 5.1/.test(_ua),$winVista:/windows nt 6.0/.test(_ua),$win7:/windows nt 6.1/.test(_ua),$macOS:/mac/.test(_ua)};var browser={$OPERA:false,$IE6:false,$IE7:false,$IE8:false,$IE9:false,$SAFARI:false,$FF2:false,$FF3:false,$FF4:false,$FF:false,$CHROME:false,$TT:false,$360:false,$SOGO:false,$Maxthon:false};var engine={$IE:0,$MOZ:false,$WEBKIT:false,$KHTML:false};if(/opera/.test(_ua)||_s.opera){browser.$OPERA=true}else if(/chrome\/(\S+)/.test(_ua)){browser.$CHROME=true}else if(/safari\/(\S+)/.test(_ua)){browser.$SAFARI=true}else if(/msie/.test(_ua)){engine.$IE=true;if(/360se/.test(_ua)){browser.$360=true}else if(/tencenttraveler/.test(_ua)){browser.$TT=true}else if(/se\s\S+\smetasr\s\d+\.\d+/.test(_ua)){browser.$SOGO=true}var uaVersionArray=_ua.match(/msie (\d+)/);var version=parseInt(uaVersionArray[1]);engine.$IE=version;if(version===8){browser.$IE8=true}else if(version===6){browser.$IE6=true}else if(version===9){browser.$IE9=true}else if(version===7){browser.$IE7=true}else if(version===10){browser.$IE10=true}}else if(/firefox/.test(_ua)){var uaVersionArray=_ua.match(/firefox\/(\d+)/);browser.$FF=parseInt(uaVersionArray[1]);if(/firefox\/3/.test(_ua)){browser.$FF3=true}else if(/firefox\/4/.test(_ua)){browser.$FF4=true}else if(/firefox\/2/.test(_ua)){browser.$FF2=true}}else if(/trident\/7.0/.test(_ua)&&/rv:11.0/.test(_ua)){engine.$IE=11;browser.$IE11=true}try{var t=window.external;browser.$Maxthon=t.max_version?true:false}catch(e){}if(/applewebkit\/(\S+)/.test(_ua)){engine.$WEBKIT=true}else if(/khtml\/(\S+)/.test(_ua)){engine.$KHTML=true}else if(/rv:([^\)]+)\) gecko\/\d{8}/.test(_ua)){engine.$MOZ=true}browser.$MOBILE=/mobile/i.test(_ua);if(!browser.$MOBILE){browser.$MOBILE=/HTC/.test(_ua)}function apply(thisObj,cfg){var p;for(p in cfg){thisObj[p]=cfg[p]}}apply(_s,browser);apply(_s,engine);apply(_s,system)})(window);Core.Events.addEvent=function(elm,func,evType,useCapture){var _el=typeof elm=="string"?$E(elm):elm;if(_el==null){trace("addEvent 找不到对象："+elm);return}if(typeof useCapture=="undefined"){useCapture=false}if(typeof evType=="undefined"){evType="click"}if(_el.addEventListener){if(evType=="mousewheel"&&$FF){evType="DOMMouseScroll"}_el.addEventListener(evType,func,useCapture);return true}else if(_el.attachEvent){var r=_el.attachEvent("on"+evType,func);return true}else{_el["on"+evType]=func}};Core.Events.removeEvent=function(oElement,fHandler,sName){var _el=$E(oElement);if(_el==null){trace("removeEvent 找不到对象："+oElement);return}if(typeof fHandler!="function"){return}if(typeof sName=="undefined"){sName="click"}if(_el.addEventListener){_el.removeEventListener(sName,fHandler,false)}else if(_el.attachEvent){_el.detachEvent("on"+sName,fHandler)}fHandler[sName]=null};Sina.pkg("Core.Function");Core.Function.bind3=function(fFunc,object,args){args=args==null?[]:args;var __method=fFunc;return function(){return __method.apply(object,args)}};Core.Array.findit=function(arr,v){var k=-1;Core.Array.foreach(arr,function(value,index){if(v==value){k=index}});return k};window.onerror=function(err,file,line){trace("Error occured:"+err+"<br/>file:"+file+"<br/>line:"+line+"<br/>");return true};function Jobs(oOption){this.option=oOption||{};this._jobTable=[[],[],[],[]]}Jobs.prototype={_registedJobTable:{},errorMsg:[],_registJob:function(jobName,rel){this._registedJobTable[jobName]=rel},error:function(sMsg){Debug.error(sMsg);this.errorMsg.push(sMsg)},add:function(jobName,type){type=type||1;if(Core.Array.findit(this._jobTable[type],jobName)==-1){this._jobTable[type].push(jobName)}else{this.error("Error: Job <b>"+jobName+"</b> is existed now.")}},start:function(){if(this.option.onStart!=null){this.option.onStart()}var regJobs=this._registedJobTable;var jobs=this._jobTable[1].concat(this._jobTable[2]);var _this=this;this.fe=Core.Function.bind3(_this.focus,_this,[]);var addFocus=function(){if(_this._jobTable[3].length==0){if(_this.option.onEnd!=null){_this.option.onEnd()}return}Core.Events.addEvent(document.body,_this.fe,"focus");Core.Events.addEvent(window,_this.fe,"scroll");Core.Events.addEvent(document.body,_this.fe,"mousemove");Core.Events.addEvent(document.body,_this.fe,"mouseover")};this.queue(jobs,addFocus)},focus:function(){var _this=this;if(this.focusdown){Core.Events.removeEvent(document.body,_this.fe,"focus");Core.Events.removeEvent(window,_this.fe,"scroll");Core.Events.removeEvent(document.body,_this.fe,"mousemove");Core.Events.removeEvent(document.body,_this.fe,"mouseover");_this.fe=null;return}this.focusdown=true;var jobs=this._jobTable[3];this.queue(jobs,this.option.onEnd)},queue:function(jobs,callback){var _this=this;var getTime=function(){return(new Date).valueOf()};var regJobs=this._registedJobTable;var joblen=jobs.length;var i=0;var interNum=window.setInterval(function(){if(i>=joblen){clearInterval(interNum);interNum=null;if(callback!=null){callback()}return}var jobName=jobs[i];var job=regJobs[jobName];i++;if(typeof job=="undefined"){_this.error("<b>Job["+jobName+"] is undefiend!!!</b>");return}var _try=true;var _start=getTime();try{job.call()}catch(e){_this.error("<b>Job["+jobName+"] failed!!!</b>"+e.message+"");if(callback!=null){callback()}_try=false;throw e}finally{if(_try){var _end=getTime();Debug.info("<b>Job["+jobName+"] done in "+(_end-_start)+"ms.</b>")}}},10)},call:function(jobName,args){if(typeof this._registedJobTable[jobName]!="undefined"){this._registedJobTable[jobName].apply(this,args)}else{trace("<b>Job["+jobName+"] is undefined!!!</b>",{color:"#900",bgColor:"#FFF;"})}}};$registJob=function(name,rel){Jobs.prototype._registJob(name,rel)};$callJob=function(name){var args=[];if(arguments.length>1){Core.Array.foreach(arguments,function(v,i){args[i]=v});args.shift()}Jobs.prototype.call(name,args)};(function(){Function.prototype.$defineProto=function(def){var k;for(k in def){this.prototype[k]=def[k]}if(this.__interface__){for(k in this.prototype){if(this.prototype[k]==="NI"){throw new Error("类定义错误，接口方法["+k+"]未实现")}}}this.prototype.constructor=this;this.$extends=this.$define=this.$implements=function(){throw new Error("$define 语句定义后面不能再作其它定义")};return this};Function.prototype.$extend=function(){var me=this;var i=arguments.length;var sup;var fn;if(i===0){throw new Error("$extends 语句错误：未指定父类")}sup=arguments[0];fn=function(){var _this=this;this.$super={};for(var fName in sup.prototype){if(!sup.prototype[fName])continue;this.$super[fName]=function(f){return function(){sup.prototype[f].apply(_this,arguments)}}(fName)}sup.apply(this,arguments);me.apply(this,arguments)};fn.prototype=object(sup.prototype);fn.prototype.constructor=fn;return fn};Function.prototype.$implements=function(){var arg=Array.prototype.slice.call(arguments,0);var fn;var i=arg.length;var k;while(i--){if(typeof arg[i]!=="object"){throw new Error("$implements 语句错误：参数必须为 object 类型")}for(k in arg[i]){typeof this.prototype[k]==="undefined"&&(this.prototype[k]="NI")}}this.__interface__=true;this.$extends=function(){throw new Error("$extends 语句错误：$extends 语句不能出现在 $implements 定义之后")};return this};Function.prototype.$mixProto=function(){this.$extends=this.$define=function(){throw new Error("$mixProto 必须放在最后使用")};var srcCls=arguments[0];var srcClsProto=srcCls.prototype;for(var fn in srcClsProto){if(this[fn])throw new Error("目标类有同名方法");if(!srcClsProto[fn])continue;this.prototype[fn]=srcClsProto[fn]}return this};function object(o){function F(){}F.prototype=o;return new F}})();if(typeof Reg=="undefined"){Reg={}}Reg.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Reg;for(var i=levels[0]=="Reg"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};if(typeof Lib=="undefined"){Lib={}}Lib.pkg=function(ns){if(!ns||!ns.length){return null}var levels=ns.split(".");var nsobj=Lib;for(var i=levels[0]=="Lib"?1:0;i<levels.length;++i){nsobj[levels[i]]=nsobj[levels[i]]||{};nsobj=nsobj[levels[i]]}return nsobj};Sina.pkg("Core.String");Core.String.trimHead=function(str){return str.replace(/^(\u3000|\s|\t)*/gi,"")};Core.String.trimTail=function(str){return str.replace(/(\u3000|\s|\t)*$/gi,"")};Core.String.trim=function(str){return Core.String.trimHead(Core.String.trimTail(str))};Lib.templateUtils=function(){};Lib.templateUtils.prototype.getTemplateNodes=function(template){var box=document.createElement("div");var nodes={};var ids_without_rndNum=[];var rndNum=(new Date).getTime().toString().slice(-5)+Math.floor(Math.random()*1e5);var testReg=/#{([a-z0-9_]+)}/gi;template=template.replace(testReg,function(match,f1){ids_without_rndNum.push(f1);return f1+"_"+rndNum});box.innerHTML=template;var i;var len=ids_without_rndNum.length;var key;for(i=0;i<len;i++){key=ids_without_rndNum[i];nodes[key]=this.findById(key+"_"+rndNum,box)}return nodes};Lib.templateUtils.prototype.getIdNodes=function(template){var i,j,len,tagsLen,idName,idNode;var nodes={};var ids=[];var idTags=[];var tags=[];var box=document.createElement("div");box.innerHTML=template;tags=box.getElementsByTagName("*");template.replace(/id *= *"([^{ ]+?)"/gi,function(match,f1){ids[ids.length]=f1});len=tags.length;for(i=0;i<len;i++){if(tags[i].id)idTags[idTags.length]=tags[i]}len=ids.length;for(i=0;i<len;i++){idName=ids[i];j=0;tagsLen=idTags.length;while(j<tagsLen){idNode=idTags[j];if(idName==idNode.id){nodes[idName]=idNode;idTags.splice(j,1)}j++}}return nodes};Lib.templateUtils.prototype.findById=function(id,context,tag){var i;var context=context||document;var tags=context.getElementsByTagName(tag||"*");var len=tags.length;for(i=0;i<len;i++){if(tags[i].getAttribute("id")==id){return tags[i]}}};Lib.templateUtils.prototype.formatTemplate=function(curStr,oParam){var curStr;var formatReg=new RegExp("#{([a-z0-9]+)}","ig");curStr=curStr.replace(formatReg,function(match,f1,index,srcStr){return oParam[f1]});return curStr};Sina.pkg("Core.Dom");Core.Dom.up=function(element,className){var el=$E(element);while(el.parentNode){if(new RegExp("\\b"+className+"\\b").test(el.className)){return el}el=el.parentNode}};Reg.SolidTips=function(opt){this.box=opt.box;this.template=opt.template;this.isHide=true;this.nodes=this.getTemplateNodes(this.template);this.entity=this.nodes.entity;this.txtNode=this.nodes.txtNode||this.nodes.entity}.$defineProto({showAt:function(inputNode,txt){this.isHide&&(this.entity.style.display="inline-block");this.isHide=false;this.setTxt(txt||"");if(this.box)this.box.appendChild(this.entity);else Core.Dom.up(inputNode,"inputbox").parentNode.appendChild(this.entity)},hide:function(){this.entity.style.display="none";this.isHide=true},setTxt:function(str){this.txtNode.innerHTML=str}}).$mixProto(Lib.templateUtils);Core.String.byteLength=function(str){if(typeof str=="undefined"){return 0}var aMatch=str.match(/[^\x00-\x80]/g);return str.length+(!aMatch?0:aMatch.length)};Reg.RegEx=function(opt){this.str=opt.str;this.reportCall=opt.reportCall;this.stop=false}.$defineProto({setStr:function(str){this.str=str},cantEmpty:function(tip){if(!this.stop&&!this.str){this.reportCall(tip||"此项不能为空");this.stop=true}return this},cantHaveSpace:function(tip){if(!this.stop&&/ |　/.test(this.str)){this.reportCall(tip||"不能包含空格");this.stop=true}return this},cantHaveNum:function(tip){if(!this.stop&&!/^[0-9]/.test(this.str)){this.reportCall(tip||"不能含有数字");this.stop=true}return this},cantNumAll:function(tip){if(!this.stop&&/^[\d]+$/.test(this.str)){this.reportCall(tip||"不能全是数字");this.stop=true}return this},cantHaveChinese:function(tip){if(!this.stop&&/[\u4E00-\u9FA5]/.test(this.str)){this.reportCall(tip||"不能含有中文");this.stop=true}return this},cantHaveUnicode:function(tip){if(!this.stop&&/[\uFF00-\uFFFF]/.test(this.str)){this.reportCall(tip||"不能使用全角字符");this.stop=true}return this},cantLenWrong:function(limit,tip){var __tmp=limit.split("-");var __low=__tmp[0];var __hi=__tmp[1]||__low;var __len=Core.String.byteLength(this.str);if(!this.stop&&(__len<__low||__len>__hi)){this.reportCall(tip||"长度不符合，应为 "+limit+" 位");this.stop=true}return this},cantUnderlineLast:function(tip){if(!this.stop&&/_$/.test(this.str)){this.reportCall(tip||"下划线不能在最后");this.stop=true}return this},cantUnderlineBothSide:function(tip){if(!this.stop&&/(^_+)|(_+$)/.test(this.str)){this.reportCall(tip||"首尾不能是下划线");this.stop=true}return this},cantSpaceBothSide:function(tip){if(!this.stop&&/(^[ 　]+)|([ 　]+$)/.test(this.str)){this.reportCall(tip||"首尾不能有空格");this.stop=true}return this},cantSinaMail:function(tip){if(!this.stop&&/@(sina|vip[.]sina|2008[.]sina|51uc)[.](cn|com|com[.]cn)$/.test(this.str)){this.reportCall(tip||"有新浪邮箱吗？请直接 <a href='http://login.sina.com.cn/signup/signin.php?entry=blog' style='color:#CC0000; text-decoration:underline;'>登录</a>");this.stop=true}return this},notAEmail:function(tip){if(!this.stop&&!/^[0-9a-z][_.0-9a-z-]{0,31}@([0-9a-z][0-9a-z-]{0,30}\.){1,4}[a-z]{2,4}$/.test(this.str)){this.reportCall(tip||"邮箱地址格式不正确");this.stop=true}return this},cantWiredCharPWR:function(tip){if(!this.stop&&!/[\w\~\!\@\#\$\%\^\&\*\(\)\+\`\-\=\[\]\\\{\}\|\;\'\:\"\,\.\/\<\>\?]/.test(this.str)){this.reportCall(tip||"不能含有特殊字符");this.stop=true}return this},cantWiredChar:function(tip){if(!this.stop&&/>|<|,|\[|\]|\{|\}|\?|\/|\+|=|\||\'|\\|\"|:|;|\~|\!|\@|\#|\*|\$|\%|\^|\&|\(|\)|\-|\—|\.|`/.test(this.str)){this.reportCall(tip||"不能含有特殊字符");this.stop=true}return this},cantUpcase:function(tip){if(!this.stop&&/[A-Z]/.test(this.str)){this.reportCall(tip||"不能含有大写字母");this.stop=true}return this},mustLetterOrNum:function(tip){if(!this.stop&&/[^0-9a-z]/i.test(this.str)){this.reportCall(tip||"输入的是数字或英文字母");this.stop=true}return this},mustNormalChar:function(tip){if(!this.stop&&/[^0-9a-zA-Z\u4E00-\u9FA5]/.test(this.str)){this.reportCall(tip||"不能包含半角数字、半角字母和汉字以外的字符");this.stop=true}return this}});Lib.classUtils=function(){};Lib.classUtils.prototype.addClass=function(dom,clz){if(!dom){return false}if(!this.hasClass(dom,clz)){dom.className=Core.String.trim(dom.className.concat(" "+clz))}};Lib.classUtils.prototype.delClass=function(dom,clz){if(!dom){return false}var reg=new RegExp("( +|^)"+clz+"(?=( |$))","ig");dom.className=Core.String.trim(dom.className.replace(reg,""))};Lib.classUtils.prototype.hasClass=function(dom,clz){if(!dom){return false}var reg=new RegExp("( +|^)"+clz+"(?=( |$))","ig");return reg.test(dom.className)};Core.Events.getEvent=function(){return window.event};if(!$IE||$IE>8){Core.Events.getEvent=function(){if(!$IE&&window.event){return window.event}var o=arguments.callee.caller;var e;var n=0;while(o!=null&&n<40){e=o.arguments[0];if(e&&(e.constructor==Event||e.constructor==MouseEvent)){return e}n++;o=o.caller}return e}}Reg.InputBase=function(opt){var __this=this;this.box=opt.box;this.colorNode=opt.colorNode;this.noteTip=opt.noteTip;this.errTip=opt.errTip;this.entity=opt.entity;this.submitBtn=opt.submitBtn;this.afterReport=opt.onError||function(){};this.curColor;this.proccessStop=false;this.timer=0;this.validator=new Reg.RegEx({reportCall:function(tip){__this.showErrTips(tip);__this.proccessStop=true;__this.changeColor("inputRed");__this.afterReport()}});this.rightTips=new Reg.SolidTips({box:__this.box,template:'<span class="yes" id="#{entity}" style="margin-left: 15px;"></span>'});this.noteTips=new Reg.SolidTips({box:__this.box,template:'<span class="errtip" id="#{entity}"></span>'});this.errTips=new Reg.SolidTips({box:__this.box,template:'<span id="#{entity}" style="margin-left: 15px;"><span class="error"></span><span class="red" style="color:#cc0000" id="#{txtNode}"></span></span>'});this.allTips=[this.rightTips,this.errTips,this.noteTips];this.watchingInput();if(this.submitBtn){this.handleEnterKey()}}.$defineProto({handleEnterKey:function(){var __this=this;Core.Events.addEvent(this.entity,function(){var __evt=Core.Events.getEvent();var __btnCode=__evt.keyCode||__evt.which;if(__btnCode==13){__this.submitBtn.onclick()}},"keydown")},changeColor:function(){if(!arguments[0])return;this.removeColor();this.addClass(this.colorNode,arguments[0]);this.curColor=arguments[0]},removeColor:function(){if(!this.curColor)return;this.delClass(this.colorNode,this.curColor);this.curColor=""},hideAllTips:function(){for(var i=0;i<this.allTips.length;i++){this.allTips[i].hide()}},showNoteTips:function(txt){this.hideAllTips();var __content=txt||this.noteTip;if(!__content)return;this.noteTips.showAt(this.entity,__content)},hideNoteTips:function(){this.noteTips.hide()},showErrTips:function(txt){this.hideAllTips();this.errTips.showAt(this.entity,txt||this.errTip||"");this.tipsTxt=txt},hideErrTips:function(){this.errTips.hide()},showRightTips:function(){this.hideAllTips();this.rightTips.showAt(this.entity);this.tipsTxt=""},showGreen:function(){this.rightTips.showAt(this.entity)},hideGreen:function(){this.rightTips.hide()},hideRightTips:function(){this.rightTips.hide()},watchingInput:function(){var __this=this;var flagGreen=0;var id=this.entity.id;var regFlag=scope&&scope.$submit;Core.Events.addEvent(this.entity,function(){if(!flagGreen&&regFlag){__this.hideGreen();regFlag=1}__this.changeColor("inputGreen");__this.showNoteTips()},"focus");Core.Events.addEvent(this.entity,function(){__this.validTxt()},"blur");if(regFlag&&id==="inputName"){this.showGreen()}if(regFlag&&id==="inputEmail"){this.showGreen()}if(regFlag&&id==="inputNick"){this.showGreen()}if(regFlag&&id==="inputPwdAnswer"){this.showGreen()}},finishValid:function(){if(!this.validator.stop){this.removeColor();this.showRightTips();this.proccessStop=false}this.validator.stop=false},validTxt:function(force){var str=this.entity.value;if(!force&&this.valBefore==str){this.validator.stop=true;this.restoreState()}this.valBefore=str;this.validator.setStr(str)},restoreState:function(){if(this.proccessStop){this.showErrTips(this.tipsTxt);this.changeColor("inputRed")}else{this.showRightTips();this.removeColor()}},clearState:function(){this.hideAllTips();this.removeColor()}}).$mixProto(Lib.classUtils);Sina.pkg("Utils");if(typeof Utils=="undefined"){Utils=Sina.Utils}Sina.pkg("Utils.Io");Utils.Url=function(url){url=url||"";this.url=url;this.query={};this.parse()};Utils.Url.prototype={parse:function(url){if(url){this.url=url}this.parseAnchor();this.parseParam()},parseAnchor:function(){var anchor=this.url.match(/\#(.*)/);anchor=anchor?anchor[1]:null;this._anchor=anchor;if(anchor!=null){this.anchor=this.getNameValuePair(anchor);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var query=this.url.match(/\?([^\?]*)/);query=query?query[1]:null;if(query!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(query)}},getNameValuePair:function(str){var o={};str.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(w,n,v){if(n==""){return}o[n]=v||""});return o},getParam:function(sPara){return this.query[sPara]||""},clearParam:function(){this.query={}},setParam:function(name,value){if(name==null||name==""||typeof name!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[name]=value},setParams:function(o){this.query=o},serialize:function(o){var ar=[];for(var i in o){if(o[i]==null||o[i]==""){ar.push(i+"=")}else{ar.push(i+"="+o[i])}}return ar.join("&")},toString:function(){var queryStr=this.serialize(this.query);return this.url+(queryStr.length>0?"?"+queryStr:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(forceSharp){return this.anchor?"#"+this.serialize(this.anchor):forceSharp?"#":""}};Core.String.encodeDoubleByte=function(str){if(typeof str!="string"){return str}return encodeURIComponent(str)};Utils.Io.Ajax={createRequest:function(){var request=null;try{request=new XMLHttpRequest}catch(trymicrosoft){try{request=new ActiveXObject("Msxml2.XMLHTTP")}catch(othermicrosoft){try{request=ActiveXObject("Microsoft.XMLHTTP")}catch(failed){}}}if(request==null){}else{return request}},request:function(url,option){option=option||{};option.onComplete=option.onComplete||function(){};option.onException=option.onException||function(){};option.returnType=option.returnType||"txt";option.method=option.method||"get";option.data=option.data||{};if(typeof option.GET!="undefined"&&typeof option.GET.url_random!="undefined"&&option.GET.url_random==0){this.rand=false;option.GET.url_random=null}return this.loadData(url,option)},loadData:function(url,option){var request=this.createRequest(),tmpArr=[];var _url=new Utils.Url(url);if(option.POST){for(var postkey in option.POST){var postvalue=option.POST[postkey];if(postvalue!=null){tmpArr.push(postkey+"="+Core.String.encodeDoubleByte(postvalue))}}}var sParameter=tmpArr.join("&")||"";if(option.GET){for(var key in option.GET){if(key!="url_random"){_url.setParam(key,Core.String.encodeDoubleByte(option.GET[key]))}}}if(this.rand!=false){}request.onreadystatechange=function(){if(request.readyState==4){var response,type=option.returnType;try{switch(type){case"txt":response=request.responseText;break;case"xml":if($IE){response=request.responseXML}else{var Dparser=new DOMParser;response=Dparser.parseFromString(request.responseText,"text/xml")}break;case"json":response=eval("("+request.responseText+")");break}option.onComplete(response)}catch(e){option.onException(e.message,_url);return false}}};try{if(option.POST){request.open("POST",_url,true);request.setRequestHeader("Content-Type","application/x-www-form-urlencoded");request.send(sParameter)}else{request.open("GET",_url,true);request.send(null)}}catch(e){option.onException(e.message,_url);return false}return request}};Reg.InputName=function(opt){}.$extend(Reg.InputBase).$defineProto({validOccupy:function(){var __this=this;if(this.validator.stop){__this.finishValid();return}Utils.Io.Ajax.request("/signup/check_user.php"+"?t="+(new Date).getTime(),{returnType:"txt",POST:{from:"cnmail",name:__this.entity.value},onComplete:function(res){switch(res){case"no":break;case"yes":__this.validator.stop=true;__this.proccessStop=true;__this.showErrTips("邮箱被占用");__this.changeColor("inputRed");break;case"error":__this.validator.stop=true;__this.proccessStop=true;__this.showErrTips("系统繁忙");__this.changeColor("inputRed");break}__this.finishValid()},onException:function(res){}})},validTxt:function(){this.$super.validTxt();this.validator.cantEmpty("请输入邮箱名").cantHaveUnicode().cantHaveChinese().cantHaveSpace().cantUpcase().cantWiredChar().cantLenWrong("4-16","邮箱名长度为 4-16 位").cantNumAll().cantUnderlineBothSide();this.validOccupy()}});Reg.InputPwd=function(opt){var __this=this;Reg.attachValidObj.joinMember(this,function(){__this.validTxt(true)})}.$extend(Reg.InputBase).$defineProto({watchingInput:function(){var __this=this;var flagGreen=0,regF=scope&&scope.$submit;Core.Events.addEvent(this.entity,function(){if(!flagGreen&&regF){__this.hideGreen();regF=1}__this.changeColor("inputGreen");__this.showNoteTips()},"focus");Core.Events.addEvent(this.entity,function(){Reg.attachValidObj.notifyBlur()},"blur");if(regF){__this.showGreen()}},validTxt:function(force){this.$super.validTxt(force);this.validator.cantEmpty("请输入密码").cantHaveUnicode("密码不能包含全角字符").cantHaveChinese("密码请勿使用特殊字符").cantHaveSpace("密码不能包含空格符").cantWiredCharPWR().cantLenWrong("6-16");this.finishValid()}});function getBottomInch(inch,width,height){return(width*inch/Math.sqrt(width*width+height*height)).toFixed(2)}Reg.InputPwdConfirm=function(opt){this.primaryPwd=opt.primaryPwd;var __this=this;Reg.attachValidObj.joinMember(this,function(){__this.validTxt(true)})}.$extend(Reg.InputBase).$defineProto({watchingInput:function(){var __this=this;var flagGreen=0,regF=scope&&scope.$submit;Core.Events.addEvent(this.entity,function(){if(!flagGreen&&regF){__this.hideGreen();regF=1}__this.changeColor("inputGreen");__this.showNoteTips()},"focus");Core.Events.addEvent(this.entity,function(){Reg.attachValidObj.notifyBlur()},"blur");if(regF){__this.showGreen()}},validSame:function(){if(!this.validator.stop&&this.entity.value!=this.primaryPwd.value){this.validator.stop=true;this.showErrTips("两次输入的密码不一致");this.changeColor("inputRed")}this.finishValid()},validTxt:function(force){this.$super.validTxt(force);this.validator.cantEmpty("请输入确认密码").cantHaveUnicode("确认密码不能包含全角字符").cantHaveChinese("确认密码请勿使用特殊字符").cantHaveSpace("确认密码不能包含空格符").cantWiredCharPWR().cantLenWrong("6-16");this.validSame()}});Reg.InputNick=function(opt){}.$extend(Reg.InputBase).$defineProto({validTxt:function(){this.$super.validTxt();this.validator.cantEmpty().cantNumAll().cantHaveUnicode().cantUpcase().mustNormalChar().cantLenWrong("4-20");this.finishValid()}});Reg.InputValid=function(opt){}.$extend(Reg.InputBase).$defineProto({validTxt:function(){this.$super.validTxt();this.validator.cantEmpty().cantHaveSpace().mustLetterOrNum("不能包含全角的数字、英文字母");this.finishValid()}});Reg.InputCheck=function(opt){}.$extend(Reg.InputBase).$defineProto({changeColor:function(){},removeColor:function(){},validTxt:function(){if(!this.entity.checked){this.validator.stop=true;this.proccessStop=true;this.showErrTips("需同意使用协议和服务条款")}this.finishValid()}});Reg.InputQuestion=function(opt){}.$extend(Reg.InputBase).$defineProto({validTxt:function(){this.$super.validTxt();this.validator.cantEmpty().cantUnderlineLast().cantSpaceBothSide().mustNormalChar("不能包含半角数字、半角字母和汉字以外的字符").cantLenWrong("4-20");this.finishValid()}});Core.Events.fireEvent=function(oElement,sEvent){var evt;oElement=$E(oElement);if(oElement.fireEvent){oElement.fireEvent("on"+sEvent)}else{if($MOBILE){evt=document.createEvent("HTMLEvents")}else{evt=document.createEvent("MouseEvents")}evt.initEvent(sEvent,true,true);oElement.dispatchEvent(evt)}};Reg.InputSelect=function(opt){var __this=this;this.optionsBox=opt.optionsBox||document.body;this.box=opt.box;this.customInput=opt.customInput;this.targetForm=opt.targetForm;this.template=opt.template||['<div id="#{entity}" class="showDate" style="display:none; z-index:100;">','<ul id="#{itemBox}">',"<li>我手机号码的后6位？</li>","<li>我母亲的生日？</li>","<li>我父亲的生日？</li>","<li>我最好朋友的生日？</li>","<li>我儿时居住地的地址？</li>","<li>我小学校名全称？</li>","<li>我中学校名全称？</li>","<li>离我家最近的医院全称？</li>","<li>离我家最近的公园全称？</li>","<li>我的座右铭是？</li>","<li>我最喜爱的电影？</li>","<li>我最喜爱的歌曲？</li>","<li>我最喜爱的食物？</li>","<li>我最大的爱好？</li>","<li>我最喜欢的小说？</li>","<li>我最喜欢的运动队？</li>","<li>其他</li>","</ul>",'<div class="selebottom"></div>',"</div>"].join("");this.nodes=this.getTemplateNodes(this.template);this.entity=this.nodes.entity;this.itemBox=this.nodes.itemBox;this.fireBtn=this.nodes.fireBtn||opt.fireBtn;this.showStrip=this.nodes.showStrip||opt.showStrip;this.isShow=false;this.hasGenSelectInput=false;this.hasSelected=false;this.fireBtnClick=function(){if(__this.isShow){__this.entity.style.display="none";__this.isShow=false}else{__this.entity.style.display="block";__this.isShow=true}};var regG=scope&&scope.$submit,regFla=0;Core.Events.addEvent(this.fireBtn,this.fireBtnClick,"click");this.handleHover();this.handleSelect();if(regG){this.showGreen();if(this.entity){this.entity.style.top="203px"}}this.optionsBox.appendChild(this.entity);this.updateInputHidden(this.showStrip.innerHTML);new Reg.InputQuestion({colorNode:Core.Dom.up(__this.customInput,"input"),entity:__this.customInput,noteTip:"4-20 位字母、数字或汉字（汉字算两位）组成"})}.$extend(Reg.InputBase).$defineProto({createNodeByString:function(str){var __chd;var __box=$C("div");__box.innerHTML=str;__chd=__box.childNodes;if(__chd.length>1){return __box}else{return __chd[0]}},handleHover:function(){var __nodes=this.itemBox.getElementsByTagName("*");for(var i=0;i<__nodes.length;i++){__nodes[i].onmouseover=function(){this.className="current"};__nodes[i].onmouseout=function(){this.className=""}}},handleSelect:function(){var __this=this;var __nodes=this.itemBox.getElementsByTagName("*");for(var i=0;i<__nodes.length;i++){if(i==__nodes.length-1){__nodes[i].onclick=function(){__this.hasSelected=true;__this.showRightTips();Core.Dom.up(__this.customInput,"inputbox").parentNode.style.display="block";__this.updateInputHidden(this.innerHTML);__this.showWhatSelected(this.innerHTML);__this.fireBtnClick();return false}}else{__nodes[i].onclick=function(){__this.hasSelected=true;__this.showRightTips();Core.Dom.up(__this.customInput,"inputbox").parentNode.style.display="none";__this.updateInputHidden(this.innerHTML);__this.showWhatSelected(this.innerHTML);__this.fireBtnClick();return false}}}},updateInputHidden:function(val){if(!this.hasGenSelectInput){var __html="<input type='hidden' value='"+val+"' name='selectQid' />";var __inputHidden=this.createNodeByString(__html);this.selectParam=__inputHidden;this.targetForm.appendChild(__inputHidden);this.hasGenSelectInput=true}else{this.selectParam.setAttribute("value",val)}},showWhatSelected:function(txt){this.showStrip.innerHTML=txt},watchingInput:function(){},validTxt:function(){if(this.hasSelected){this.showRightTips()}else{if(this.showStrip.innerHTML.indexOf("请选择")>-1){this.showErrTips("需要选择一个你熟悉的问题");this.validator.stop=true;this.proccessStop=true}else{this.showRightTips()}}this.finishValid()}}).$mixProto(Lib.templateUtils);Reg.InputAnswer=function(opt){}.$extend(Reg.InputBase).$defineProto({validTxt:function(){this.$super.validTxt();this.validator.cantEmpty().cantSpaceBothSide().cantUnderlineLast().cantHaveUnicode("密码查询答案不能包含全角字符").cantWiredChar("密码查询答案不能包含特殊字符").cantLenWrong("6-80");this.finishValid()}});Reg.AttachValid=function(opt){var __this=this;this.allMember=[]}.$defineProto({notifyBlur:function(){for(var i=0;i<this.allMember.length;i++){this.allMember[i].callback()}},joinMember:function(inputObj,callback){var __this=this;var __allMember=this.allMember;__allMember[__allMember.length]={inputObj:inputObj,callback:callback}},quitMember:function(inputObj){for(var i=0;i<this.allMember;i++){if(this.allMember[i].inputObj==inputObj){this.allMember.splice(i,1);return}}}});Reg.attachValidObj=new Reg.AttachValid;Core.Dom.getElementsByClass=function(el,tg,clz){el=el||document;var rs=[];clz=" "+clz+" ";var cldr=el.getElementsByTagName(tg),len=cldr.length;for(var i=0;i<len;++i){var o=cldr[i];if(o.nodeType==1){var ecl=" "+o.className+" ";if(ecl.indexOf(clz)!=-1){rs[rs.length]=o}}}return rs};Core.Dom.byClz=Core.Dom.getElementsByClass;

$registJob("innerDomain",function(){var initForm=function(){var a=new Reg.InputName({colorNode:Core.Dom.up($E("inputName"),"input"),entity:$E("inputName"),submitBtn:$E("inputSubmit"),noteTip:"4-16 位之间，请用英文小写、数字、下划线，不能全部是数字或下划线"});var b=new Reg.InputPwd({colorNode:Core.Dom.up($E("inputPwd"),"input"),entity:$E("inputPwd"),submitBtn:$E("inputSubmit"),noteTip:"6-16 位字符（字母、数字、符号），区分大小写"});var c=new Reg.InputPwdConfirm({primaryPwd:$E("inputPwd"),colorNode:Core.Dom.up($E("inputPwdConfirm"),"input"),submitBtn:$E("inputSubmit"),entity:$E("inputPwdConfirm"),noteTip:"请重复输入一次相同的登录密码"});var d=new Reg.InputNick({colorNode:Core.Dom.up($E("inputNick"),"input"),entity:$E("inputNick"),submitBtn:$E("inputSubmit"),noteTip:"4-20 位小写字母、数字或汉字（汉字算两位）组成"});var e=new Reg.InputValid({colorNode:Core.Dom.up($E("inputValid"),"input"),entity:$E("inputValid"),submitBtn:$E("inputSubmit"),noteTip:"",onError:function(){}});var f=new Reg.InputCheck({box:$E("inputCheck").parentNode,entity:$E("inputCheck"),noteTip:""});var g=new Reg.InputAnswer({colorNode:Core.Dom.up($E("inputPwdAnswer"),"input"),entity:$E("inputPwdAnswer"),submitBtn:$E("inputSubmit"),noteTip:"6-80 个字符，不允许特殊字符和全角字符，空格不能在首尾，下划线不能在最后，汉字算两位"});var h=new Reg.InputSelect({optionsBox:Core.Dom.byClz(document.body,"div","mainCenTl")[0],box:$E("inputSelect").parentNode.parentNode,customInput:$E("inputOtherQid"),showStrip:$E("showStrip"),fireBtn:$E("inputSelect"),targetForm:document.forms[0]});var working=false;var all=[a,b,c,d,e,f,g,h];var subBtn=$E("inputSubmit");subBtn.onclick=function(){var i;for(i=0;i<all.length;i++){all[i].validTxt()}for(i=0;i<all.length;i++){trace(i+": "+all[i].proccessStop);if(all[i].proccessStop){return false}}if(working)return false;working=true;document.forms[0].submit();setTimeout(function(){working=false},2e3);return false}};setTimeout(initForm,10);$E("inputName").focus();if(!scope.$submit){$E("inputPwdConfirm").value="";$E("inputPwd").value=""}});function main(){var job=new Jobs;job.add("innerDomain");job.start()}