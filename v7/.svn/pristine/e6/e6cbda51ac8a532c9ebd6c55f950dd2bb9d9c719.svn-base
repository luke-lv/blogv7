(function(d,g){SinaBlog680={ver:"0.0.1"};SinaBlog680.jsload={};SinaBlog680.Url=function(i){i=i||"";this.url=i;this.query={};this.parse()};SinaBlog680.Url.prototype={parse:function(i){if(i){this.url=i}this.parseAnchor();this.parseParam()},parseAnchor:function(){var i=this.url.match(/\#(.*)/);i=i?i[1]:null;this._anchor=i;if(i!=null){this.anchor=this.getNameValuePair(i);this.url=this.url.replace(/\#.*/,"")}},parseParam:function(){var i=this.url.match(/\?([^\?]*)/);i=i?i[1]:null;if(i!=null){this.url=this.url.replace(/\?([^\?]*)/,"");this.query=this.getNameValuePair(i)}},getNameValuePair:function(j){var i={};j.replace(/([^&=]*)(?:\=([^&]*))?/gim,function(k,m,l){if(m==""){return}i[m]=l||""});return i},getParam:function(i){return this.query[i]||""},clearParam:function(){this.query={}},setParam:function(i,j){if(i==null||i==""||typeof(i)!="string"){throw new Error("no param name set")}this.query=this.query||{};this.query[i]=j},setParams:function(i){this.query=i},serialize:function(l){var j=[];for(var k in l){if(l[k]==null||l[k]==""){j.push(k+"=")}else{j.push(k+"="+l[k])}}return j.join("&")},toString:function(){var i=this.serialize(this.query);return this.url+(i.length>0?"?"+i:"")+(this.anchor?"#"+this.serialize(this.anchor):"")},getHashStr:function(i){return this.anchor?"#"+this.serialize(this.anchor):(i?"#":"")}};function c(j,i){var k;try{if(typeof i!="undefined"){for(k in j){if(i[k]!=null){j[k]=i[k]}}}}finally{k=null;return j}}function e(i){if(typeof i!="string"){return i}return encodeURIComponent(i)}function b(q,m){var p=q.urls;var s=q.GET;var n,o=p.length;var r,k,j,l;for(n=0;n<o;n++){l=window.parseInt(Math.random()*100000000);k=new SinaBlog680.Url(p[n].url);for(r in s){if(q.noencode==true){k.setParam(r,s[r])}else{k.setParam(r,e(s[r]))}}j=k.getParam("varname")||"requestId_"+l;if(q.noreturn!=true){k.setParam("varname",j)}m.script_var_arr.push(j);p[n].url=k.toString();p[n].charset=p[n].charset||q.charset}}function a(o,l){b(o,l);var n=o.urls;var k,j=n.length;for(k=0;k<j;k++){var m=document.createElement("script");m.src=n[k].url;m.charset=n[k].charset;m.onload=m.onerror=m.onreadystatechange=function(){if(m&&m.readyState&&m.readyState!="loaded"&&m.readyState!="complete"){return}l.script_loaded_num++;m.onload=m.onreadystatechange=m.onerror=null;m.src="";m.parentNode.removeChild(m);m=null};document.getElementsByTagName("head")[0].appendChild(m)}}function h(k,l){var j={urls:[],charset:"utf-8",noreturn:false,noencode:false,timeout:-1,POST:{},GET:{},onComplete:null,onException:null};var i={script_loaded_num:0,is_timeout:false,is_loadcomplete:false,script_var_arr:[]};j.urls=typeof k=="string"?[{url:k}]:k;c(j,l);a(j,i);(function(){if(j.noreturn==true&&j.onComplete==null){return}var m,n=[];if(i.script_loaded_num==j.urls.length){i.is_loadcomplete=true;if(j.onComplete!=null){for(m=0;m<i.script_var_arr.length;m++){n.push(window[i.script_var_arr[m]])}if(i.script_var_arr.length<2){j.onComplete(n[0])}else{j.onComplete(n)}}return}if(i.is_timeout==true){return}setTimeout(arguments.callee,50)})();if(j.timeout>0){setTimeout(function(){if(i.is_loadcomplete!=true){if(j.onException!=null){j.onException()}i.is_timeout=true}},j.timeout)}}SinaBlog680.jsload.request=function(i,j){new h(i,j)};SinaBlog680.PPTBoxHelper={count:0,instance:{},getId:function(){return"_ppt_box-"+(this.count++)}};SinaBlog680.moveElement=function(i,l,k){if(!document.getElementById){return false}if(!document.getElementById(i)){return false}var m=document.getElementById(i);if(m.movement){clearTimeout(m.movement)}if(!m.style.left){m.style.left="0px"}var j=parseInt(m.style.left);if(j==l){return true}if(j<l){var o=Math.ceil((l-j)/5);j=j+o}if(j>l){var o=Math.ceil((j-l)/5);j=j-o}m.style.left=j+"px";var n="SinaBlog680.moveElement('"+i+"',"+l+","+k+")";m.movement=setTimeout(n,k)};function f(){this.uid=SinaBlog680.PPTBoxHelper.getId();SinaBlog680.PPTBoxHelper.instance[this.uid]=this;this._$=function(i){return document.getElementById(i)};this.width=400;this.height=300;this.picWidth=15;this.picHeight=12;this.autoplayer=0;this.target="_blank";this._box=[];this._curIndex=0;this.materialtype=1;this.slot=null;this.slottype=1;this.sourceid=null}f.prototype={_createMainBox:function(){var j=this.width*this._box.length;var i="<div id='"+this.sourceid+"_mainbox' class='mainbox'  style='overflow:hidden;position:relative;width:"+(this.width)+"px;height:"+(this.height)+"px;'>";i+="<div id='"+this.sourceid+"_contentbox' class='flashbox' style='overflow:hidden;position:relative;width:"+j+"px;height:"+(this.height)+"px;'></div>";i+="<div id='"+this.sourceid+"_imagebox' class='imagebox' style='display: none;width:"+this.width+"px;height:"+(this.picHeight+2)+"px;top:-"+(this.picHeight+20)+"px;'></div>";i+="</div>";if(!this.slot){}else{this.slot.innerHTML=i;if(this.slot.style.display=="none"){this.slot.style.display="block"}}},_init:function(){var o="";var k="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']";var m="";var n="";for(var l=0;l<this._box.length;l++){var j=this._box[l];n+=this.renderHTML(j,this.width,this.height,l);m="<div class='bitdiv "+((l==0)?"curimg":"defimg")+"' title ="+j.title+" src='bit01.gif' "+o+' onclick = "'+k+".clickPic("+l+')"  onmouseover="'+k+".mouseoverPic("+l+')"></div>'+m}this._$(this.sourceid+"_contentbox").innerHTML=n;this._$(this.sourceid+"_imagebox").innerHTML=m},_play:function(){clearInterval(this._autoplay);var i=this._curIndex+1;if(i>=this._box.length){i=0}this.changeIndex(i);var j="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(j,this.autoplayer*1000)},renderHTML:function(l,o,j,i){var m="";if(this.materialtype===1){var k="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']";var n="";if(l.a_href){n="cursor:pointer"}m="<img "+l.a_c_suda+" title='"+l.a_title+"' src='"+l.imgurl+"' style='width:"+o+"px;height:"+j+"px;"+n+"' onclick = \""+k+".clickPic("+i+')"/>'}else{if(this.materialtype===2){var n="";if(l.a_style){n=l.a_style}m='<a style="'+n+'" title="'+l.a_title+'" href="'+l.a_href+'" '+l.a_c_suda+' target="_blank">'+l.words+"</a>"}}return m},changeIndex:function(i){var j=this._box[i];SinaBlog680.moveElement(this.sourceid+"_contentbox",-(i*this.width),1);var k=this._$(this.sourceid+"_imagebox").getElementsByTagName("div");k[this._box.length-1-this._curIndex].className="bitdiv defimg";k[this._box.length-1-i].className="bitdiv curimg";this._curIndex=i},mouseoverPic:function(i){this.changeIndex(i);if(this.autoplayer>0){clearInterval(this._autoplay);var j="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(j,this.autoplayer*1000)}},clickPic:function(i){var j=this._box[i];if(j.a_href&&j.a_href!=""){window.open(j.a_href,this.target)}},add:function(i){this._box[this._box.length]=i},show:function(){if(!this.slot){return}this._createMainBox();this._init();if(this.autoplayer>0){var i="SinaBlog680.PPTBoxHelper.instance['"+this.uid+"']._play()";this._autoplay=setInterval(i,this.autoplayer*1000)}}};SinaBlog680.resdata=0;SinaBlog680.staticBox=function(k,i){var j="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php?id="+i;SinaBlog680.jsload.request(j,{onComplete:function(l){SinaBlog680.renderBox(k,i,l)},onException:function(l){}})};SinaBlog680.renderBox=function(l,t,s){var q=l.length;for(var o=0;o<q;o++){var r=t[o];if(s[r].slottype==1){var p=new f();p.width=s[r].width;p.height=s[r].height;p.sourceid=r;p.materialtype=s[r].materialtype;p.autoplayer=0;p.slot=document.getElementById(l[o]);for(var n=0;n<s[r].res.length;n++){p.add(s[r].res[n]);p.show();var m=s[r].res[n].a_v_suda_key;var k=s[r].res[n].a_v_suda_value;SinaBlog680.sudaView(r,m,k)}}else{console.log("slottype error")}}};SinaBlog680.preloadSlots=function(i){var j="http://interface.blog.sina.com.cn/riaapi/pageslot/pageslot.php?id="+i;SinaBlog680.jsload.request(j,{onComplete:function(k){SinaBlog680.resdata=k},onException:function(k){console.log(k)}})};SinaBlog680.fillSlot=function(k,i){var l='<a id="placeEle_'+k+'"></a>';if(!i){document.write(l)}var j=window.setInterval(function(){if(SinaBlog680.resdata){clearInterval(j);var n=SinaBlog680.resdata;if(!n[k]){return}var o=new f();o.width=n[k].width;o.height=n[k].height;o.sourceid=k;o.materialtype=n[k].materialtype;o.autoplayer=0;if(i){o.slot=document.getElementById(i)}else{o.slot=document.getElementById("placeEle_"+k).parentNode}for(var m=0;m<n[k].res.length;m++){o.add(n[k].res[m]);o.show();var q=n[k].res[m].a_v_suda_key;var p=n[k].res[m].a_v_suda_value;SinaBlog680.sudaView(k,q,p)}}else{console.log("no data")}},500);window.setTimeout(function(){if(j){clearInterval(j)}},1000*10)};SinaBlog680.fillTopBar=function(j){var i=window.setInterval(function(){var l=document.getElementById("loginBarActivity");var k=document.getElementById("divPopularize");if(l){if(typeof BLOG_AD_TIPS==="undefined"||!BLOG_AD_TIPS){SinaBlog680.fillSlot(j,"loginBarActivity")}clearInterval(i)}if(k){if(typeof BLOG_AD_TIPS==="undefined"||!BLOG_AD_TIPS){SinaBlog680.fillSlot(j,"divPopularize")}clearInterval(i)}},3000);window.setTimeout(function(){if(i){clearInterval(i)}},3000*10)};SinaBlog680.sudaView=function(j,i,k){window.setTimeout(function(){var l=document.getElementById(j+"_mainbox");if(typeof SUDA!=="undefined"&&l){SUDA.uaTrack(i,k)}},3000)}})(window);